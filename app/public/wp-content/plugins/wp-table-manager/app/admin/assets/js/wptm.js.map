{"version":3,"file":"wptm.js","mappings":";;;;;;;;;;;;;;;AAAA;AACyC;;AAEzC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,SAAS;;AAET;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACA;AACA,kDAAkD;AAClD;AACA;;AAEA,gCAAgC,oBAAoB;AACpD,oCAAoC,oBAAoB;AACxD;AACA;AACA,2GAA2G,sBAAsB;AACjI,kBAAkB,OAAO;AACzB,6DAA6D;AAC7D,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,iCAAiC,SAAS;AAC1C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,cAAc;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,4CAA4C;;AAE5C,kFAAkF,QAAQ;AAC1F;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA,KAAK;;;;AAIL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU,MAAM;AAChB;AACA;AACA;;AAEA;AACA;;AAEA,YAAY,yEAAoC;AAChD;AACA;AACA;AACA,YAAY,yEAAoC;AAChD;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oEAAoE,mBAAmB;AAClH;;AAEA;AACA;;AAEA;AACA;AACA,yBAAyB,iBAAiB;AAC1C,6BAA6B,iBAAiB;AAC9C;AACA;AACA,sBAAsB;AACtB,qEAAqE;AACrE,6EAA6E,GAAG,kBAAkB;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6CAA6C;AAC7C,KAAK;AACL;AACA;AACA;AACA,mCAAmC;AACnC,6EAA6E;AAC7E,sEAAsE;;AAEtE;AACA;AACA,uEAAuE,uDAAuD;AAC9H,2EAA2E,uDAAuD;AAClI;AACA,iIAAiI,0DAA0D;AAC3L,sBAAsB,OAAO;AAC7B,wEAAwE;AACxE,mEAAmE;AACnE;AACA;AACA;;AAEA,+DAA+D,qFAAqF,2DAA2D;AAC/M;AACA;;AAEA,QAAQ,8DAAyB;AACjC;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,kBAAkB;AAClB,oCAAoC;AACpC;AACA;AACA;AACA;AACA,mCAAmC,wEAAmC;AACtE;AACA,mCAAmC,wEAAmC;AACtE,kBAAkB;AAClB;AACA,mCAAmC,wEAAmC;AACtE;AACA,mCAAmC,wEAAmC;AACtE,kBAAkB;AAClB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,sBAAsB;AACtB;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,UAAU;AACV,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;;AAEA,iEAAe,WAAW;;;;;;;;;;;;;;;;;;ACvUe;AACA;AACG;;AAE5C;AACA;AACA;AACA;AACA;;AAEA,IAAI,8DAAyB;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA,iEAAe,YAAY;;;;;;;;;;;;;;;;;;AC/Bc;AACA;AACM;;AAE/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,SAAS;AACT;AACA;;AAEA,wBAAwB,iBAAiB;AACzC;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,4CAA4C;AAC5C;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,QAAQ,mEAA8B;AACtC;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,YAAY,+DAA0B;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,QAAQ,8DAAyB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB,qCAAqC;AAC7D;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,4BAA4B,+BAA+B;AAC3D;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB;AAClB;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA,4BAA4B,4CAA4C;AACxE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,wBAAwB,8CAA8C;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAM;AACN;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,oCAAoC,eAAe;AACnD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6CAA6C;AAC7C;;AAEA;AACA;AACA,gCAAgC,wBAAwB;AACxD;AACA,2EAA2E;AAC3E;AACA;AACA,4BAA4B,wEAAmC;AAC/D;AACA,4BAA4B,wEAAmC;AAC/D;AACA,sBAAsB,yDAAyD;AAC/E;AACA,sBAAsB;AACtB;AACA;AACA,uCAAuC,wEAAmC;AAC1E;AACA,uCAAuC,wEAAmC;AAC1E;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,sGAAsG;AACtG;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA,KAAK;;AAEL,uIAAuI;AACvI;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA,KAAK;;AAEL,mGAAmG;AACnG;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ,8DAAyB;AACjC,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC,kCAAkC,IAAI;AACtC;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,oCAAoC,IAAI;;AAExC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAwB,mBAAmB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,qDAAqD;AACrD;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,sCAAsC;AACtC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,oBAAoB,qBAAqB;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,YAAY,8DAAyB;AACrC,UAAU;AACV;AACA;AACA,0BAA0B;AAC1B;AACA,wCAAwC;AACxC,gBAAgB,8DAAyB;AACzC,cAAc;AACd;AACA;AACA;AACA;AACA,2BAA2B,kCAAkC;AAC7D;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,IAAI;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,mEAA8B;AAC1D,0BAA0B;AAC1B;AACA;AACA,qBAAqB;AACrB;AACA;AACA,wBAAwB,8DAAyB;AACjD;AACA,iBAAiB;AACjB;AACA;AACA,MAAM;AACN,QAAQ,8DAAyB;AACjC;AACA;;AAEA;AACA;AACA;;AAEA,2DAA2D;AAC3D;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,yCAAyC;AACzC;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA;;AAEA;AACA,yCAAyC;AACzC,MAAM;AACN,yCAAyC;AACzC;;AAEA;;AAEA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,2BAA2B,2CAA2C;AACtE;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA,gCAAgC;AAChC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,QAAQ,8DAAyB;AACjC;;AAEA;AACA;AACA,qDAAqD;AACrD,+CAA+C;AAC/C;AACA,8CAA8C;AAC9C,8CAA8C;AAC9C;AACA;AACA;;AAEA;AACA;AACA,sBAAsB,QAAQ;;AAE9B;AACA,wCAAwC,eAAe,4CAA4C,GAAG;;AAEtG;AACA,yBAAyB,eAAe;AACxC;;AAEA,yCAAyC,IAAI;AAC7C;AACA,8CAA8C;AAC9C,UAAU;AACV,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,aAAa;AACb,UAAU;AACV;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,eAAe;AAC5F,cAAc;AACd,iCAAiC,eAAe;AAChD,gBAAgB,8DAAyB;AACzC;AACA,SAAS;AACT;AACA,6BAA6B,eAAe;AAC5C,YAAY,8DAAyB;AACrC;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,+DAA+D;;AAE/D;;AAEA,gDAAgD;AAChD;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA,SAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;;AAEA,qDAAqD;;AAErD;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,yBAAyB;AACzC;AACA;;AAEA,gBAAgB,sBAAsB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,oBAAoB;AACpC;AACA,wBAAwB,wBAAwB;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAsB,mBAAmB;;AAEzC,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,wBAAwB;AAC5C;AACA;;AAEA,kCAAkC;AAClC;AACA,UAAU,MAAM;AAChB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oBAAoB,wBAAwB;AAC5C;AACA;;AAEA,kCAAkC;AAClC;AACA,UAAU,MAAM;AAChB;AACA;;AAEA,qCAAqC,qBAAqB;AAC1D,yCAAyC,qBAAqB;AAC9D;AACA;;AAEA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA,iDAAiD,8DAAqB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAkB,MAAM;AACxB;AACA;AACA;AACA;AACA,iDAAiD,8DAAqB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gCAAgC,kBAAkB;AAClD;AACA,oCAAoC,qBAAqB;AACzD;AACA,yCAAyC,8DAAyB;AAClE,0BAA0B;AAC1B,mDAAmD;AACnD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;;AAEvB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;;AAEnD,iBAAiB;AACjB,iBAAiB;AACjB;;AAEA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,gBAAgB,gBAAgB;;AAEhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oBAAoB,gBAAgB;AACpC;AACA;AACA,qBAAqB,gEAA2B;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,gBAAgB,gBAAgB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA,6DAA6D,gEAA2B;AACxF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,gBAAgB;AACpC,kBAAkB,8DAAyB;AAC3C;;AAEA;AACA;;AAEA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oBAAoB,SAAS;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;;AAEA;AACA;;AAEA,iEAAe,SAAS;;;;;;;;;;;;;;;;AC51DiB;;AAEzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,QAAQ,iFAA4C;AACpD;AACA;AACA,QAAQ,iFAA4C;AACpD;AACA;;AAEA,QAAQ,yEAAoC;AAC5C,YAAY,iFAA4C;AACxD;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,YAAY,iFAA4C;AACxD;AACA;AACA,YAAY,iFAA4C;AACxD;AACA;;AAEA,YAAY,yEAAoC;AAChD;AACA,+CAA+C;AAC/C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iFAA4C;AAChE;AACA,kBAAkB;AAClB;AACA;AACA,oBAAoB,iFAA4C;AAChE;AACA;AACA,oBAAoB,iFAA4C;AAChE;AACA;AACA,oBAAoB,iFAA4C;AAChE;AACA;AACA;AACA;AACA,oBAAoB,iFAA4C;AAChE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,iFAA4C;AAChF;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA,oBAAoB,iFAA4C;AAChE;AACA;AACA,oBAAoB,iFAA4C;AAChE;AACA;AACA;AACA;AACA,oBAAoB,iFAA4C;AAChE;AACA;;AAEA;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;;AAEA,oBAAoB,yEAAoC;AACxD;AACA,kBAAkB;AAClB;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA,kBAAkB;AAClB;AACA;;AAEA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,yEAAoC;AACxD;AACA;AACA,oBAAoB,iFAA4C;AAChE;AACA;AACA;;AAEA;AACA;;AAEA;AACA,+EAA+E;AAC/E;AACA,2EAA2E;AAC3E,iBAAiB;AACjB,iDAAiD;AACjD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+EAA+E;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV,yDAAyD,iEAA4B;AACrF;AACA,MAAM;AACN;AACA;AACA,UAAU;AACV,yDAAyD,iEAA4B;AACrF;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA,oCAAoC,4EAAuC;AAC3E;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,+DAA0B;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,2BAA2B,4DAA4D;AACvF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAuF;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,+BAA+B,iFAA4C;AAC3E;AACA;AACA;AACA,oCAAoC,4EAAuC,+CAA+C;;AAE1H;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,sCAAsC;AACtC;AACA,wBAAwB,OAAO,OAAO,QAAQ,GAAG,aAAa,eAAe;AAC7E;;AAEA,qBAAqB,mBAAmB;AACxC;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qCAAqC;;AAErC;;AAEA;AACA;AACA;AACA,gCAAgC,qBAAqB;AACrD;AACA;AACA;AACA,yFAAyF,+DAA0B;;AAEnH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sGAAsG,+DAA0B;AAChI;AACA;AACA,oFAAoF,+DAA0B;AAC9G;AACA;;AAEA;AACA,sFAAsF;AACtF;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,6EAA6E;AAC7E;AACA;AACA;AACA;AACA;AACA,oFAAoF,+DAA0B;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6FAA6F,+DAA0B,sCAAsC,+DAA0B;AACvL;AACA,gCAAgC,mBAAmB;AACnD,8EAA8E;AAC9E;;AAEA,4CAA4C,sBAAsB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA,kBAAkB;AAClB,wBAAwB,8DAAyB;AACjD;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,yEAAyE;AACpG;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,4DAA4D,kCAAkC,GAAG,IAAI;AACrG;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;;AAEA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,8DAAyB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;;AAEA,8CAA8C,aAAa;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;;AAEA,uCAAuC;AACvC,mDAAmD;AACnD;AACA,2FAA2F,gCAAgC;AAC3H;AACA;AACA;AACA;;AAEA,uCAAuC;AACvC,mDAAmD;AACnD;AACA;AACA,+FAA+F,gCAAgC;;AAE/H;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,+BAA+B;AAC/B,yDAAyD;AACzD,0DAA0D;AAC1D,6DAA6D;;AAE7D,2CAA2C;AAC3C;AACA;;AAEA;;AAEA,2FAA2F,6DAA6D;;AAExJ,mFAAmF,6DAA6D;AAChJ;AACA;AACA,MAAM;AACN,2BAA2B;AAC3B,uCAAuC;AACvC;AACA;AACA,mFAAmF,6DAA6D;AAChJ;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA,iEAAe;AACf;AACA;AACA,CAAC;;;;;;;;;;;;;;;;;;;AC7oCuC;AACN;AACmB;AACT;;AAE5C;AACA;AACA;AACA;AACA;;AAEA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,CAAC,EAAE;AACH;AACA;AACA,oBAAoB,mEAAwB;AAC5C;;AAEA;AACA;AACA;AACA,oBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA,iDAAiD,iBAAiB;AAClE;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA,iDAAiD,iBAAiB;AAClE;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;;AAEA;AACA,gCAAgC,0BAA0B;AAC1D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,SAAS;AACT,MAAM;AACN;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB,6BAA6B,iDAAiD,EAAE;AACxG,MAAM;AACN;AACA,wBAAwB,wBAAwB;AAChD;AACA;AACA;AACA,gCAAgC,yBAAyB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,iDAAiD;AACxF;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,6BAA6B,iDAAiD,EAAE;AAC9G;AACA;AACA;;AAEA;AACA,wBAAwB,QAAQ,QAAQ;AACxC,+DAA+D;AAC/D;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,QAAQ,QAAQ;AACxC,uEAAuE;AACvE;AACA;;AAEA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,4BAA4B;AAC5B,MAAM;AACN,4BAA4B;AAC5B;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,oCAAoC,gBAAgB;AACpD;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,gCAAgC;AAC1E;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA,yBAAyB;AACzB;;AAEA;AACA;AACA;AACA,iDAAiD,EAAE,qEAA4B;AAC/E;;AAEA;AACA;AACA;AACA;AACA,6BAA6B,0BAA0B;AACvD;;AAEA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA,wBAAwB,0CAA0C;AAClE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA,sEAAsE,wBAAwB;AAC9F;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,wCAAwC,IAAI;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA,0CAA0C,IAAI;AAC9C;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb,0CAA0C,qBAAqB;AAC/D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;;AAEA;AACA;AACA,qBAAqB;AACrB,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D;AACA;AACA;AACA,SAAS;;AAET;AACA,YAAY,8DAA4B;AACxC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oCAAoC,gBAAgB;AACpD;AACA;AACA;AACA;AACA,uGAAuG;AACvG;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oBAAoB,2DAAyB;AAC7C;;AAEA,mEAAmE;AACnE;AACA,kBAAkB;AAClB;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6BAA6B,gEAAgE;AAC7F;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0DAA0D;AAC1D,+DAA+D;AAC/D;;AAEA;AACA;AACA;AACA;;AAEA;AACA,gEAAgE;AAChE,qEAAqE;AACrE;AACA;;AAEA,yFAAyF;AACzF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,8BAA8B;AAC9B;AACA;AACA;AACA;AACA,iCAAiC;AACjC;;AAEA,yBAAyB;AACzB,sBAAsB;AACtB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yCAAyC,iBAAiB;AAC1D;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB,iDAAiD,iBAAiB;AAClE;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA,2CAA2C,6DAA6D;AACxG;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA,uCAAuC,6DAA6D;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,uCAAuC;AACvC;AACA,UAAU;AACV;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,UAAU;AACV,sDAAsD;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,uCAAuC;AACvC;AACA;AACA,UAAU;AACV;AACA;AACA,MAAM;AACN;AACA;AACA,UAAU;AACV,sDAAsD;AACtD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,UAAU;AACV,mCAAmC;AACnC;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,UAAU;AACV,sDAAsD;AACtD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,oCAAoC,gBAAgB;AACpD;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yFAAyF,EAAE;;AAE3F;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,wBAAwB;AAC5C;AACA;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAoB;AACpB,wBAAwB,aAAa;AACrC;AACA,sDAAsD;AACtD;;AAEA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA,MAAM,MAAM;AACZ,wBAAwB,sBAAsB;AAC9C;AACA,oCAAoC;AACpC;;AAEA;AACA,iDAAiD;AACjD;;AAEA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA,kBAAkB,kBAAkB;AACpC;AACA;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;;AAEA,kBAAkB,kBAAkB;AACpC;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,uDAAuD,2BAA2B;AAClF,uDAAuD,wBAAwB;AAC/E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,mFAAmF;AACnF;AACA,cAAc;AACd,8BAA8B;AAC9B;AACA;;AAEA,sDAAsD,wBAAwB;AAC9E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;;AAEA,sDAAsD,2BAA2B;;AAEjF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM;;AAEN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gGAAgG,8BAA8B;AAC9H,gGAAgG,8BAA8B;AAC9H,mGAAmG,8BAA8B;AACjI,iGAAiG,8BAA8B;AAC/H,4GAA4G,8BAA8B;AAC1I,wBAAwB,qCAAqC,wCAAwC,2BAA2B,yBAAyB,0BAA0B,sCAAsC,yBAAyB,uBAAuB,uCAAuC,0BAA0B,wBAAwB,qCAAqC,wBAAwB,sBAAsB,wBAAwB,uBAAuB,oBAAoB,kBAAkB,4DAA4D,gBAAgB,oBAAoB,kBAAkB,mBAAmB,mBAAmB,mBAAmB,oBAAoB,kBAAkB,mBAAmB,iBAAiB,mBAAmB,oBAAoB,oBAAoB,oBAAoB;AAC90B,mGAAmG,qBAAqB;AACxH;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,MAAM,MAAM;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA;AACA,4CAA4C;AAC5C;AACA;AACA,4CAA4C;AAC5C;AACA,0EAA0E;AAC1E,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,+BAA+B,mBAAmB,MAAM;AACxD,mCAAmC,mBAAmB,MAAM;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,+BAA+B,wDAAwD,iBAAiB;AACxG,cAAc;AACd,yDAAyD;AACzD;;AAEA;AACA;AACA;AACA,+BAA+B,wDAAwD,mBAAmB;;AAE1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,MAAM;AACN;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,cAAc;AACtC;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,yCAAyC,iBAAiB;AAC1D,4CAA4C,gBAAgB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAA0B,2CAA2C;AACrE;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,gBAAgB,+CAA+C;AAC/D;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,4BAA4B;AAC5B,UAAU;AACV,4BAA4B;AAC5B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA,0BAA0B,MAAM;AAChC;AACA;AACA,sBAAsB,uFAAuF;AAC7G;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA;AACA,+FAA+F;AAC/F;AACA;AACA,0BAA0B,MAAM;AAChC;AACA;AACA;AACA,sBAAsB,uFAAuF;AAC7G;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,2FAA2F;AAC3F;AACA;AACA,0BAA0B,MAAM;AAChC;AACA;AACA,sBAAsB,uFAAuF;AAC7G;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA;AACA,+FAA+F;AAC/F;AACA;AACA,0BAA0B,MAAM;AAChC;AACA;AACA;AACA,sBAAsB,uFAAuF;AAC7G;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,oBAAoB,OAAO;AAC/D,6CAA6C,qBAAqB;AAClE;AACA,yHAAyH,aAAa;AACtI;AACA;AACA;AACA,UAAU,6BAA6B;AACvC;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA,sGAAsG;AACtG;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,sGAAsG;AACtG;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,oBAAoB;AACxD;AACA;AACA,UAAU,MAAM;AAChB;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA,sGAAsG;AACtG;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,sGAAsG;AACtG;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,oBAAoB;AACxD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,6EAA6E,0CAA0C;AACvH;AACA;AACA,gFAAgF,6CAA6C;AAC7H;AACA;AACA,8EAA8E,2CAA2C;AACzH;AACA;AACA,+EAA+E,4CAA4C;AAC3H;;AAEA;AACA;AACA;AACA;AACA,sGAAsG,qBAAqB;AAC3H,4GAA4G,kBAAkB;AAC9H;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,yDAAyD,iBAAiB;AAC1E,8DAA8D,mBAAmB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,6CAA6C,eAAe;AAC5D;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,kEAAuB;AAC3B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,8DAA8D,yEAAyE;AACvI;AACA,6EAA6E,yEAAyE;AACtJ;AACA;AACA,8DAA8D,uEAAuE;AACrI;AACA,6EAA6E,uEAAuE;AACpJ;AACA;;AAEA;AACA;AACA,6FAA6F,yBAAyB;AACtH,6FAA6F,gCAAgC;;AAE7H,iCAAiC,eAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qCAAqC,+BAA+B;AACpE;AACA,aAAa;AACb,UAAU;AACV,qCAAqC,+BAA+B;AACpE;AACA,aAAa;AACb;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,MAAM;;AAEN;;;AAGA;AACA;;AAEA,iEAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;AC5yFA;AACyC;AACI;AACE;AACd;;AAEjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV,+DAA+D;AAC/D,mCAAmC;AACnC;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,cAAc;AACd;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,sEAAiC;AACjD;AACA,SAAS;AACT;AACA;AACA,YAAY,8DAAyB;AACrC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+GAA+G;AAC/G;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA,uCAAuC,mBAAmB,MAAM;AAChE;AACA,2CAA2C,mBAAmB;AAC9D;AACA,6FAA6F;;AAE7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,kBAAkB,8DAAqB;AACvC,8CAA8C;AAC9C,YAAY;AACZ,gBAAgB,uEAAkC;AAClD;AACA,YAAY,mEAA8B;AAC1C;AACA;;AAEA,YAAY,kEAA6B;AACzC,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B,oBAAoB;AAChD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qGAAqG;AACrG;AACA;AACA,qGAAqG;AACrG;AACA;AACA;AACA,4HAA4H;AAC5H;AACA;AACA;AACA;AACA,2CAA2C,iHAAiH,mBAAmB;AAC/K,yBAAyB;AACzB,sBAAsB;AACtB;AACA;AACA,+CAA+C,iHAAiH,iBAAiB;AACjL,6BAA6B;AAC7B;AACA;AACA,kHAAkH;AAClH;AACA;AACA;;AAEA,+GAA+G;;AAE/G;AACA;AACA,wFAAwF;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAwF;AACxF;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;;AAEA;AACA,uCAAuC;AACvC;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;;AAEA,gCAAgC,sEAAiC;AACjE;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;AACA,4BAA4B,sEAAiC;AAC7D;AACA;AACA;AACA;AACA,iCAAiC;AACjC,8BAA8B;AAC9B;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,2EAA2E;AAC3E,yBAAyB,uEAAkC;AAC3D,wBAAwB,8DAAyB;AACjD;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,oGAAoG,iDAAiD;AACrJ;AACA,6GAA6G,iDAAiD;AAC9J;AACA;AACA,8GAA8G,iDAAiD;AAC/J;AACA;AACA,gHAAgH,iDAAiD;AACjK;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,gBAAgB,mEAA8B;AAC9C;AACA;AACA,YAAY,2DAAsB;;AAElC;AACA,gBAAgB,8DAAyB;AACzC;AACA;;AAEA;AACA,SAAS;AACT,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA4B,mBAAmB;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,oEAA+B;AAC/C;;AAEA;AACA,wBAAwB;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B,mBAAmB;AAC/C;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;;AAEA;;AAEA,6GAA6G;AAC7G;AACA,4CAA4C,sEAAiC;AAC7E;AACA;AACA;AACA,oCAAoC,8DAAyB;AAC7D;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,mFAAmF;AACtJ;AACA,mEAAmE,8EAA8E;AACjJ,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA,mEAAmE,4FAA4F;AAC/J;AACA,mEAAmE,uFAAuF;AAC1J,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA,kCAAkC;AAClC;AACA;AACA;AACA,uDAAuD,4FAA4F;AACnJ;AACA,uDAAuD,uFAAuF;AAC9I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,oGAAoG;AACpG;AACA;AACA;AACA;AACA,oBAAoB,8DAAyB;AAC7C;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,oEAA+B;AAC/C;AACA,cAAc;AACd;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA,gBAAgB,8DAAyB;AACzC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,6DAA6D;AAC7D;AACA,2BAA2B,iEAAiE;;AAE5F;;AAEA;AACA,kBAAkB,+DAA0B,4DAA4D,sBAAsB;;AAE9H;AACA,wCAAwC,8DAAyB;AACjE;AACA;;AAEA;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,wFAAwF,iDAAiD;AACzI,YAAY,2EAAsC,6BAA6B,iDAAiD;AAChI,YAAY,oEAA+B;AAC3C,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA,8DAA8D;AAC9D;AACA;AACA,8CAA8C;;AAE9C,kFAAkF;AAClF;AACA;AACA;AACA;AACA,gFAAgF;AAChF;AACA;AACA,mHAAmH;AACnH;AACA;AACA,4EAA4E;AAC5E;AACA;AACA,mHAAmH;AACnH;AACA,4GAA4G;AAC5G;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0CAA0C;AAC1C;AACA;AACA,iCAAiC,UAAU;AAC3C;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;;AAEA;AACA;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA;AACA;;AAEA,2BAA2B,uHAAuH;AAClJ;;AAEA;AACA;AACA,aAAa;AACb,YAAY,2EAAsC,6BAA6B,iDAAiD;;AAEhI,YAAY,oEAA+B;AAC3C,SAAS;AACT;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;;AAEA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,2EAA2E;AAC3E;AACA;AACA,2CAA2C;AAC3C;AACA,8DAA8D;AAC9D;AACA,6EAA6E;AAC7E;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,kGAAkG;AAClG;AACA;AACA;AACA,8CAA8C;;AAE9C,kFAAkF;AAClF;AACA;AACA;AACA,uCAAuC;AACvC,oFAAoF;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,MAAM;AACpC,oFAAoF;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iEAAiE,2EAA2E;AAC5I,cAAc;AACd,+BAA+B,+DAA+D;AAC9F;AACA;AACA,YAAY,+DAA0B,4DAA4D,sBAAsB;;AAExH;AACA;AACA,0CAA0C;AAC1C;AACA,4CAA4C;AAC5C,qCAAqC,KAAK,sEAAiC,mBAAmB;AAC9F,gEAAgE;AAChE,8DAA8D;AAC9D;AACA,kBAAkB;AAClB,qCAAqC,KAAK,sEAAiC,4BAA4B;AACvG;AACA,kDAAkD;AAClD,yDAAyD;AACzD;AACA;AACA;;AAEA,6CAA6C;AAC7C;;AAEA,gCAAgC,4BAA4B;AAC5D;AACA;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA;AACA;;AAEA;AACA,YAAY,mEAA8B;;;AAG1C;;AAEA;AACA;AACA;AACA,aAAa;AACb,YAAY,2EAAsC,6BAA6B,8CAA8C;;AAE7H,YAAY,oEAA+B;AAC3C,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA,8DAA8D;AAC9D;AACA;AACA,8CAA8C;;AAE9C,kFAAkF;AAClF;AACA;AACA;AACA;AACA,gFAAgF;AAChF;AACA;AACA,mHAAmH;AACnH;AACA;AACA,4EAA4E;AAC5E;AACA;AACA,mHAAmH;AACnH;AACA,4GAA4G;AAC5G;AACA;AACA;AACA;AACA;AACA;;AAEA,+CAA+C,aAAa;AAC5D;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,iCAAiC,UAAU;AAC3C;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;;AAEA;AACA;AACA;AACA;AACA,gCAAgC,uBAAuB;AACvD;AACA;AACA;;AAEA;AACA,YAAY,mEAA8B;AAC1C;AACA,2BAA2B,0HAA0H;;AAErJ;AACA;AACA,aAAa;AACb,YAAY,2EAAsC,6BAA6B,iDAAiD;;AAEhI,YAAY,oEAA+B;AAC3C,SAAS;AACT;AACA,YAAY,8DAAyB;AACrC,SAAS;AACT;AACA,qCAAqC;AACrC;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;;AAEA,YAAY,8DAAyB;AACrC,SAAS;AACT;AACA;AACA,0CAA0C;AAC1C;AACA,SAAS;AACT;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,gBAAgB,8DAAyB;;AAEzC;AACA;;AAEA;AACA,gBAAgB,qEAAgC;AAChD;AACA,YAAY,qEAA0B;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA,cAAc;AACd;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,SAAS;AACT,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA,sFAAsF,mBAAmB;AACzG;AACA,SAAS;AACT;AACA;AACA;AACA,sFAAsF,mBAAmB;AACzG;AACA,SAAS;AACT;AACA,gBAAgB,yEAAoC;AACpD;AACA,cAAc;AACd;AACA;AACA;AACA,SAAS;AACT;AACA,gBAAgB,iFAA4C;AAC5D;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6EAA6E;AAC7E;AACA;AACA,wBAAwB,+DAA0B;AAClD;AACA;AACA;AACA;AACA,wBAAwB,+DAA0B;AAClD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,mBAAmB,sEAAiC;AACpD,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,uCAAuC;AAC3F;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,uCAAuC;AAC3F;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA,wCAAwC,+DAA0B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA,yCAAyC;AACzC,qCAAqC;AACrC,yDAAyD;AACzD;AACA,iDAAiD,4EAAuC;AACxF;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA,oDAAoD,uCAAuC;AAC3F;AACA;AACA;AACA,2FAA2F,2CAA2C;AACtI;AACA;AACA;AACA,+FAA+F,2CAA2C;AAC1I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,8DAAyB;AACrE;AACA;AACA;AACA,mEAAmE,yFAAyF;AAC5J,oDAAoD,8DAAyB;AAC7E,iDAAiD;AACjD,6CAA6C;AAC7C;AACA,qCAAqC;AACrC,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,oBAAoB;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA,oDAAoD,mBAAmB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,oDAAoD,mBAAmB;AACvE;AACA;AACA;AACA;AACA;AACA,2DAA2D,oBAAoB;AAC/E;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA,wCAAwC,8DAAyB;AACjE;AACA;AACA,yDAAyD,wCAAwC;AACjG,+FAA+F,2CAA2C;AAC1I;AACA;AACA;AACA;;AAEA,8DAA8D,uEAAuE;AACrI;AACA;AACA;AACA,6CAA6C;AAC7C,4CAA4C,oEAA+B;AAC3E,4CAA4C,8DAAyB;AACrE,yCAAyC;AACzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA,wCAAwC,8DAAyB;AACjE;AACA;AACA,yDAAyD,wCAAwC;AACjG,+FAA+F,2CAA2C;AAC1I;AACA;AACA;AACA;;AAEA,8DAA8D,uEAAuE;AACrI;AACA;AACA;AACA,6CAA6C;AAC7C,4CAA4C,oEAA+B;AAC3E,4CAA4C,8DAAyB;AACrE,yCAAyC;AACzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA,wCAAwC,8DAAyB;AACjE;AACA;AACA,yDAAyD,wCAAwC;AACjG,+FAA+F,2CAA2C;AAC1I;AACA;AACA;AACA;;AAEA,8DAA8D,uEAAuE;AACrI;AACA;AACA;AACA,6CAA6C;AAC7C,4CAA4C,oEAA+B;AAC3E,4CAA4C,8DAAyB;AACrE,yCAAyC;AACzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA,wCAAwC,8DAAyB;AACjE;AACA;AACA,yDAAyD,wCAAwC;AACjG,+FAA+F,2CAA2C;AAC1I;AACA;AACA;AACA;;AAEA,8DAA8D,uEAAuE;AACrI;AACA;AACA;AACA,6CAA6C;AAC7C,4CAA4C,oEAA+B;AAC3E,4CAA4C,8DAAyB;AACrE,yCAAyC;AACzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA,wCAAwC,8DAAyB;AACjE;AACA;AACA,yDAAyD,wCAAwC;AACjG,+FAA+F,2CAA2C;AAC1I;AACA;AACA;AACA;;AAEA,8DAA8D,uEAAuE;AACrI;AACA;AACA;AACA,6CAA6C;AAC7C,4CAA4C,oEAA+B;AAC3E,4CAA4C,8DAAyB;AACrE,yCAAyC;AACzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,qCAAqC;AACrC;AACA,wCAAwC,8DAAyB;AACjE;AACA;AACA,yDAAyD,wCAAwC;AACjG,+FAA+F,2CAA2C;AAC1I;AACA;AACA;AACA;;AAEA,8DAA8D,uEAAuE;AACrI;AACA;AACA;AACA,6CAA6C;AAC7C,4CAA4C,oEAA+B;AAC3E,4CAA4C,8DAAyB;AACrE,yCAAyC;AACzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,0DAA0D,4DAAuB,mBAAmB,eAAe;AACnH,sCAAsC;AACtC,0DAA0D,4DAAuB,mBAAmB,eAAe;AACnH;AACA,oCAAoC,8DAAyB;AAC7D;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,0DAA0D,4DAAuB,mBAAmB,eAAe;AACnH,sCAAsC;AACtC,0DAA0D,4DAAuB,mBAAmB,eAAe;AACnH;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,4BAA4B,4DAAuB,uBAAuB,iBAAiB;AAC3F,4BAA4B,4DAAuB,oBAAoB,iBAAiB;AACxF;AACA,4BAA4B,8DAAyB;AACrD,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,wCAAwC,8DAAyB;AACjE;AACA,sCAAsC;AACtC,wCAAwC,8DAAyB;AACjE;AACA;AACA,4CAA4C,mEAA8B;AAC1E,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,qEAAgC;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wDAAwD,8DAAyB;AACjF;AACA,sDAAsD;AACtD,wDAAwD,mEAA8B;AACtF;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA,gCAAgC,kEAAuB;AACvD;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA,IAAI,oEAAyB;;AAE7B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,0CAA0C;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,8CAA8C;AAC9C,QAAQ,8DAAyB;AACjC;;AAEA;;AAEA,gBAAgB,qCAAqC;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,QAAQ,8DAAyB;AACjC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,wBAAwB,UAAU;AAClC;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mCAAmC;AACnC;AACA;;AAEA,oCAAoC;AACpC;AACA;AACA,kBAAkB;AAClB;AACA,mEAAmE;AACnE;AACA;AACA,qEAAqE;AACrE;AACA;AACA,kBAAkB;AAClB;AACA,0FAA0F;AAC1F;AACA;AACA;AACA,sCAAsC;;AAEtC,0EAA0E;AAC1E;AACA;AACA;AACA,gCAAgC;AAChC,qFAAqF;AACrF;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,MAAM;AAC5B,4EAA4E;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;AC1iEkC;AACO;AACC;AACD;AACR;;AAEjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,+BAA+B,IAAI;AACnC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,gBAAgB,+DAA0B;AAC1C;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,0BAA0B;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,4DAAuB;AACvD,8DAA8D,aAAa;AAC3E;AACA,kEAAkE,aAAa;AAC/E,iCAAiC;AACjC;AACA,6BAA6B;AAC7B;AACA;;AAEA;AACA;AACA,wDAAwD,oBAAoB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;;AAEA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;;AAEA;AACA;AACA,6BAA6B;;AAE7B;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8DAAyB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,gCAAgC;AACjE;AACA;AACA,qBAAqB;AACrB,+BAA+B,kBAAkB;AACjD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,4BAA4B,8DAAyB;AACrD;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA,iGAAiG;AACjG;AACA,sDAAsD,UAAU;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,sCAAsC;AACtC,wCAAwC,8DAAyB;AACjE;AACA;AACA,iCAAiC;AACjC;AACA,oCAAoC,8DAAyB;AAC7D;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kDAAkD,2BAA2B;AAC7E,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;;AAEA;AACA,kDAAkD,2CAA2C;AAC7F,8BAA8B;AAC9B,kDAAkD,sBAAsB;AACxE,8BAA8B;AAC9B,kDAAkD,0CAA0C;AAC5F,8BAA8B;AAC9B,kDAAkD,qBAAqB;AACvE;AACA,yBAAyB;AACzB;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;;AAErB,oBAAoB,wDAAY;AAChC,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B,gKAAgK;AAChK;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,6BAA6B;AAC7E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA,wDAAwD,wCAAwC;AAChG;AACA;AACA,sEAAsE,8DAAyB;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wCAAwC,iCAAiC;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,oCAAoC,+DAAsB;AAC1D,kCAAkC;AAClC,gDAAgD,uEAA8B;;AAE9E;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,oCAAoC,2EAAkC;AACtE,wCAAwC,+DAAsB;AAC9D;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA,6DAA6D;AAC7D;AACA;;AAEA;AACA;AACA,0CAA0C;AAC1C;AACA;;AAEA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA,wCAAwC,+DAAsB;AAC9D;AACA,kCAAkC;AAClC;AACA,gDAAgD,uEAA8B;AAC9E;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;;AAEA;AACA;AACA,0CAA0C;AAC1C;AACA;;AAEA;;AAEA,wCAAwC,2EAAkC;AAC1E,4CAA4C,+DAAsB;AAClE;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA,4BAA4B,wEAA+B;AAC3D,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA,yDAAyD;AACzD;AACA,8BAA8B;AAC9B,8DAA8D,EAAE,qEAA4B;AAC5F,wEAAwE;AACxE;;AAEA,4BAA4B,+DAAsB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,mCAAmC,iEAA4B;;AAE/D;AACA;;AAEA;AACA;;AAEA;AACA,4BAA4B,uEAAkC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,iEAA4B;AAC5E;AACA,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC,iCAAiC;AACjC;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,4BAA4B,uEAAkC;AAC9D;AACA,4DAA4D,gBAAgB;AAC5E;AACA,sEAAsE,+BAA+B;AACrG;AACA;AACA;;AAEA;AACA,iCAAiC;AACjC,6BAA6B;AAC7B;AACA;AACA,oCAAoC,2DAAsB;;AAE1D;AACA,oCAAoC,8DAAyB;AAC7D,iCAAiC;AACjC,6BAA6B;AAC7B,0BAA0B;AAC1B;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,+DAA0B;;AAElD;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA,8BAA8B;AAC9B,0EAA0E;AAC1E;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,wBAAwB,uEAAkC;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA4C,iEAA4B;AACxE;AACA,iCAAiC;AACjC,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,6BAA6B;;AAE7B;AACA,qBAAqB;AACrB;AACA;AACA;AACA;;AAEA;AACA,4BAA4B,uEAAkC;AAC9D;AACA,4DAA4D,gBAAgB;AAC5E;AACA;AACA,0EAA0E,iCAAiC;AAC3G;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wDAAwD,kBAAkB;AAC1E;AACA,0EAA0E,kBAAkB;AAC5F;AACA;AACA;AACA,2DAA2D,4DAAuB,oBAAoB,wBAAwB;AAC9H;;AAEA;AACA,iCAAiC;AACjC,6BAA6B;AAC7B;AACA;AACA,oCAAoC,2DAAsB;;AAE1D;AACA,oCAAoC,8DAAyB;AAC7D,iCAAiC;AACjC,6BAA6B;AAC7B,0BAA0B;AAC1B;AACA,4BAA4B,8DAAyB;AACrD;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,OAAO;AAC/C;AACA,iDAAiD,2BAA2B;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,sFAAiD;AACzE;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA,wBAAwB,oFAA+C,EAAE,yBAAyB;AAClG,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;;AAEA;AACA;AACA,8EAA8E,gCAAgC;AAC9G,0BAA0B;AAC1B,8EAA8E,gBAAgB;AAC9F;;AAEA,wBAAwB,8DAAyB;AACjD;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,qBAAqB;AAC/E;AACA;AACA;AACA,gDAAgD,kBAAkB;AAClE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,4BAA4B,sFAAiD;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B,oFAA+C;AAC3E;;AAEA,4BAA4B,oFAA+C;AAC3E;;AAEA,4BAA4B,sFAAiD;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sFAAiD;;AAE7E;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,sFAAiD;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA,wBAAwB,oFAA+C;AACvE;;AAEA;AACA,wBAAwB,oFAA+C;AACvE;AACA;AACA,wBAAwB,oFAA+C;AACvE;;AAEA;AACA,wBAAwB,oFAA+C;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,wBAAwB,sFAAiD;AACzE;AACA,wBAAwB,sFAAiD;AACzE;AACA,wBAAwB,+DAA0B;AAClD;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA,wBAAwB,8DAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA,gBAAgB,8DAAyB;AACzC;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA,gBAAgB,8DAAyB;AACzC;AACA;AACA,gBAAgB,mEAA8B;AAC9C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,gCAAgC,sFAAiD;AACjF;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,4BAA4B,oEAA+B;AAC3D,4BAA4B,8DAAyB;AACrD;AACA;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,mEAA8B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,wBAAwB,sFAAiD;AACzE;;AAEA,wBAAwB,sFAAiD;AACzE;;AAEA,wBAAwB,sFAAiD;AACzE;;AAEA,wBAAwB,6EAAwC;AAChE,wBAAwB,6EAAwC;;AAEhE;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,8DAAyB;AACjD;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;;AAEA;AACA;AACA;AACA;;AAEA,gCAAgC,sEAAiC;AACjE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,8BAA8B;AAC9B;AACA;AACA;AACA,iCAAiC;AACjC;AACA;;AAEA,wCAAwC,6BAA6B;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8CAA8C,4DAAuB,mBAAmB,wCAAwC;AAChI,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,mCAAmC,8DAAyB;AACtH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,oFAA+C;;AAEvE,wBAAwB,sFAAiD;AACzE;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA,wBAAwB,8DAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6EAAwC;;AAEhE;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA,kEAAkE,iEAA4B;AAC9F;;AAEA,wCAAwC,qEAAgC;AACxE;AACA;AACA,wBAAwB,8DAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6EAAwC;;AAEhE;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA,4BAA4B,+DAA0B;AACtD;AACA,uDAAuD,iEAA4B;AACnF,6BAA6B;AAC7B;;AAEA;AACA,wBAAwB,8DAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,sFAAiD;AACzE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gCAAgC,iEAA4B;AAC5D,8BAA8B;AAC9B;AACA,oCAAoC,iEAA4B;AAChE,kCAAkC;AAClC,oCAAoC,iEAA4B;AAChE;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,yEAAgC;AACpE;AACA;AACA,oCAAoC,sFAAiD;;AAErF;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,sFAAiD;;AAEjF;AACA,6BAA6B;AAC7B;;AAEA;AACA;AACA,4BAA4B,yEAAgC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,4CAA4C,yEAAoC;AAChF;AACA,sFAAsF,+EAA0C;AAChI;AACA;AACA;AACA;AACA;AACA,gCAAgC,8DAAyB;AACzD,6BAA6B;AAC7B,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA,wCAAwC,yEAAoC;AAC5E;AACA,kFAAkF,+EAA0C;AAC5H;AACA;AACA;AACA;AACA,4BAA4B,8DAAyB;AACrD,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA,wBAAwB,6EAAwC;AAChE,wBAAwB,sFAAiD;AACzE;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,wCAAwC,qEAAgC;;AAExE,sDAAsD;AACtD;AACA,wBAAwB,uEAAkC;;AAE1D;AACA,wBAAwB,8DAAyB;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA,4BAA4B,+DAA0B;AACtD;AACA;AACA,6BAA6B;AAC7B;;AAEA;AACA,4BAA4B,+DAA0B;AACtD;AACA;AACA,6BAA6B;AAC7B;;AAEA;AACA,wBAAwB,8DAAyB;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6EAAwC;AAChE,wBAAwB,6EAAwC;AAChE,wBAAwB,6EAAwC;AAChE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uEAAkC;;AAE1D;AACA,wBAAwB,8DAAyB;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA,4BAA4B,+DAA0B;AACtD;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,4BAA4B,+DAA0B;AACtD;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,4BAA4B,+DAA0B;AACtD;AACA;AACA,6BAA6B;AAC7B;;AAEA;AACA,wBAAwB,8DAAyB;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,0BAA0B;AAC1B;AACA;;AAEA;AACA;AACA,0BAA0B;AAC1B,wEAAwE,6DAAwB;AAChG;;AAEA,8EAA8E;AAC9E,4JAA4J,GAAG;AAC/J;;AAEA;AACA,4BAA4B,4DAAuB;AACnD,sEAAsE,aAAa,+BAA+B,eAAe;AACjI,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,wBAAwB,oFAA+C;AACvE,wBAAwB,oFAA+C;AACvE,wBAAwB,oFAA+C;;AAEvE,wBAAwB,6EAAwC;AAChE;;AAEA;AACA,wBAAwB,sFAAiD;;AAEzE;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,wCAAwC;AACxC;;AAEA;AACA;AACA,8BAA8B;AAC9B,+DAA+D,6DAAwB;AACvF;;AAEA,4BAA4B,8DAAyB;AACrD;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,4BAA4B,8DAAyB;AACrD;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,oFAA+C;AACvE,wBAAwB,oFAA+C;AACvE,wBAAwB,6EAAwC;AAChE;;AAEA;AACA,wBAAwB,sFAAiD;;AAEzE;AACA;AACA;AACA,2CAA2C,8DAAyB;AACpE;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,wCAAwC;AACxC;;AAEA,4BAA4B,8DAAyB;AACrD;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,2CAA2C,8DAAyB;AACpE;;AAEA,4BAA4B,8DAAyB;AACrD;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,sFAAiD;AACzE,wBAAwB,oFAA+C;AACvE,wBAAwB,oFAA+C;;AAEvE;AACA;AACA,wBAAwB,6EAAwC;AAChE;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,wCAAwC;AACxC;;AAEA,4BAA4B,8DAAyB;AACrD;AACA,yBAAyB;;AAEzB,wBAAwB,yDAAuB;AAC/C;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,4BAA4B,8DAAyB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA,wBAAwB,6EAAwC;AAChE;AACA,2DAA2D,0BAA0B;AACrF;AACA,6BAA6B;AAC7B,yBAAyB;AACzB,wBAAwB,oFAA+C;AACvE;AACA;AACA;AACA;AACA,2DAA2D,sBAAsB;AACjF;AACA;AACA;AACA;;AAEA;;AAEA,wCAAwC;AACxC;;AAEA,4BAA4B,8DAAyB;AACrD;AACA,yBAAyB;;AAEzB,wBAAwB,yDAAuB;AAC/C;AACA,qBAAqB;AACrB;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,4BAA4B,8DAAyB;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,iEAA4B;AAC5C;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAA8B;AAClD,kBAAkB;AAClB,oBAAoB,8DAAyB;AAC7C;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA,2CAA2C,mBAAmB;AAC9D,+CAA+C,mBAAmB;AAClE;AACA,mDAAmD,4DAAuB;AAC1E;AACA;AACA,iCAAiC;AACjC,8BAA8B;AAC9B,mDAAmD,4DAAuB,oBAAoB,yBAAyB;AACvH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,gCAAgC,8DAAyB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8DAAyB;AACzC;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAmC;AACnC;;AAEA,QAAQ,qEAAgC;AACxC;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,YAAY,uEAAkC;AAC9C,yCAAyC,iBAAiB;AAC1D,4CAA4C,gBAAgB;AAC5D,6CAA6C,sEAAiC,UAAU;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,YAAY,qEAAgC;AAC5C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,QAAQ,qEAAgC;AACxC;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B;;AAE/B;AACA,oBAAoB,uCAAuC;AAC3D,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,gBAAgB,+DAA0B;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,gBAAgB,+DAA0B;AAC1C;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,wCAAwC;AACjG;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,8BAA8B;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA,YAAY,+DAA0B,mBAAmB,sBAAsB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,mBAAmB,iCAAiC;AAC9F,cAAc;AACd;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,2BAA2B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,mBAAmB,2BAA2B;AACxF,cAAc;AACd;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,iCAAiC;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,wBAAwB;AACjF;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,mBAAmB,6BAA6B;AAC1F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,mBAAmB,uBAAuB;AACpF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,wBAAwB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,0BAA0B;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,yBAAyB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,2BAA2B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,8BAA8B;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,8BAA8B;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+DAA0B,mBAAmB,2BAA2B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,mBAAmB,qBAAqB;AAClF,cAAc;AACd;AACA,gBAAgB,+DAA0B,mBAAmB,wBAAwB;AACrF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,mBAAmB,qBAAqB;AAClF,cAAc;AACd;AACA,gBAAgB,+DAA0B,mBAAmB,4BAA4B;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,mBAAmB,qBAAqB;AAClF,cAAc;AACd;AACA,gBAAgB,+DAA0B,mBAAmB,wBAAwB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAoB,6EAAwC;AAC5D,oBAAoB,6EAAwC;AAC5D,oBAAoB,6EAAwC;AAC5D,oBAAoB,6EAAwC;;AAE5D,oBAAoB,6EAAwC;AAC5D,oBAAoB,6EAAwC;AAC5D,oBAAoB,6EAAwC;AAC5D,oBAAoB,6EAAwC;;AAE5D;AACA;AACA;AACA;AACA;AACA,gCAAgC,+DAA0B,mBAAmB,yBAAyB;AACtG;AACA;AACA,gCAAgC,+DAA0B,mBAAmB,wBAAwB;AACrG;AACA;AACA,gCAAgC,+DAA0B,mBAAmB,0BAA0B;AACvG;AACA;AACA,gCAAgC,+DAA0B,mBAAmB,2BAA2B;AACxG;AACA;AACA,gCAAgC,+DAA0B,mBAAmB,uCAAuC;AACpH;AACA;AACA,gCAAgC,+DAA0B,mBAAmB,wCAAwC;AACrH;AACA;AACA,gCAAgC,+DAA0B,mBAAmB,2CAA2C;AACxH;AACA;AACA,gCAAgC,+DAA0B,mBAAmB,0CAA0C;AACvH;AACA;AACA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA;AACA,oBAAoB,8DAAyB;AAC7C;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,+DAA0B,mBAAmB,kBAAkB;AACnF;AACA;;AAEA,yCAAyC,wCAAwC;AACjF,+EAA+E,2CAA2C;AAC1H;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA,4BAA4B,8DAAyB;AACrD,yBAAyB;AACzB,qBAAqB;AACrB;AACA,kBAAkB;AAClB,oBAAoB,+DAA0B,mBAAmB,gBAAgB;AACjF;AACA;AACA,gBAAgB,oEAA+B;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,uCAAuC;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,mBAAmB,yFAAyF;;AAEtJ,oBAAoB,sEAAiC;AACrD,oBAAoB,+DAA0B,2BAA2B,uBAAuB;AAChG;AACA,oBAAoB,sEAAiC;AACrD,oBAAoB,+DAA0B,2BAA2B,sBAAsB;AAC/F;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uCAAuC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B;AAC1C,oBAAoB,sEAAiC;AACrD,oBAAoB,+DAA0B,2BAA2B,uBAAuB;AAChG;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uCAAuC;AAC/D;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B;AAC1C;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uCAAuC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,0BAA0B,qBAAqB;AACzF,oBAAoB,sEAAiC;AACrD,oBAAoB,+DAA0B,2BAA2B,sBAAsB;AAC/F;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uCAAuC;AAC/D;AACA;AACA;AACA,gBAAgB,+DAA0B,0BAA0B,sBAAsB;AAC1F;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAwB,uCAAuC;AAC/D;AACA;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA,gBAAgB,+DAA0B,0BAA0B,uBAAuB;AAC3F;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,YAAY,+DAA0B,mBAAmB,yFAAyF;AAClJ;AACA,gBAAgB,+DAA0B,mBAAmB,sDAAsD;AACnH;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,YAAY,+DAA0B,4BAA4B,uBAAuB;;AAEzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,gBAAgB,+DAA0B,6BAA6B,sBAAsB;AAC7F;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,uCAAuC;AAC/D;AACA;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA,gBAAgB,+DAA0B,0BAA0B,sBAAsB;AAC1F;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uCAAuC;AAC/D;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B,gCAAgC,sBAAsB;AAChG,gBAAgB,+DAA0B,iCAAiC,uBAAuB;AAClG;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA,oCAAoC,YAAY;AAChD,wBAAwB,4DAAuB,oBAAoB,sBAAsB,gBAAgB;AACzG,wBAAwB,4DAAuB,oBAAoB,sBAAsB;AACzF,wBAAwB,4DAAuB,oBAAoB,qBAAqB,gBAAgB;AACxG,wBAAwB,4DAAuB,oBAAoB,qBAAqB;AACxF;AACA,oCAAoC,YAAY;AAChD,wBAAwB,4DAAuB,oBAAoB,oBAAoB;AACvF,wBAAwB,4DAAuB,oBAAoB,oBAAoB;AACvF,wBAAwB,4DAAuB,oBAAoB,uBAAuB;AAC1F,wBAAwB,4DAAuB,oBAAoB,uBAAuB;AAC1F;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,+DAA0B;;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA,oBAAoB,+DAA0B,6BAA6B,sBAAsB;AACjG;;AAEA;AACA,oBAAoB,+DAA0B,4BAA4B,gFAAgF;AAC1J;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA,oBAAoB,+DAA0B,6BAA6B,+EAA+E;AAC1J;AACA,gBAAgB,+DAA0B;AAC1C;AACA;AACA,gBAAgB,+DAA0B;AAC1C;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,iEAA4B;AACxC;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,eAAe;;AAEvC;AACA;;AAEA;AACA;AACA,QAAQ,yEAAgC;AACxC;AACA,KAAK;AACL;AACA;AACA,YAAY,yEAAgC;AAC5C;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAoC,eAAe;AACnD;AACA;AACA,SAAS;AACT;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAoC,eAAe;AACnD;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,iFAAiF;AACjF;AACA;AACA;AACA;AACA;AACA,wBAAwB,uCAAuC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,yEAAoC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,MAAM;;AAEN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;;AAEA,SAAS,yEAAoC,wBAAwB;AACrE;AACA;;AAEA,mDAAmD;AACnD;;AAEA;AACA,gCAAgC;AAChC;AACA;AACA,gCAAgC;AAChC;;AAEA,QAAQ,yEAAoC;AAC5C;AACA,oCAAoC;AACpC;AACA,MAAM,MAAM;AACZ,QAAQ,+DAA0B,oBAAoB;AACtD;;AAEA;AACA;AACA;AACA,QAAQ,6EAAwC;;AAEhD;AACA,QAAQ,6EAAwC;AAChD;;AAEA,sCAAsC;AACtC;AACA;AACA,UAAU;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,4EAAuC,uDAAuD;AACtG;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA,IAAI,6EAAwC;AAC5C,IAAI,6EAAwC;AAC5C,IAAI,6EAAwC;;AAE5C,IAAI,6EAAwC;;AAE5C,IAAI,sFAAiD;;AAErD,IAAI,6EAAwC;;;AAG5C,IAAI,sFAAiD;AACrD,IAAI,6EAAwC;AAC5C,IAAI,6EAAwC;AAC5C;AACA,KAAK;;AAEL,IAAI,6EAAwC;AAC5C;AACA;AACA;AACA;AACA,IAAI,6EAAwC;AAC5C;AACA;AACA;AACA;AACA,IAAI,6EAAwC;AAC5C;AACA;AACA;AACA;AACA,IAAI,6EAAwC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6EAAwC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6EAAwC;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,IAAI,6EAAwC;AAC5C;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI,6EAAwC;AAC5C;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI,6EAAwC;AAC5C;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA,IAAI,+DAA0B;AAC9B;;;AAGA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;;AAEA,iEAAe,CAAC;;;;;;;;;;;;;;;;;;;;ACpkHhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACyC;AAC2C;AAC3C;AACI;AACZ;AACc;;AAE/C;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,wBAAwB;AACxB,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,YAAY,8DAAyB;AACrC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,kBAAkB;AAClB,oBAAoB,8DAAyB;AAC7C;AACA,aAAa;AACb;AACA,gBAAgB,8DAAyB;AACzC;AACA,SAAS;AACT;AACA,KAAK;;AAEL,IAAI,kEAA6B;AACjC,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB,8DAAyB;AACjD;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA,wBAAwB,8DAAyB;AACjD;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA,gBAAgB,8DAAyB;AACzC;AACA,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA,mDAAmD;;AAEnD;AACA;AACA,wBAAwB,8DAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,8DAAyB;AAC7D;AACA;AACA,6BAA6B;AAC7B,yBAAyB;AACzB,sBAAsB;AACtB,wBAAwB,8DAAyB;AACjD;AACA;AACA;AACA,yBAAyB;AACzB;;AAEA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,kBAAkB;AAClB;AACA,wBAAwB,8DAAyB;AACjD;AACA,qBAAqB;AACrB;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,4BAA4B;AAC5B,4BAA4B;AAC5B;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,mCAAmC;AACzG;AACA,UAAU;AACV;AACA;AACA,0EAA0E,mCAAmC;AAC7G,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,6EAAwC;;AAEhD,sCAAsC;;AAEtC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,wIAAwI;AACxI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA4B,uBAAuB;AACnD;AACA;AACA;;;AAGA,qCAAqC,qEAAgC;;AAErE;AACA,+DAA+D,iEAA4B;AAC3F;;AAEA,iCAAiC;;AAEjC;AACA;AACA,QAAQ,2DAAsB;;AAE9B,QAAQ,uEAAkC;;AAE1C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,6BAA6B,uEAAkC;AAC/D,uEAAuE,eAAe;AACtF;AACA,aAAa;AACb;;AAEA;AACA;AACA,YAAY,sEAA6B;AACzC;;AAEA;AACA,iEAAiE;AACjE;;AAEA;AACA,iEAAiE;AACjE;;AAEA;AACA,QAAQ,4EAAiC;;AAEzC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D,sBAAsB;AACtB,0DAA0D;AAC1D;AACA;AACA;AACA,0DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,yBAAyB;AACzB,+DAA+D;AAC/D;AACA;AACA;AACA;;AAEA;AACA,YAAY,2EAAsC;AAClD;;AAEA;;AAEA;AACA,sBAAsB,gBAAgB;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gDAAgD;AAChD,8EAA8E,mBAAmB;AACjG;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA,6CAA6C,mBAAmB;AAChE;AACA;AACA,qDAAqD,mBAAmB;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,QAAQ,oEAAgB;AACxB;AACA;AACA,gBAAgB,+DAA0B;AAC1C;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,SAAS;;AAET,mDAAmD;AACnD;AACA,YAAY,8DAAyB;AACrC;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB;;AAEhB,YAAY,8DAAyB;AACrC,SAAS;;AAET;AACA,YAAY,8DAAyB;AACrC;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,kBAAkB;AACpD,UAAU;AACV,kCAAkC,kBAAkB;AACpD;AACA;AACA;AACA;AACA;AACA;;AAEA,0CAA0C;AAC1C;AACA;AACA,cAAc;AACd;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAA2B,+EAA0C;AACrE;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,2DAA2D,+BAA+B;AAC1F;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,QAAQ,2DAAsB;AAC9B;AACA;AACA;AACA,kCAAkC,kBAAkB;AACpD,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,kBAAkB;AACtD;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI,0DAAqB;;AAEzB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,8DAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,eAAe,8DAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,eAAe,8DAAyB;AACxC;AACA;AACA;AACA;AACA,MAAM;AACN,eAAe,8DAAyB;AACxC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA,4BAA4B,8DAAyB;AACrD;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,cAAc;AACd;;AAEA,kBAAkB;AAClB;AACA;AACA;AACA;AACA,YAAY,2DAAsB;AAClC,SAAS;AACT;AACA;AACA;AACA,YAAY,2DAAsB;AAClC;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2DAA2D,iBAAiB;;AAE5E;AACA;AACA;;AAEA,iEAAe;AACf;AACA;AACA;AACA,CAAC,EAAC;;;;;;;UC9jCF;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;UENA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA","sources":["webpack://wp-table-manager-gutenberg/./app/admin/assets/js/_alternating.js","webpack://wp-table-manager-gutenberg/./app/admin/assets/js/_changeTheme.js","webpack://wp-table-manager-gutenberg/./app/admin/assets/js/_chart.js","webpack://wp-table-manager-gutenberg/./app/admin/assets/js/_customRenderer.js","webpack://wp-table-manager-gutenberg/./app/admin/assets/js/_functions.js","webpack://wp-table-manager-gutenberg/./app/admin/assets/js/_initHandsontable.js","webpack://wp-table-manager-gutenberg/./app/admin/assets/js/_toolbarOptions.js","webpack://wp-table-manager-gutenberg/./app/admin/assets/js/_wptm.js","webpack://wp-table-manager-gutenberg/webpack/bootstrap","webpack://wp-table-manager-gutenberg/webpack/runtime/define property getters","webpack://wp-table-manager-gutenberg/webpack/runtime/hasOwnProperty shorthand","webpack://wp-table-manager-gutenberg/webpack/runtime/make namespace object","webpack://wp-table-manager-gutenberg/webpack/before-startup","webpack://wp-table-manager-gutenberg/webpack/startup","webpack://wp-table-manager-gutenberg/webpack/after-startup"],"sourcesContent":["//alternate color handling functions\nimport tableFunction from \"./_functions\";\n\nconst alternating = {\n    /**\n     * Check that the selection matches the saved alternate values\n     *\n     * @param selection\n     * @param oldAlternate\n     * @returns {*}\n     */\n    setNumberAlternate : (selection, oldAlternate) => {\n        var count = _.size(oldAlternate);\n\n        window.jquery.each(oldAlternate, function (i, v) {\n            if (typeof v.selection !== 'undefined') {\n                if (v.selection[0] == selection[0] &&\n                    v.selection[1] == selection[1] &&\n                    v.selection[2] == selection[2] &&\n                    v.selection[3] == selection[3]) {\n                    count = i;\n                }\n            } else {\n                return count;\n            }\n        });\n\n        return count;\n    },\n    /**\n     * when select alternating_color\n     *\n     * @param value\n     * @param selection\n     * @param count\n     */\n    selectAlternatingColor : (value, selection, count) => {//when select alternating_color\n        //ij is row, ik is coll\n        var ij, ik;\n        var beforeChange = window.jquery.extend({}, window.Wptm.style.cells);\n        var size = _.size(window.table_function_data.checkChangeAlternate);\n        window.table_function_data.checkChangeAlternate[size] = {};\n\n        for (ij = selection[0]; ij <= selection[2]; ij++) {\n            for (ik = selection[1]; ik <= selection[3]; ik++) {\n                if (typeof (beforeChange[ij + \"!\" + ik]) !== 'undefined') {\n                    window.table_function_data.checkChangeAlternate[size][ij + \"!\" + ik] = beforeChange[ij + \"!\" + ik][2].AlternateColor;\n                    beforeChange[ij + \"!\" + ik][2] = window.jquery.extend(beforeChange[ij + \"!\" + ik][2], {AlternateColor: count});\n                } else { //cell not have style\n                    beforeChange[ij + \"!\" + ik] = [ij, ik, {}];\n                    beforeChange[ij + \"!\" + ik][2] = {AlternateColor: count};\n                }\n                if (typeof window.table_function_data.checkChangeAlternate[size][ij + \"!\" + ik] === 'undefined' || window.table_function_data.checkChangeAlternate[size][ij + \"!\" + ik] === null) {\n                    window.table_function_data.checkChangeAlternate[size][ij + \"!\" + ik] = -1;\n                }\n            }\n        }\n\n        window.Wptm.style.cells = beforeChange;\n\n        var listChangeAlternate = [];\n        var i = count, oldCount = count;\n        window.table_function_data.changeAlternate = [];\n        for (var ii = count - 1; ii >= 0; ii--) {\n            var check = 1;\n            if (value[ii] !== false && typeof value[ii].selection !== 'undefined') {\n                if(value[ii].selection[0] >= value[i].selection[0]) {\n                    check++;\n                }\n\n                if(value[ii].selection[1] >= value[i].selection[1]) {\n                    check++;\n                }\n\n                if(value[ii].selection[2] <= value[i].selection[2]) {\n                    check++;\n                }\n\n                if(value[ii].selection[3] <= value[i].selection[3]) {\n                    check++;\n                }\n            } else {\n                check = 5;\n            }\n\n            if (check === 5) {\n                value[ii] = value[count];\n                listChangeAlternate[ii] = count;\n                if (typeof listChangeAlternate[count] !== 'undefined') {\n                    listChangeAlternate[ii] = listChangeAlternate[count];\n                    delete listChangeAlternate[count];\n                }\n                delete value[count];\n                count--;\n                i = ii;\n            }\n        }\n        for (var j = 0; j < oldCount; j ++) {\n            if (typeof listChangeAlternate[j] !== 'undefined') {\n                window.table_function_data.changeAlternate[listChangeAlternate[j]] = j;\n            }\n        }\n        window.table_function_data.alternateIndex = count;\n        window.table_function_data.alternateSelection = selection;\n    },\n    /**\n     * Cancel alternateColor\n     */\n    reAlternateColor : () => {\n        var styleCells = {};\n        styleCells = window.jquery.extend({}, Wptm.style.cells);\n\n        for (var i = _.size(window.table_function_data.checkChangeAlternate) - 1; i >= 0; i--) {\n            window.jquery.map(window.table_function_data.checkChangeAlternate[i], function (v, ii) {\n                if (typeof styleCells[ii] !== 'undefined') {\n                    if (v !== -1) {\n                        styleCells[ii][2].AlternateColor = v;\n                    } else {\n                        delete styleCells[ii][2].AlternateColor;\n                    }\n                }\n            });\n        }\n\n        window.table_function_data.checkChangeAlternate = [];\n        return styleCells;\n    },\n\n\n\n    /**\n     * Set alternate color by alternate_row_odd_color option(in params)\n     *\n     * @param styleRows style.rows\n     * @param Wptm\n     * @param $element\n     */\n    setAlternateColor : (styleRows, Wptm, $element) => {\n        Wptm.style.table.alternateColorValue = {};\n\n        if (typeof Wptm.container !== 'undefined') {\n            var countCols = Wptm.container.handsontable('countCols');\n            var countRows = Wptm.container.handsontable('countRows');\n        } else {/*get count cols, rows when handsontable not activated*/\n            countCols = Wptm.datas[0].length - 1;\n            countRows = Wptm.datas.length - 1;\n        }\n\n        var checkExistAlternateOld = 0;\n        var checkExistAlternateEven = 0;\n\n        if (tableFunction.checkObjPropertyNested(Wptm.style.table, 'alternate_row_odd_color') && Wptm.style.table.alternate_row_odd_color) {\n            checkExistAlternateOld = 1;\n            // Wptm.style.table.alternate_row_odd_color;\n        }\n        if (tableFunction.checkObjPropertyNested(Wptm.style.table, 'alternate_row_even_color') && Wptm.style.table.alternate_row_even_color) {\n            checkExistAlternateEven = 1;\n            // Wptm.style.table.alternate_row_even_color;\n        }\n\n        var header = '';\n        if (styleRows !== null && typeof styleRows[0][1].cell_background_color !== 'undefined') {\n            header = styleRows[0][1].cell_background_color;\n        }\n\n        if (checkExistAlternateEven + checkExistAlternateOld > 0) {\n            Wptm.style.table.alternateColorValue = {};\n            Wptm.style.table.alternateColorValue[0] = {};\n            Wptm.style.table.alternateColorValue[0].selection = [0, 0, countRows - 1, countCols - 1];\n            Wptm.style.table.alternateColorValue[0].footer = '';\n            Wptm.style.table.alternateColorValue[0].even = checkExistAlternateEven === 1 ? Wptm.style.table.alternate_row_even_color : '#ffffff';\n            Wptm.style.table.alternateColorValue[0].header = header;\n            Wptm.style.table.alternateColorValue[0].old = checkExistAlternateOld === 1 ? Wptm.style.table.alternate_row_odd_color : '#ffffff';\n            Wptm.style.table.alternateColorValue[0].default = '' + header + '|' + Wptm.style.table.alternateColorValue[0].even + '|' + Wptm.style.table.alternateColorValue[0].old + '|' + '';\n            saveData.push({action: 'style', selection: [[0, 0, countRows, countCols]], style: {AlternateColor: 0}});\n        }\n\n        Wptm.style.table.alternate_row_even_color = null;\n        Wptm.style.table.alternate_row_odd_color = null;\n\n        if (typeof Wptm.style.table.alternateColorValue[0] !== 'undefined') {\n            var ij, ik;\n            for (ij = 0; ij <= countRows; ij++) {\n                for (ik = 0; ik <= countCols; ik++) {\n                    if (typeof (Wptm.style.cells[ij + \"!\" + ik]) !== 'undefined') {\n                        Wptm.style.cells[ij + \"!\" + ik][2].AlternateColor = 0;\n                    } else {\n                        Wptm.style.cells[ij + \"!\" + ik] = [ij, ik, {}];\n                        Wptm.style.cells[ij + \"!\" + ik][2] = jQuery.extend({}, {AlternateColor: 0});\n                    }\n                    if (header !== '' && ij === 0) {\n                        delete Wptm.style.cells[ij + \"!\" + ik][2].cell_background_color;\n                    }\n                }\n            }\n        }\n\n        window.Wptm = window.jquery.extend({}, Wptm);\n    },\n    /**\n     * add new alternate to saving function and Wptm.style.table\n     */\n    applyAlternate : function () { //save oldAlternate value to Wptm and save\n        window.Wptm.style.table.alternateColorValue = window.jquery.extend({}, window.table_function_data.oldAlternate);\n        window.Wptm.style.table.allAlternate = window.jquery.extend({}, window.table_function_data.allAlternate);\n\n        if(window.table_function_data.alternateIndex !== '') {\n            var i, k;\n            for (i = window.table_function_data.alternateSelection[0]; i <= window.table_function_data.alternateSelection[2]; i++) {\n                for (k = window.table_function_data.alternateSelection[1]; k <= window.table_function_data.alternateSelection[3]; k++) {\n                    if (typeof (window.Wptm.style.cells[i + \"!\" + k]) !== 'undefined') {\n                        window.Wptm.style.cells[i + \"!\" + k][2] = window.jquery.extend(window.Wptm.style.cells[i + \"!\" + k][2], {AlternateColor: window.table_function_data.alternateIndex});\n                    } else { //cell not have style\n                        window.Wptm.style.cells[i + \"!\" + k] = [i, k, {}];\n                        window.Wptm.style.cells[i + \"!\" + k][2] = {AlternateColor: window.table_function_data.alternateIndex};\n                    }\n                }\n            }\n\n            window.table_function_data.save_table_params.push({action: 'style', selection: [window.table_function_data.alternateSelection], style: {AlternateColor: window.table_function_data.alternateIndex}});\n        }\n        window.table_function_data.checkChangeAlternate = [];\n\n        tableFunction.saveChanges(true);\n        this.siblings('.colose_popup').trigger('click');\n    },\n    /**\n     * set the change options of altenate when selector cell/change rangeLabe\n     * @param Wptm\n     * @param $\n     */\n    affterRangeLabe : function (Wptm, $) {\n        try {\n            var rangeLabel = this.find('.cellRangeLabelAlternate').val();\n            rangeLabel = rangeLabel.replace(/[ ]+/g, \"\").toUpperCase();\n            var arrayRange = rangeLabel.split(\":\");\n            if (arrayRange.length > 1) {\n                var check_value = 0;\n                if (arrayRange[0].replace(/[ |A-Za-z]+/g, \"\") === '') {\n                    check_value = 1;//value A:B\n                } else if (arrayRange[0].replace(/[ |1-9]+/g, \"\") === '') {\n                    check_value = 2;//value 8:9\n                }\n                var selection = [];\n                if (check_value === 0) {\n                    selection.push(parseInt(arrayRange[0].split(/[ |A-Za-z]+/g)[1]) - 1);\n                    selection.push(tableFunction.convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1);\n                    selection.push(parseInt(arrayRange[1].split(/[ |A-Za-z]+/g)[1]) - 1);\n                    selection.push(tableFunction.convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1);\n                } else if (check_value === 1) {\n                    selection.push(0);\n                    selection.push(tableFunction.convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1);\n                    selection.push(Wptm.max_row - 1);\n                    selection.push(tableFunction.convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1);\n                } else {\n                    selection.push(parseInt(arrayRange[0].split(/[ |A-Za-z]+/g)[0]) - 1);\n                    selection.push(0);\n                    selection.push(parseInt(arrayRange[1].split(/[ |A-Za-z]+/g)[0]) - 1);\n                    selection.push(Wptm.max_Col - 1);\n                }\n\n                if (Wptm.type === 'mysql') {\n                    if (selection[2] + selection[0] === 0) {\n                        this.find('.wptm_range_labe_show').removeClass('wptm_hiden');\n                    } else {\n                        this.find('.wptm_range_labe_show').addClass('wptm_hiden');\n                    }\n                }\n                $(Wptm.container).handsontable(\"selectCell\", selection[0], selection[1], selection[2], selection[3]);\n\n                if (typeof this.find('.cellRangeLabelAlternate').data('text_change') !== 'undefined') {\n                    if (this.find('.cellRangeLabelAlternate').hasClass('select_row')) {\n                        if (selection[0] === selection[2]) {\n                            $(this.find('.cellRangeLabelAlternate').data('text_change')).text(wptmContext.rows_height);\n                        } else {\n                            $(this.find('.cellRangeLabelAlternate').data('text_change')).text(wptmContext.rows_height_start + (selection[0] + 1) + '-' + (selection[2] + 1));\n                        }\n                    } else if (this.find('.cellRangeLabelAlternate').hasClass('select_column')) {\n                        $(this.find('.cellRangeLabelAlternate').data('text_change')).text(wptmContext.columns_width_start\n                            + arrayRange[0].split(/[ |1-9]+/g)[0] + '-' + arrayRange[1].split(/[ |1-9]+/g)[0]);\n                    } else {\n                        $(this.find('.cellRangeLabelAlternate').data('text_change')).text(rangeLabel);\n                    }\n                }\n            }\n        } catch (err) {}\n    },\n    /**\n     * active alternating\n     *\n     * @param format\n     */\n    getActiveFormatColor: (format) => {\n        $alternating_color.find('.formatting_style .pane-color-tile').each(function () {\n            if (window.jquery(this).find('.pane-color-tile-1').data('value') === format.even) {\n                if (window.jquery(this).find('.pane-color-tile-2').data('value') === format.old) {\n                    var check = 0;\n                    if (format.header !== '') {\n                        check = format.header === window.jquery(this).find('.pane-color-tile-header').data('value') ? 1 : -1;\n                    } else {\n                        check = 1;\n                    }\n\n                    if (format.footer !== '') {\n                        check = format.footer === window.jquery(this).find('.pane-color-tile-footer').data('value') ? check : -1;\n                    }\n\n                    switch (check) {\n                        case 1:\n                            window.jquery(this).addClass('active');\n                            break;\n                        case -1:\n                            // No active\n                            break;\n                    }\n                }\n            }\n        });\n    },\n    /**\n     * handsontable render after set alternating\n     */\n    renderCell : () => { //render cells\n        window.jquery(window.Wptm.container).handsontable('render');\n    }\n}\n\nexport default alternating\n","import alternating from \"./_alternating\";\nimport tableFunction from \"./_functions\";\nimport selectOption from \"./_toolbarOptions\"\n\n//change default theme to table, get ajax\nfunction change_theme(ret, id, cellsData) {\n    var $ = window.jquery;\n    var $jform_css = $('#jform_css');\n    $('.full_image').remove();\n\n    tableFunction.wptmBootbox('', wptmText.WARNING_CHANGE_THEME, true, true,() => {\n        Wptm.container.handsontable(\"selectCell\", 0,0,0,0);\n\n        $.ajax({\n            url: wptm_ajaxurl + \"view=style&format=json&id=\" + id +\"&id-table=\" + Wptm.id,\n            type: 'POST',\n            dataType: 'json',\n            data: {}\n        }).done(function (data) {\n            $('#wptm_popup').find('.colose_popup').trigger('click');\n            if (typeof (data) === 'object') {\n                if (data.response) {\n                    location.reload();\n                }\n            } else {\n                alert(data, wptmText.Ok);\n            }\n        });\n    });\n}\n\nexport default change_theme\n","import tableFunction from \"./_functions\";\nimport alternating from \"./_alternating\";\nimport customRenderer from \"./_customRenderer\";\n\n/* Chart functions */\nvar DropChart = {};\nDropChart.default = {\n    \"dataUsing\": \"column\",\n    \"switchDataUsing\": true,\n    \"useFirstRowAsLabels\": true,\n    \"legend_display\": true,\n    \"useFirstRowAsGraph\": false,\n    \"width\": 500,\n    \"height\": 375,\n    \"chart_align\": \"center\",\n    \"scaleShowGridLines\": false,\n    \"scaleBeginAtZero\": false,\n};\nDropChart.default.colors = \"#4285f4,#ea4335,#fbbc04,#34a853,#46bdc6,#7baaf7,#f07b72\";\nDropChart.default.pieColors = \"#4285f4,#ea4335,#fbbc04,#34a853,#46bdc6,#7baaf7,#f07b72\";\nDropChart.datas = {};\n\nDropChart.currency_symbol = window.default_value.currency_symbol;\nDropChart.thousand_symbol = window.default_value.thousand_symbol;\nDropChart.decimal_symbol = window.default_value.decimal_symbol;\n\nDropChart.functions = {};\n\n//get list chart of table\nDropChart.functions.loadCharts = function () {\n    var $ = jquery;\n\n    if (typeof idTable !== 'undefined' && idTable !== '') {\n        var url = wptm_ajaxurl + \"view=charts&format=json&id_table=\" + idTable;\n        $.ajax({\n            url: url,\n            type: \"POST\",\n            data: {},\n            dataType: \"json\",\n        }).done(function (data) {\n            var i = 0;\n            //console.clear()\n\n            for (i = 0; i < data.length; i++) {\n                var cells = $.parseJSON(data[i].datas);\n                if ($.isArray(cells) !== false || cells.length !== 0) {\n                    var config;\n                    try {\n                        config = $.parseJSON(data[i].config);\n                    } catch (e) {\n                        config = $.extend({}, DropChart.default);\n                    }\n\n                    var dataCell = DropChart.functions.validateChartData(cells, (config.dataUsing || 'row'));\n                    if (dataCell !== false) {\n                        var [chartData, selections, chartDataRaw] = dataCell\n\n                        DropChart.datas[data[i].id] = {\n                            author: data[i].author,\n                            config: config,\n                            data: chartData,\n                            selections: selections,\n                            chartDataRaw: chartDataRaw,\n                            title: data[i].title,\n                            type: data[i].type,\n                        };\n                        $('#list_chart').append('<li class=\"chart-menu\" data-id=\"' + data[i].id + '\"><a>' + data[i].title + '</a></li>');\n                    }\n                }\n            }\n            wptm_chart();\n        });\n    }\n}\n\nfunction wptm_chart(first_load) {\n    var $ = jquery;\n    var $wptm_top_chart = $('#wptm_chart').find('.wptm_left_content .wptm_top_chart');\n\n\n    $('#list_chart').find('.chart-menu').unbind('click').on('click', function (e) {\n        var chart_name = '';\n        if (!$(this).data('id')) {\n            $(this).closest('.chart-menu').siblings('.chart-menu').removeClass('active');\n            var chart_id = $(this).closest('.chart-menu').data('id');\n            $(this).closest('.chart-menu').addClass('active');\n            chart_name = $(this).text();\n        } else {\n            $(this).siblings('.chart-menu').removeClass('active');\n            var chart_id = $(this).data('id');\n            $(this).addClass('active');\n            chart_name = $(this).find('a').text();\n        }\n        $wptm_top_chart.find('.wptm_name_edit').text(chart_name);\n\n        if ($('#inserttable').length > 0) {\n            Wptm.chart_active = chart_id;\n            if (!$('#inserttable').hasClass('not_change_type')) {\n                jquery('#inserttable').data('type', 'chart').attr('data-type', 'chart').text(insert_chart);\n            }\n            $('#inserttable').removeClass(\"no_click\");\n        }\n\n        if(first_load) {\n            DropChart.functions.render(chart_id, false, first_load);\n        } else {\n            DropChart.functions.render(chart_id);\n        }\n        return false;\n    });\n\n    if (typeof Wptm.chart_active !== 'undefined' && parseInt(Wptm.chart_active) > 0) {\n        if ($('.over_popup').length > 0) {\n            $('.over_popup').hide();\n        }\n        tableFunction.showChartOrTable(true, $('#list_chart').find('.chart-menu[data-id=\"' + Wptm.chart_active + '\"]'));\n    }\n\n    $wptm_top_chart.find('.edit').unbind('click').on('click', function (e) {\n        $wptm_top_chart.find('.wptm_name_edit').addClass('rename');\n        $wptm_top_chart.find('.wptm_name_edit').trigger('click');\n    });\n\n    $wptm_top_chart.find('.wptm_name_edit').click(function () {\n        if (!$(this).hasClass('editable')) {\n            tableFunction.setText.call(\n                $(this),\n                $wptm_top_chart.find('.wptm_name_edit'),\n                '#wptm_chart .wptm_name_edit',\n                {\n                    'url': wptm_ajaxurl + \"task=chart.setTitle&id=\" + DropChart.id_chart + '&title=',\n                    'selected': true,\n                    'chart_id': DropChart.id_chart,\n                    'action': function (obj) {\n                        if (arguments[0] != '') {\n                            $('#list_chart').find('.chart-menu.active a').text(arguments[0]);\n                        }\n                    }\n                }\n            );\n        }\n    });\n\n    $wptm_top_chart.find('.trash').unbind('click').on('click', function (e) {\n        var that = this;\n        var list_chart = $('#list_chart');\n        tableFunction.wptmBootbox(\n            '',\n            wptmText.JS_WANT_DELETE + \"\\\"\" + $(this).siblings('.wptm_name_edit').text().trim() + '\"?',\n            true,\n            true,\n            () => {\n                $.ajax({\n                    url: wptm_ajaxurl + \"task=chart.delete&id=\" + DropChart.id_chart,\n                    type: \"POST\",\n                    data: {},\n                    dataType: \"json\",\n                    success: function (datas) {\n                        if (datas.response === true) {\n                            list_chart.find('li.chart-menu[data-id=\"' + DropChart.id_chart + '\"]').remove();\n                            wptm_element.wptmContentChart.find('canvas.wptm_chart_' + DropChart.id_chart).remove();\n                            if (list_chart.find('li.chart-menu').length > 0) {\n                                list_chart.find('.chart-menu').eq(0).trigger('click');\n                            } else {\n                                list_chart.find('.current_table').trigger('click');\n                            }\n                        } else {\n                            alert(datas.response);\n                        }\n                    },\n                    error: function (jqxhr, textStatus, error) {\n                        alert(textStatus);\n                    }\n                });\n                return false;\n        });\n    });\n    wptm_element.chartTabContent.find('.copy_shortcode').unbind('click').on('click', function (e) {\n        wptm_element.chartTabContent.find('.controls[name=\"shortcode\"] input').select();\n        document.execCommand('copy');\n    });\n    Wptm.dataChart = $.extend([], DropChart.datas);\n}\n\nfunction updateOption(currentChart) {\n    var $ = jquery;\n    //get cell range label to input selected range and add range to handsontable\n\n    if (currentChart.selections?.length > 0) {\n        let cellRangeLabel = ''\n        for (let i = 0; i < currentChart.selections?.length; i++) {\n            let selection = currentChart.selections[i]\n            cellRangeLabel += cellRangeLabel !== '' ? ';' : ''\n            cellRangeLabel += Handsontable.helper.spreadsheetColumnLabel(parseInt(selection[1])) + (parseInt(selection[0]) + 1)\n            cellRangeLabel += ':' + Handsontable.helper.spreadsheetColumnLabel(parseInt(selection[3])) + (parseInt(selection[2]) + 1)\n        }\n        wptm_element.chartTabContent.find('.cellRangeLabelAlternate').val(cellRangeLabel);\n        // wptm_element.chartTabContent.find('.cellRangeLabelAlternate').parents('.controls').hide()\n    }\n\n    let $x_axis_line = wptm_element.chartTabContent.find('.controls[name=\"x_axis_line\"] select')\n    $x_axis_line.contents().remove()\n\n    if (typeof currentChart.type !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"type\"]').find('img').each(function () {\n            $(this).removeClass('active')\n            if ($(this).attr('alt') === currentChart.type) {\n                $(this).addClass('active')\n            }\n            wptm_element.chartTabContent.find('.y_axis_line').show()\n            if (currentChart.type !== 'Line' && currentChart.type !== 'Bar') {\n                wptm_element.chartTabContent.find('.y_axis_line').hide()\n            }\n        });\n\n        if (typeof currentChart.config.stepSize !== 'undefined') {\n            wptm_element.chartTabContent.find('.stepSize').val(currentChart.config.stepSize)\n        }\n        if (typeof currentChart.config.minY !== 'undefined') {\n            wptm_element.chartTabContent.find('.minY').val(currentChart.config.minY)\n        }\n\n        wptm_element.chartTabContent.find('#listLine').contents().remove()\n        let $dataset_select = wptm_element.chartTabContent.find('.controls[name=\"dataset_select\"] select')\n        let $dataset_color = wptm_element.chartTabContent.find('.controls[name=\"dataset_color\"] input.minicolors')\n        $dataset_select.contents().remove()\n\n        let $customLabel = wptm_element.chartTabContent.find('.customLabelXaxis')\n        $customLabel.find('input:not(.wptm_default)').remove()\n\n        if (currentChart.config?.linesdataAvailable?.length >= 1) {\n            let i2 = 0\n            let linesdataAvailable = currentChart.config?.linesdataAvailable\n\n            for (let i = 0; i < linesdataAvailable.length; i++) {\n                let line = linesdataAvailable[i]\n                let html = wptm_element.content_popup_hide.find('.chart_line').clone()\n\n                let line_name = currentChart.config?.dataUsing === 'row'\n                    ? ('row ' + (parseInt(line) + 1))\n                    : 'column ' + (Handsontable.helper.spreadsheetColumnLabel(parseInt(line)))\n\n                if (!currentChart.config?.linesData.includes(line)) {\n                    html.find('input').prop(\"checked\", false)\n                } else {\n                    html.find('input').prop(\"checked\", true)\n                }\n\n                html.find('input').addClass('line_' + line)\n                html.find('.lineSelectTion').html(line_name)\n\n                $('#listLine').append(html)\n\n                //append select color for lines\n                if (['Bar', 'Radar', 'Line'].includes(currentChart.type) && currentChart.config?.linesData.includes(line)) {\n                    $dataset_select.append('<option value=\"' + i2 + '\">' + currentChart.config?.graphLabel[i2] + '</option>');\n                    i2++\n                }\n\n                $x_axis_line.append('<option value=\"' + linesdataAvailable[i] + '\">' + line_name + '</option>');\n                $x_axis_line.trigger('liszt:updated');\n            }\n\n            //\n            if (currentChart.type == 'Line' || currentChart.type == 'Bar' || currentChart.type == 'Radar') {\n                $dataset_color.wpColorPicker('color', currentChart.config?.colors.split(\",\")[0]);\n            } else {\n                $dataset_color.wpColorPicker('color', currentChart.config?.pieColors.split(\",\")[0]);\n            }\n\n            for (let i = 0; i < currentChart.config?.customText.length; i++) {\n                let text = currentChart.config?.customText[i]\n\n                if (['PolarArea', 'Pie', 'Doughnut'].includes(currentChart.type)) {\n                    $dataset_select.append('<option value=\"' + i + '\">' + text + '</option>');\n                }\n                //customLabelInput customText\n                let $customLabelInput = $customLabel.find('input.wptm_default').clone()\n                $customLabelInput.attr('placeholder', text).val(text).removeClass('wptm_default').addClass('customLabelInput').data('value', text)\n                $customLabel.append($customLabelInput)\n            }\n        }\n\n        $dataset_select.trigger('liszt:updated');\n    }\n\n    if (typeof currentChart.config?.axisColumn !== 'undefined') {\n        $x_axis_line.val(parseInt(currentChart.config?.axisColumn)).change()\n    }\n\n    if (typeof DropChart.id_chart !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"shortcode\"] input').val('[wptm id-chart=' + DropChart.id_chart + ']');\n    }\n    if (typeof currentChart.config?.dataUsing !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"dataUsing\"] select').val(currentChart.config?.dataUsing).change();\n    }\n    if (typeof currentChart.config?.useFirstRowAsLabels !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"useFirstRowAsLabels\"] input')\n            .val(currentChart.config?.useFirstRowAsLabels === true ? 'yes' : 'no').prop(\"checked\", currentChart.config?.useFirstRowAsLabels);\n    }\n\n    let $customLegendText = wptm_element.chartTabContent.find('.customLegendText')\n    $customLegendText.find('input:not(.wptm_default)').remove()\n\n    if (typeof currentChart.config?.customLegend !== 'undefined') {\n        let $default_input = $customLegendText.find('input.wptm_default')\n        for (let i = 0; i < currentChart.config?.customLegend.length; i++) {\n            let $html = $default_input.clone()\n            let text = currentChart.config?.customLegend[i]\n            let textDefault = currentChart.config?.customLegendDefault[i]\n            $html.attr('placeholder', textDefault).val(text).removeClass('wptm_default').addClass('customLegend').data('value', text)\n            $customLegendText.append($html)\n        }\n    }\n\n    if (typeof currentChart.config?.legend_display !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"legend_display\"] input')\n            .val(currentChart.config?.legend_display === true ? 'yes' : 'no').prop(\"checked\", currentChart.config?.legend_display);\n\n        currentChart.config?.legend_display === true ? $customLegendText.show() : $customLegendText.hide()\n    } else {\n        wptm_element.chartTabContent.find('.controls[name=\"legend_display\"] input').val('yes').prop(\"checked\", true);\n\n        $customLegendText.show()\n    }\n\n\n    if (typeof currentChart.config?.useFirstRowAsGraph !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"useFirstRowAsGraph\"] input')\n            .val(currentChart.config?.useFirstRowAsGraph === true ? 'yes' : 'no').prop(\"checked\", currentChart.config?.useFirstRowAsGraph);\n\n        // if (!currentChart.config?.useFirstRowAsGraph) {\n        //     $('#wptm_chart').find('.customLabelInput:eq(0)').hide()\n        // }\n    }\n    if (typeof currentChart.config?.width !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"width\"] input').val(currentChart.config?.width).change();\n    }\n    if (typeof currentChart.config?.height !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"height\"] input').val(currentChart.config?.height).change();\n    }\n    if (typeof currentChart.config?.chart_align !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"chart_align\"] select').val(currentChart.config?.chart_align).change();\n        wptm_element.wptmContentChart.css('text-align', currentChart.config?.chart_align);\n    }\n}\n\n//action option changing\nfunction initChartObserver() {\n    if (!(Wptm.can.edit || (Wptm.can.editown && data.author === Wptm.author))) {\n        return false;\n    }\n    var $ = jquery;\n    let listLine = false;\n    var currentChart = DropChart.datas[DropChart.id_chart];\n\n    $('#wptm_chart #listLine').find('input').unbind('change').bind('change', function (e) {\n        e.preventDefault()\n\n        if (DropChart.optionsChanged !== true) {\n            return;\n        }\n\n        let linesdataAvailable = currentChart.config?.linesdataAvailable\n        currentChart.config.linesData = []\n        let linesData = []\n\n        for (let i =0; i < linesdataAvailable.length; i++) {\n            if ($('#wptm_chart #listLine').find('input.line_' + linesdataAvailable[i]).is(\":checked\")) {\n                linesData.push(linesdataAvailable[i])\n            }\n        }\n\n        if (linesData.length < 1) {\n            $(e.target).prop(\"checked\", true)\n            return false;\n        }\n        currentChart.config.linesData = $.extend([], [], linesData)\n        delete DropChart.datas[DropChart.id_chart].config.customLegend\n\n        clearTimeout(listLine);\n        listLine = setTimeout(function () {\n            DropChart.functions.render(DropChart.id_chart, false, true, 'listLine');\n        }, 100);\n    })\n\n    $('#wptm_chart .option_chart').unbind('change').bind('change', function (e) {\n        if (DropChart.optionsChanged !== true) {\n            return false;\n        }\n        // e.preventDefault()\n\n        switch ($(this).parents('.controls').attr('name')) {\n            case 'Shortcode':\n                break;\n            case 'x_axis_line':\n                let column = parseInt($(this).val())\n                currentChart.config.axisColumn = '' + column\n                delete DropChart.datas[DropChart.id_chart].config.customText\n\n                clearTimeout(listLine);\n                listLine = setTimeout(function () {\n                    DropChart.functions.render(DropChart.id_chart, false, true, 'x_axis_line');\n                }, 100);\n                break;\n            case 'dataUsing':\n                let dataUsing = $(this).val()\n                let dataCell = DropChart.functions.validateChartData(currentChart.selections, (dataUsing || 'row'))\n                if (dataCell !== false) {\n                    var [chartData, selections, chartDataRaw] = dataCell\n                    let newConfig = $.extend({}, DropChart.default, {\n                        chart_align: DropChart.datas[DropChart.id_chart].config.chart_align,\n                        height: DropChart.datas[DropChart.id_chart].config.height,\n                        width: DropChart.datas[DropChart.id_chart].config.width\n                    })\n                    DropChart.datas[DropChart.id_chart] = {\n                        config: newConfig,\n                        data: chartData,\n                        selections: selections,\n                        chartDataRaw: chartDataRaw,\n                        title: currentChart.title,\n                        type: currentChart.type,\n                    };\n                    DropChart.datas[DropChart.id_chart].config.dataUsing = dataUsing\n                    delete DropChart.datas[DropChart.id_chart].config.linesdataAvailable\n                    delete DropChart.datas[DropChart.id_chart].config.axisColumn\n                    delete DropChart.datas[DropChart.id_chart].config.linesData\n                    delete DropChart.datas[DropChart.id_chart].config.customLegend\n\n                    setTimeout(function () {\n                        DropChart.functions.render(DropChart.id_chart, false, true, 'dataUsing');\n                    }, 500);\n                }\n                break;\n            case 'useFirstRowAsLabels':\n                if ($(this).is(\":checked\")) {\n                    currentChart.config.useFirstRowAsLabels = true;\n                } else {\n                    currentChart.config.useFirstRowAsLabels = false;\n                }\n                DropChart.functions.render(DropChart.id_chart, false, true, 'firstRowAsLabels');\n                break;\n            case 'legend_display':\n                if ($(this).is(\":checked\")) {\n                    currentChart.config.legend_display = true;\n                } else {\n                    currentChart.config.legend_display = false;\n                }\n                DropChart.functions.render(DropChart.id_chart, false, true, 'legend_display');\n                break;\n            case 'useFirstRowAsGraph':\n                if ($(this).is(\":checked\")) {\n                    currentChart.config.useFirstRowAsGraph = true;\n                    let axisColumn = currentChart.config?.axisColumn || null\n                    let text = ''\n                    if (axisColumn !== null && typeof currentChart.data[axisColumn] !== 'undefined') {\n                        text = currentChart.data[axisColumn][0] || ''\n                    }\n                    currentChart.config.customText.unshift(text)\n                } else {\n                    currentChart.config.useFirstRowAsGraph = false;\n                    currentChart.config.customText.shift()\n                }\n                DropChart.functions.render(DropChart.id_chart, false, true, 'firstRowAsGraph');\n                break;\n            case 'width':\n                currentChart.config.width = parseInt($(this).val());\n                DropChart.functions.render(DropChart.id_chart, true, true, 'width');\n                break;\n            case 'height':\n                currentChart.config.height = parseInt($(this).val());\n                DropChart.functions.render(DropChart.id_chart, true, true, 'height');\n                break;\n            case 'chart_align':\n                currentChart.config.chart_align = $(this).val();\n                if (currentChart.config.chart_align !== 'none') {\n                    wptm_element.wptmContentChart.css('text-align', currentChart.config.chart_align);\n                } else {\n                    wptm_element.wptmContentChart.css('text-align', 'left');\n                }\n\n                DropChart.functions.save();\n                break;\n            case 'dataset_select':\n                let line_name = parseInt($(this).val());\n                var $dataset_color = wptm_element.chartTabContent.find('.controls[name=\"dataset_color\"] input.minicolors');\n                currentChart.change_dataset_select = true;\n                if (currentChart.type == \"Line\" || currentChart.type == \"Bar\" || currentChart.type == \"Radar\") {\n                    let colors = currentChart.config.colors.split(\",\")\n                    let numberColor = line_name % colors.length\n                    $dataset_color.wpColorPicker('color', colors[numberColor]);\n                    // if (currentChart.config.colors.split(\",\").length > line_name) {\n                    //     $dataset_color.wpColorPicker('color', currentChart.config.colors.split(\",\")[line_name]);\n                    // } else {\n                    //     $dataset_color.wpColorPicker('color', \"\");\n                    // }\n                } else {\n                    let colors = currentChart.config.pieColors.split(\",\")\n                    let numberColor = line_name % colors.length\n                    $dataset_color.wpColorPicker('color', colors[numberColor]);\n                    // if (currentChart.config.pieColors.split(\",\").length > line_name) {\n                    //     $dataset_color.wpColorPicker('color', currentChart.config.pieColors.split(\",\")[line_name]);\n                    // } else {\n                    //     $dataset_color.wpColorPicker('color', \"\");\n                    // }\n                }\n                break;\n            case 'dataset_color':\n                let index = parseInt(wptm_element.chartTabContent.find('.controls[name=\"dataset_select\"] select').val());\n                if (currentChart.type == \"Line\" || currentChart.type == \"Bar\" || currentChart.type == \"Radar\") {\n                    var colors = currentChart.config.colors.split(\",\");\n                    colors[index] = $(this).val();\n                    currentChart.config.colors = colors.join(\",\");\n                } else {\n                    var pieColors = currentChart.config.pieColors.split(\",\");\n                    if (pieColors.length <= index) {\n                        var maxLabels = DropChart.labels.length;\n                        var maxPieColors = pieColors.length;\n                        var i;\n                        for (i = 0; i < maxLabels; i++) {\n                            pieColors[i] = pieColors[i % maxPieColors];\n                        }\n                    }\n                    pieColors[index] = $(this).val();\n                    currentChart.config.pieColors = pieColors.join(\",\");\n                }\n\n                if (currentChart.change_dataset_select === true) {\n                    currentChart.change_dataset_select = false;\n                } else {\n                    DropChart.functions.render(DropChart.id_chart, true, true, 'color');\n                }\n                break;\n            default:\n                break;\n        }\n        return false\n    });\n\n    $('#wptm_chart .chart_type').unbind('click').bind('click', function (e) {\n        e.preventDefault()\n\n        if (DropChart.optionsChanged !== true) {\n            return;\n        }\n        changeStyleChart($(this).data('id'));\n        return false\n    });\n\n    $('#wptm_chart .change_ranger').unbind('click').bind('click', function (e) {\n        if (DropChart.optionsChanged !== true) {\n            return;\n        }\n        e.preventDefault()\n\n        let valueRange = wptm_element.chartTabContent.find('.cellRangeLabelAlternate').val()\n        wptm_element.chartTabContent.find('.cellRangeLabelAlternate').removeClass('wptm_error')\n        valueRange = valueRange.replace(/[ ]+/g, \"\").toUpperCase();\n        let arrayRanges = valueRange.split(\";\");\n        let selections = [];\n\n        if (arrayRanges.length > 0) {\n            try{\n                for (let i = 0; i < arrayRanges.length; i++) {\n                    let arrayRange = arrayRanges[i].split(\":\")\n                    if (arrayRange[0].replace(/[ |A-Za-z]+/g, \"\") === '') {//value A:B\n                        selections.push([\n                            0,\n                            tableFunction.convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1,\n                            Wptm.max_row - 1,\n                            tableFunction.convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1\n                        ]);\n                    } else if (arrayRange[0].replace(/[ |1-9]+/g, \"\") === '') {//value 8:9\n                        selections.push([arrayRange[0] - 1, 0, arrayRange[1] - 1, Wptm.max_Col - 1]);\n                    } else {\n                        let selection = []\n                        selection.push(parseInt(arrayRange[0].split(/[ |A-Za-z]+/g)[1]) - 1);\n                        selection.push(tableFunction.convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1);\n                        selection.push(parseInt(arrayRange[1].split(/[ |A-Za-z]+/g)[1]) - 1);\n                        selection.push(tableFunction.convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1);\n                        selections.push(selection);\n                    }\n                }\n            } catch (e) {\n                wptm_element.chartTabContent.find('.cellRangeLabelAlternate').addClass('wptm_error')\n            }\n\n        }\n\n        if (selections.length > 0) {\n            DropChart.datas[DropChart.id_chart].selections = $.extend([], [], selections)\n            changerRangeChart();\n        }\n        return false\n    });\n\n    $('#wptm_chart .customLabelXaxis').find('input').unbind('change').bind('change', function(event) {//CTRL + S\n        // if (event.keyCode === 13 || event.key === \"Enter\") {\n            let customText = []\n            $('#wptm_chart .customLabelXaxis').find('input:not(.wptm_default)').each(function (i, v) {\n                customText.push($(v).val())\n            })\n            DropChart.datas[DropChart.id_chart].config.customText = customText\n\n            DropChart.functions.render(DropChart.id_chart, true, true, 'customLabel')\n        // }\n    })\n\n    wptm_element.chartTabContent.find('.customLegendText').find('input.customLegend').unbind('change').bind('change', function(event) {//CTRL + S\n        // if (event.keyCode === 13 || event.key === \"Enter\") {\n            let customText = []\n        wptm_element.chartTabContent.find('.customLegendText').find('input.customLegend').each(function (i, v) {\n            customText.push($(v).val())\n        })\n        DropChart.datas[DropChart.id_chart].config.customLegend = customText\n\n        DropChart.functions.render(DropChart.id_chart, true, true, 'customLegend')\n        // }\n    })\n\n    $('#wptm_chart .y_axis_line').find('input').unbind('keydown').bind('keydown', function(event) {//CTRL + S\n        clearTimeout(listLine)\n        let that = $(event.target)\n        listLine = setTimeout(function () {\n            if (that.hasClass('stepSize'))\n                DropChart.datas[DropChart.id_chart].config.stepSize = that.val() || null\n\n            if (that.hasClass('minY'))\n                DropChart.datas[DropChart.id_chart].config.minY = that.val() || null\n\n            DropChart.functions.render(DropChart.id_chart, true, true, 'y_axis_line')\n        }, 500);\n    })\n\n    setTimeout(function () {\n        DropChart.optionsChanged = true;\n    }, 100)\n}\n\nfunction changeStyleChart(charttype_id) {\n    var $ = jquery;\n    var id_chart = DropChart.id_chart;\n    $.ajax({\n        url: wptm_ajaxurl + \"view=charttype&format=json&id=\" + charttype_id,\n        type: 'POST',\n        data: {}\n    }).done(function (data) {\n        if (typeof (data) === 'object') {\n            //local save\n            if (data.config !== '') {\n                $.extend(DropChart.datas[id_chart].config, $.parseJSON(data.config));\n            }\n            DropChart.datas[id_chart].type = data.name;\n\n            setTimeout(function () {\n                DropChart.functions.render(id_chart, false, true, 'changeStyleCHart');\n            }, 200)\n        }\n    });\n}\n\nfunction changerRangeChart() {\n    var $ = jquery;\n    var id_chart = DropChart.id_chart;\n    var dataChart = DropChart.datas[id_chart];\n\n    var dataCell = DropChart.functions.validateChartData(dataChart?.selections || null, dataChart?.config?.dataUsing);\n    if (dataCell === false) {\n        tableFunction.wptmBootbox('', wptmText.CHART_INVALID_DATA, true, false);\n    } else {\n        dataChart.data = dataCell[0];\n        dataChart.selections = dataCell[1];\n        dataChart.chartDataRaw = dataCell[2];\n        delete dataChart.config.axisColumn\n        delete dataChart.config.linesData\n        delete dataChart.config.axisColumn\n        delete dataChart.config.customLegend\n\n        DropChart.changer = true;\n        DropChart.functions.render(id_chart, false, true, 'rangeChart');\n    }\n}\n\n//dataSets = [dataCreateChart, dataForTooltip, graphLabel, xAxisLabels]\nfunction convertForPie(dataSets, customText, useFirstRowAsLabels, useFirstRowAsGraph, colors, dataUsing, ctx) {\n    var result = {};\n    let colorList = [];\n    result.datasets = [];\n\n    let numberLine = dataSets[2].length, countDatasets = dataSets[3].length, dataSet, pieColors;\n\n    let i2 = 0\n    // if (customText !== null && 0 < customText.length && customText.length < countDatasets) {\n    //     customText.unshift(dataSets[3][0])\n    // }\n    jQuery.each(dataSets[0], function (i, dataCell) {\n    // for (let i = 0; i < numberLine; i++) {\n        dataSet = jquery.extend({}, {})\n        dataSet.label = dataSets[2][i2]\n\n        if (dataSets[0][i] === 0) {\n            dataSet.dataForTooltip = []\n        } else {\n            dataSet.dataForTooltip = dataSets[1][i]\n        }\n        // dataSet.currency_symbol = dataSets.currency_symbol[i];\n        // if (typeof dataSets.data2 !== 'undefined' && typeof dataSets.data2[i] !== 'undefined') {\n        //     dataSet.data_format = dataSets.data2[i];\n        // } else {\n        //     dataSet.data_format = dataSets.data[i];\n        // }\n        result.labels = jquery.extend([], []);\n        pieColors = jquery.extend({}, {});\n\n        if (dataUsing === 'PolarArea' || dataUsing === 'Pie' || dataUsing === 'Doughnut') {\n            dataSet.highlight = [];\n            dataSet.backgroundColor = [];\n            dataSet.borderColor = [];\n            dataSet.pointBackgroundColor = [];\n            dataSet.pointColor = [];\n            dataSet.pointBorderColor = [];\n            dataSet.pointHighlightFill = [];\n        }\n\n        for (let j = 0; j < countDatasets; j++) {\n            if (typeof dataSet.data === 'undefined') {\n                dataSet.data = [];\n            }\n            if (dataSets[0][i] === 0) {\n                dataSet.data.push(0)\n                dataSet.dataForTooltip.push(0)\n            } else {\n                dataSet.data.push(dataSets[0][i][j]);//data da duoc remove tu truoc\n            }\n\n            var text = ''\n\n            if (useFirstRowAsLabels) {\n                text = dataSets[3][j]\n\n                // console.log(customText, useFirstRowAsGraph, useFirstRowAsGraph ? j : (j + 1))\n                if (customText !== null && typeof customText[j] !== 'undefined') {\n                    text = customText[j]\n                }\n            }\n            result.labels.push(text)\n\n            if (dataUsing === 'PolarArea' || dataUsing === 'Pie' || dataUsing === 'Doughnut') {\n                if (dataUsing === 'PolarArea') {\n                    [pieColors, colorList[j]] = getStyleSet(j, colors, 0.5);\n                } else {\n                    [pieColors, colorList[j]] = getStyleSet(j, colors);\n                }\n\n                dataSet.highlight.push(pieColors.highlight);\n                dataSet.backgroundColor.push(pieColors.backgroundColor);\n                dataSet.borderColor.push(pieColors.borderColor);\n                dataSet.pointBackgroundColor.push(pieColors.pointBackgroundColor);\n                dataSet.pointColor.push(pieColors.pointColor);\n                dataSet.pointBorderColor.push(pieColors.pointBorderColor);\n                dataSet.pointHighlightFill.push(pieColors.pointHighlightFill);\n            }\n        }\n        if (dataUsing === 'Bar' || dataUsing === 'Radar' || dataUsing === 'Line') {\n            if (dataUsing === 'Radar' || dataUsing === 'Line') {\n                [pieColors, colorList[i2]] = getStyleSet(i2, colors, 0.5);\n            } else {\n                [pieColors, colorList[i2]] = getStyleSet(i2, colors);\n            }\n            dataSet = jquery.extend({}, dataSet, pieColors);\n            dataSet.fill = true;\n\n            //color by line value\n            // const skipped = (ctx, value) => ctx.p0.skip || ctx.p1.skip ? value : undefined;\n            // const down = (ctx, value) => ctx.p0.parsed.y > ctx.p1.parsed.y ? value : undefined;\n            // dataSet.segment = {\n            //     borderColor: ctx => skipped(ctx, 'rgb(0,0,0,0.2)') || down(ctx, 'rgb(192,75,75)'),\n            //     borderDash: ctx => skipped(ctx, [6, 6]),\n            // }\n        }\n        result.datasets[i2] = dataSet;\n        result.datasets[i2].lineNumber = i\n        i2++\n    })\n\n    return [result, colorList.join(\",\")];\n}\n\nfunction getStyleSet(i, colors, opacity = null) {\n    var styleSet = {};\n\n    var color = getColor(i, colors) || '#935a5a';\n    if (color != \"\") {\n        // styleSet.lineTension = 0.2;\n        styleSet.highlight = DropChart.helper.ColorLuminance(color, 100);\n        styleSet.backgroundColor = DropChart.helper.convertHex(color, 90);\n        styleSet.borderColor = DropChart.helper.convertHex(color, 100);\n        styleSet.pointBackgroundColor = DropChart.helper.convertHex(color, 100);\n        if (opacity !== null) {\n            styleSet.highlight = DropChart.helper.ColorLuminance(color, 100 * opacity);\n            styleSet.backgroundColor = DropChart.helper.convertHex(color, 90 * opacity);\n            styleSet.borderColor = DropChart.helper.convertHex(color, 100 * opacity);\n            styleSet.pointBackgroundColor = DropChart.helper.convertHex(color, 100 * opacity);\n        }\n        styleSet.pointColor = \"#fff\";\n        styleSet.pointHighlightFill = \"#fff\";\n        styleSet.pointBorderColor = DropChart.helper.convertHex(color, 100);\n    }\n\n    return [styleSet, color];\n}\n\nfunction getColor(i, colors) {\n    var result = \"\";\n    var arrColors = colors.split(\",\");\n    var len = arrColors.length;\n    if (len > 0) {\n        result = arrColors[i % len];\n        if (!result) {\n            arrColors = DropChart.default.colors.split(\",\")\n\n            result = arrColors[i % arrColors.length];\n        }\n    }\n\n    return result;\n}\n\nfunction addChartStyles(dataSets, colors) {\n    var result = [];\n    var dataset, styleSet;\n\n    for (var i = 0; i < dataSets.length; i++) {\n        dataset = dataSets[i];\n        styleSet = getStyleSet(i, colors);\n        jquery.extend(dataset, styleSet);\n        result.push(dataset);\n    }\n\n    return result;\n}\n\nvar wptmCreateNewChart = false\n\nDropChart.functions.addChart = function () {\n    if ((typeof idTable !== 'undefined' && idTable !== '') || table_function_data.selectionSize >= 1) {\n        var $ = jquery;\n\n        let dataCell = DropChart.functions.validateChartData(null, 'column');\n\n        if (dataCell === false) {\n            tableFunction.wptmBootbox('', wptmText.CHART_INVALID_DATA, true, false);\n        } else {\n            let [chartData, selections, chartDataRaw] = dataCell\n            let list_columns = Object.keys(chartData)\n            let config = {linesData: list_columns, useFirstRowAsGraph: true, axisColumn: list_columns[0]}\n            let [dataCreateChart, dataForTooltip, countDataValidate, graphLabel, xAxisLabels] = DropChart.functions.getDataSets2(chartData, config, selections, chartDataRaw);\n            if (countDataValidate < 1) {//data not validate\n                tableFunction.wptmBootbox('', wptmText.CHART_INVALID_DATA, true, false);\n            } else {\n                $.ajax({\n                    url: wptm_ajaxurl + \"task=chart.add&id_table=\" + idTable,\n                    type: \"POST\",\n                    dataType: \"json\",\n                    data: {datas: JSON.stringify(selections)},\n                    beforeSend: function () {\n                        wptm_element.settingTable.find('.ajax_loading').addClass('loadding').removeClass('wptm_hiden');\n                        wptm_element.primary_toolbars.find('.new_chart_menu').closest('li').addClass('menu_loading');\n                    },\n                    success: function (datas) {\n                        wptm_element.settingTable.find('.ajax_loading').removeClass('loadding').addClass('wptm_hiden');\n                        if (datas.response === true) {\n                            var count = $('#list_chart').find('li.chart-menu').length;\n                            var data_chart = datas.datas;\n                            $('#list_chart').append('<li class=\"chart-menu\" data-id=\"' + data_chart.id + '\"><a>' + data_chart.title + '</a></li>');\n                            DropChart.datas[data_chart.id] = {\n                                config: $.extend({}, {}, DropChart.default),\n                                data: chartData,\n                                selections: selections,\n                                chartDataRaw: chartDataRaw,\n                                title: data_chart.title,\n                                type: \"Bar\",\n                            };\n                            wptmCreateNewChart = true\n                            wptm_chart(true);\n                            tableFunction.showChartOrTable(true, $('#list_chart').find('.chart-menu').eq(count));\n                        } else {\n                            alert(datas.response);\n                        }\n                    },\n                    error: function (jqxhr, textStatus, error) {\n                        wptm_element.settingTable.find('.ajax_loading').removeClass('loadding').addClass('wptm_hiden');\n                        tableFunction.wptmBootbox('', textStatus + \" : \" + error, true, false);\n                    }\n                });\n            }\n        }\n    } else {\n        tableFunction.wptmBootbox('', wptmText.CHART_INVALID_DATA, wptmText.GOT_IT, false);\n    }\n}\n\nDropChart.functions.render = function (chart_id, re_render, save_chart, action) {\n    var $ = jquery;\n    DropChart.id_chart = chart_id;\n\n    if (typeof DropChart.datas[chart_id] === 'undefined') {//data not validate\n        $('<span class=\"\">' + wptmText.warning_creat_chart + '<span>').appendTo(wptm_element.wptmContentChart);\n        return false\n    }\n    let currentChart = DropChart.datas[chart_id];\n\n    wptm_element.wptmContentChart.find(':not(.wptm_chart_' + chart_id + ')').remove()\n    let $canvas = wptm_element.wptmContentChart.find('canvas.wptm_chart_' + chart_id);\n\n    if (currentChart.config === null) {\n        currentChart.config = $.extend({}, DropChart.default);\n    }\n\n    let list_columns = Object.keys(currentChart.data)\n    currentChart.config.linesdataAvailable = Object.keys(currentChart.data)\n\n    if (typeof currentChart.config.axisColumn === 'undefined'\n        || typeof currentChart.data[currentChart.config.axisColumn] === 'undefined') {\n        currentChart.config.axisColumn = list_columns[0]\n    }\n\n    if (typeof currentChart.config.linesData === 'undefined'\n        || currentChart.config.linesData.length > currentChart.config.linesdataAvailable.length) {\n        currentChart.config.linesData = $.extend([], [], list_columns);\n        if (!currentChart.config?.useFirstRowAsGraph) {//old chart\n            currentChart.config.linesData.shift()\n        }\n    }\n\n    try {\n        currentChart.config = $.extend({}, DropChart.default, currentChart.config);\n    } catch (e) {\n        currentChart.config = $.extend({}, DropChart.default, $.parseJSON(currentChart.config));\n    }\n\n    let [dataCreateChart, dataForTooltip, countDataValidate, graphLabel, xAxisLabels] = DropChart.functions.getDataSets2(currentChart.data, currentChart.config, currentChart.selections, currentChart.chartDataRaw);\n\n    let createNewChart = wptmCreateNewChart\n    wptmCreateNewChart = false\n    if (countDataValidate < 1) {//data not validate\n        if ($canvas.length < 1) {\n            $('<span class=\"\">' + wptmText.warning_creat_chart + '<span>').appendTo(wptm_element.wptmContentChart);\n        }\n    }\n\n    if (countDataValidate < 1 && currentChart.config.linesdataAvailable?.length >= 1 && countDataValidate < currentChart.config.linesdataAvailable?.length) {\n        // let linesData = []\n        currentChart.config.linesData = $.extend([], [], currentChart.config.linesdataAvailable);\n        currentChart.config.useFirstRowAsGraph = true;\n\n        // for (let i = 0; i < currentChart.config.linesData?.length; i++) {\n        //     if (dataCreateChart[currentChart.config.linesData[i]] !== 0)\n        //         linesData.push(currentChart.config.linesData[i])\n        // }\n        // currentChart.config.linesData = $.extend([], [], linesData);\n\n        let dataGetDataSets2 = DropChart.functions.getDataSets2(currentChart.data, currentChart.config, currentChart.selections, currentChart.chartDataRaw);\n\n        [dataCreateChart, dataForTooltip, countDataValidate, graphLabel, xAxisLabels] = dataGetDataSets2\n    }\n\n\n    if (countDataValidate < 1) {//data not validate\n        return false\n    }\n\n    if (graphLabel !== null && graphLabel.length > 0) {\n        currentChart.config.customLegendDefault = $.extend([], [], graphLabel)\n        if (typeof currentChart.config.customLegend !== 'undefined') {\n            graphLabel = $.extend([], graphLabel, currentChart.config.customLegend);\n        }\n        currentChart.config.customLegend = $.extend([], [], graphLabel)\n\n        //save line name\n        currentChart.config.graphLabel = graphLabel\n    }\n\n    wptm_element.wptmContentChart.find('span').remove()\n\n    //destroy old chart version\n    if (DropChart.chart) {\n        DropChart.chart.clear();\n        DropChart.chart.destroy();\n    }\n\n    //hiden all canvas except chart_id\n    wptm_element.wptmContentChart.find('.canvas').addClass('wptm_hiden');\n    // if ($canvas.length > 1)\n    //     $canvas.remove();\n    if ($canvas.length < 1 || re_render) {\n        $canvas.remove();\n        $canvas = $('<canvas class=\"canvas wptm_chart_' + chart_id + '\" width=\"' + currentChart.config.width + '\" height=\"' + currentChart.config.height + '\"   ><canvas>')\n            .appendTo(wptm_element.wptmContentChart);\n    } else {\n        $canvas.width(currentChart.config.width);\n        $canvas.height(currentChart.config.height);\n    }\n    $canvas.removeClass('wptm_hiden');\n    var ctx = $canvas.get(0).getContext(\"2d\");\n\n    \n\n    let chartData, colorList;\n    switch (currentChart.type) {\n        case 'PolarArea':\n        case 'Pie':\n        case 'Doughnut':\n            [chartData, colorList] = convertForPie([dataCreateChart, dataForTooltip, graphLabel, xAxisLabels], currentChart.config.customText || null, currentChart.config.useFirstRowAsLabels, currentChart.config.useFirstRowAsGraph, currentChart.config.pieColors, currentChart.type, ctx);\n            currentChart.config.pieColors = colorList\n            break;\n        case 'Bar':\n        case 'Radar':\n        case 'Line':\n        default:\n            [chartData, colorList] = convertForPie([dataCreateChart, dataForTooltip, graphLabel, xAxisLabels], currentChart.config.customText || null, currentChart.config.useFirstRowAsLabels,  currentChart.config.useFirstRowAsGraph, currentChart.config.colors, currentChart.type, ctx);\n            currentChart.config.colors = colorList\n            break;\n    }\n\n    if (typeof chartData.labels !== 'undefined' && currentChart.config.useFirstRowAsLabels) {\n        currentChart.config.customText = $.extend([], [], chartData.labels)\n    }\n\n    DropChart.labels = chartData.labels;\n    DropChart.datasets = chartData.datasets;\n    if (DropChart.datasets.length > 0) {\n        currentChart.config.plugins = {};\n        currentChart.config.plugins.tooltip = {\n        // DropChart.config.tooltips = {\n            enabled: true, callbacks: {\n                label: function (tooltipItems) {\n                    var labelTitle = '';\n                    var label = '';\n                    var data = tooltipItems.chart.config._config.data;\n                    var type = tooltipItems.chart.config._config.type;\n                    var useFirstRowAsGraph = tooltipItems.chart.config._config?.options?.useFirstRowAsGraph || false;\n\n                    if (data.useFirstRowAsLabels) {\n                        switch (type) {\n                            case 'polarArea':\n                                labelTitle += data.labels[tooltipItems.dataIndex];\n                                if (!useFirstRowAsGraph) {\n                                    label += data.datasets[tooltipItems.datasetIndex].label\n                                }\n                                if (label) {\n                                    label += ': ';\n                                }\n                                break;\n                            case 'pie':\n                            case 'doughnut':\n                                if (tooltipItems.label !== '') {\n                                    labelTitle += tooltipItems.label;\n                                } else {\n                                    labelTitle += data.labels[tooltipItems.dataIndex];\n                                }\n                                if (!useFirstRowAsGraph) {\n                                    label += data.datasets[tooltipItems.datasetIndex].label\n                                }\n                                if (label) {\n                                    label += ': ';\n                                }\n                                break;\n                            case 'bar':\n                            case 'radar':\n                            case 'line':\n                            default:\n                                if (!useFirstRowAsGraph) {\n                                    if (data.datasets.length > 1) {\n                                        label = data.datasets[tooltipItems.datasetIndex].label || '';\n                                    }\n                                    if (label) {\n                                        label += ': ';\n                                    }\n                                }\n                            break;\n                        }\n                    }\n                    if (tooltipItems.raw !== 0) {\n                        if (typeof tooltipItems.dataset.dataForTooltip !== 'undefined' && typeof tooltipItems.dataset.dataForTooltip[tooltipItems.dataIndex] !== 'undefined') {\n                            label += tooltipItems.dataset.dataForTooltip[tooltipItems.dataIndex];\n                        } else {\n                            label += tooltipItems.dataset.data[tooltipItems.dataIndex];\n                        }\n                    } else {\n                        label += '0'\n                    }\n                    return labelTitle !== '' ? [labelTitle, label] : label;\n                }\n            }\n        };\n    } else {\n        tableFunction.wptmBootbox('', wptmText.CHART_INVALID_DATA, wptmText.GOT_IT, false);\n    }\n\n    try {\n        chartData.useFirstRowAsLabels = currentChart.config.useFirstRowAsLabels;\n        currentChart.config.scaleBeginAtZero = false;//fix the original value of the shaft\n        currentChart.config.responsive = false;//fix the original value of the shaft\n        if (typeof currentChart.config.scales !== 'undefined') {\n            delete currentChart.config.scales;//fix the chart shows the wrong axes\n            // delete DropChart.config.scales;//fix the chart shows the wrong axes\n            delete currentChart.config.cubicInterpolationMode;\n            delete currentChart.config.tension;\n        }\n\n        let scales = null\n        if (currentChart.config.stepSize && currentChart.config.stepSize > 0)\n            scales = {ticks: {stepSize: currentChart.config.stepSize}}\n\n        if (currentChart.config.minY && currentChart.config.minY >= 0)\n            scales = scales !== null ? {...scales, ...{min: parseFloat(currentChart.config.minY)}} : {min: parseFloat(currentChart.config.minY)}\n\n        // if (scales !== null)\n        //     scales = {...scales, ...{beginAtZero: false}}\n        //https://www.chartjs.org/docs/3.1.1/axes/cartesian/linear.html\n\n        let wptmChartConfig = $.extend({}, {}, currentChart.config)\n        if (currentChart.config.legend_display === false) {\n            wptmChartConfig.plugins.legend = {display: false}\n        } else {\n            wptmChartConfig.plugins.legend = {display: true}\n        }\n        delete wptmChartConfig.width\n        delete wptmChartConfig.height\n        switch (currentChart.type) {\n            case 'PolarArea':\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'polarArea',\n                    data: chartData,\n                    options: wptmChartConfig\n                });\n                break;\n\n            case 'Pie':\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'pie',\n                    data: chartData,\n                    options: wptmChartConfig\n                });\n                break;\n\n            case 'Doughnut':\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'doughnut',\n                    data: chartData,\n                    options: wptmChartConfig\n                });\n                break;\n\n            case 'Bar':\n                if (scales !== null) {\n                    wptmChartConfig.scales = {y: scales}\n                    wptmChartConfig.scales.y.afterBuildTicks = function(axis) {\n                        if (scales.ticks?.stepSize > 0 && axis.ticks[1].value - axis.ticks[0].value < axis.ticks[2].value - axis.ticks[1].value) {\n                            axis.ticks = axis.ticks.map(function (tick) {\n                                let newStep = tick.value\n                                if (axis.start < tick.value) {\n                                    let newStep1 = Math.floor((tick.value - axis.start)/ scales.ticks.stepSize)\n                                    newStep = axis.start + (newStep1 + 1) * scales.ticks.stepSize\n                                }\n                                tick.value = newStep\n                                return tick\n                            });\n                        }\n                    }\n                }\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'bar',\n                    data: chartData,\n                    options: wptmChartConfig\n                });\n                break;\n\n            case 'Radar':\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'radar',\n                    data: chartData,\n                    options: wptmChartConfig\n                });\n                break;\n\n            case 'Line':\n            default:\n                if (scales !== null) {\n                    wptmChartConfig.scales = {y: scales}\n                    wptmChartConfig.scales.y.afterBuildTicks = function(axis) {\n                        if (scales.ticks?.stepSize > 0 && axis.ticks[1].value - axis.ticks[0].value < axis.ticks[2].value - axis.ticks[1].value) {\n                            axis.ticks = axis.ticks.map(function (tick) {\n                                let newStep = tick.value\n                                if (axis.start < tick.value) {\n                                    let newStep1 = Math.floor((tick.value - axis.start)/ scales.ticks.stepSize)\n                                    newStep = axis.start + (newStep1 + 1) * scales.ticks.stepSize\n                                }\n                                tick.value = newStep\n                                return tick\n                            });\n                        }\n                    }\n                }\n                wptmChartConfig.cubicInterpolationMode = 'default';\n                wptmChartConfig.tension = 0.3;\n\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'line',\n                    data: chartData,\n                    options: wptmChartConfig\n                });\n                break;\n        }\n\n        DropChart.optionsChanged = false;\n        //update val of selector to chart option\n\n        if (!re_render) {\n            updateOption(currentChart);\n\n            setTimeout(function () {\n                initChartObserver();\n            }, 200)\n        } else {\n            DropChart.optionsChanged = true;\n        }\n\n        if (save_chart) {\n            DropChart.functions.save();\n        }\n    } catch (e) {}\n}\n\nDropChart.functions.save = function () {\n    if (!(Wptm.can.edit || (Wptm.can.editown && data.author === Wptm.author))) {\n        return;\n    }\n\n    var $ = jQuery;\n    let config = DropChart.datas[DropChart.id_chart].config\n    var jsonVar = {\n        jform: {\n            type: DropChart.datas[DropChart.id_chart].type,\n            config: JSON.stringify(config)\n        },\n        id: DropChart.id_chart\n    };\n\n    if (DropChart.changer === true) {\n        jsonVar.jform.datas = JSON.stringify(DropChart.datas[DropChart.id_chart].selections);\n        DropChart.changer = false;\n    }\n    var $saving = $('.wptm_top_chart .saving');\n    $saving.html(wptmText.SAVING);\n    $saving.animate({'opacity': '1'}, 200);\n    $.ajax({\n        url: wptm_ajaxurl + \"task=chart.save\",\n        dataType: \"json\",\n        type: \"POST\",\n        data: jsonVar,\n        success: function (datas) {\n            if (datas.response === true) {\n                $saving.html(wptmText.ALL_CHANGES_SAVED).delay(500).animate({'opacity': '0'}, 200);\n            } else {\n                $saving.animate({'opacity': '0'}, 200);\n                tableFunction.wptmBootbox('', datas.response, true, false);\n            }\n        },\n        error: function (jqxhr, textStatus, error) {\n            $saving.animate({'opacity': '0'}, 200);\n            tableFunction.wptmBootbox('', textStatus + \" : \" + error, true, false);\n        }\n    });\n}\n\nDropChart.functions.getDataSets2 = function (dataCells, config, selections, chartDataRaw) {\n    DropChart.currency_symbol = typeof Wptm.style.table.currency_symbol === 'undefined'\n        ? default_value.currency_symbol\n        : Wptm.style.table.currency_symbol;\n    DropChart.thousand_symbol = typeof Wptm.style.table.thousand_symbol === 'undefined'\n        ? default_value.thousand_symbol\n        : Wptm.style.table.thousand_symbol;\n    DropChart.decimal_symbol = typeof Wptm.style.table.decimal_symbol === 'undefined'\n        ? default_value.decimal_symbol\n        : Wptm.style.table.decimal_symbol;\n\n    let datasReturn = {}\n    let countDataValidate = 0\n    let datasraw = {}\n    let xAxisLabels = jQuery.extend([], [], dataCells[config.axisColumn])\n\n    if (!config.useFirstRowAsGraph) {\n        xAxisLabels.shift()\n    }\n\n    let graphLabel = []\n\n    jQuery.each(dataCells, function (id, dataCell) {\n        // if (!config.useFirstRowAsGraph && id === config.axisColumn) {\n        //     return;\n        // }\n        if (!(config.linesData.indexOf(id) != -1)) {\n            return;\n        }\n\n        let floatValues = [], cellDatas = []\n        let count_cell_in_line = 0\n        let isNull = 0\n        let percentValues = []\n        let percentCount = 0\n        jQuery.each(dataCell, (i, v) => {\n            count_cell_in_line++\n            let check = v, floatValue = ''\n\n            let check1 = check.replaceAll(' ', '');\n            check = check1.replace(DropChart.currency_symbol, '');\n            check = check.replace(DropChart.thousand_symbol, '');\n            check = check.replace(DropChart.decimal_symbol, '.');\n\n            floatValue = check.replace(/[^0-9|^%|\\\\.|-]/g, '');//value\n\n            check = check.replace(/[0-9|\\\\.|,|-| |%]/g, '');\n\n            if (check !== '' || check1 === '') {//have strange characters or is null\n                isNull++\n            }\n\n            if (floatValue.includes('%')) {\n                percentCount++\n                floatValues.push(floatValue.replace(/[%]/g, ''))\n            } else {\n                floatValue = floatValue !== '' ? floatValue : 0\n                floatValues.push(floatValue)\n            }\n\n            cellDatas.push(chartDataRaw[id][i])\n        })\n\n        graphLabel.push(cellDatas[0])\n\n        //remove first RowAsLabels\n        if (!config.useFirstRowAsGraph) {\n            floatValues.shift()\n            cellDatas.shift()\n        }\n\n        if (percentCount + 1 >= count_cell_in_line) {//percent line\n\n        }\n\n        if (isNull === count_cell_in_line) {\n            datasReturn[id] = 0\n        } else {\n            datasReturn[id] = floatValues\n            countDataValidate++\n        }\n        datasraw[id] = cellDatas\n    })\n\n    return [datasReturn, datasraw, countDataValidate, graphLabel, xAxisLabels];\n}\n\n//get valid chart data area\n// return: valid data , col indexes, row indexes\nDropChart.functions.getValidChartData = function (cellsData) {\n    var i, tempIndexes;\n    var results = [];\n    var resultIndexes = [];\n    var rowIndexes = [];\n    for (i = 0; i < cellsData[0].length; i++) {\n        resultIndexes.push(i);\n    }\n\n    for (i = 0; i < cellsData.length; i++) {\n        if (DropChart.helper.isValidRow(cellsData[i])) {\n            results.push(cellsData[i]);\n            rowIndexes.push(i);\n            tempIndexes = DropChart.helper.getValidIndexes(cellsData[i]);\n            resultIndexes = DropChart.helper.intersection(tempIndexes, resultIndexes);\n        }\n    }\n    var tempArr = [];\n\n    for (i = 0; i < results.length; i++) {\n        tempArr = [];\n        for (var j = 0; j < tempIndexes.length; j++) {\n            tempArr.push(results[i][tempIndexes[j]]);\n        }\n        results[i] = tempArr;\n    }\n    return [results, resultIndexes, rowIndexes];\n}\n\nDropChart.functions.checkValidRowData = function (array) {\n    return !array.some(function (value, index, array) {\n        return value !== array[0];\n    });\n}\n\nDropChart.functions.sizeSelection = function (selection, direction = null) {\n    if (selection.length == 0) {\n        return false;\n    }\n\n    if (selection[0] === selection[2] && selection[1] === selection[3]) {\n        return false;\n    }\n\n    if (direction !== null && ((direction === 'col' && selection[0] + 1 >= selection[2]) || (direction === 'row' && selection[1] + 1 >= selection[3]))) {\n        return false;\n    }\n\n    return true\n}\n\nDropChart.functions.validateChartData = function (selections = null, direction = null) {\n    selections = selections === null ? table_function_data.selection : selections\n    let chartData = {}, chartDataRaw = {}, chartDataPosition = []\n\n    if (typeof selections[0][0] === 'string') {//old data\n        let cell = selections[0][0].split(':')\n        let lastSelections = selections[selections.length - 1]\n        let cell2 = lastSelections[lastSelections.length - 1].split(':')\n        selections = [[parseInt(cell[0]), parseInt(cell[1]), parseInt(cell2[0]), parseInt(cell2[1])]]\n    }\n\n    let max_value = 0\n    for (let i = 0; i < _.size(selections); i++) {\n        let selectCell = []\n        let selection = selections[i]\n\n        if (direction !== 'row') {//direction === col\n            selectCell = [parseInt(selection[0]), parseInt(selection[1]), parseInt(selection[2]), parseInt(selection[3])]\n        } else {//default row\n            selectCell = [parseInt(selection[1]), parseInt(selection[0]), parseInt(selection[3]), parseInt(selection[2])]\n        }\n\n        max_value = (selectCell[2] - selectCell[0]) > max_value ? (selectCell[2] - selectCell[0]) : max_value\n    }\n\n    if (_.size(selections) == 1 && selections[0][1] === selections[0][3] && selections[0][0] === selections[0][2]) {\n        return false\n    }\n\n    //select cells not validate\n    for (let i = 0; i < _.size(selections); i++) {\n        let selectCell = []\n        let selection = selections[i]\n\n        if (direction !== 'row') {//direction === col\n            selectCell = [parseInt(selection[0]), parseInt(selection[1]), parseInt(selection[2]), parseInt(selection[3])]\n        } else {//default row\n            selectCell = [parseInt(selection[1]), parseInt(selection[0]), parseInt(selection[3]), parseInt(selection[2])]\n        }\n\n        for (let i2 = selectCell[1]; i2 <= selectCell[3]; i2++) {\n            for (let i3 = selectCell[0]; i3 <= selectCell[2]; i3++) {\n                chartData[i2] = typeof chartData[i2] === 'undefined' ? [] : chartData[i2]\n                chartDataRaw[i2] = typeof chartDataRaw[i2] === 'undefined' ? [] : chartDataRaw[i2]\n\n                if (direction !== 'row') {//direction === col\n                    if (typeof Wptm.datas[i3] === 'undefined' || typeof Wptm.datas[i3][i2] === 'undefined') {\n                        return false\n                    }\n                    if (typeof chartDataPosition[i3 + '!' + i2] === 'undefined') {\n                        let customRendererData = customRenderer.render(\n                            false,\n                            false,\n                            i3,\n                            i2,\n                            false,\n                            (typeof Wptm.datas[i3][i2] !== 'undefined' && Wptm.datas[i3][i2] !== null) ? Wptm.datas[i3][i2] : '',\n                            'cellProperties',\n                            true\n                        )\n\n                        let [cell_value, raw_value] = customRendererData\n                        cell_value = typeof cell_value === 'boolean' ? (cell_value ? 'true' : 'false') : cell_value\n\n                        chartData[i2].push(raw_value || cell_value)\n                        chartDataRaw[i2].push(cell_value)\n                        chartDataPosition[i3 + ':' + i2] = cell_value\n                    }\n                } else {//default row\n                    if (typeof Wptm.datas[i2] === 'undefined' || typeof Wptm.datas[i2][i3] === 'undefined') {\n                        return false\n                    }\n                    if (typeof chartDataPosition[i2 + '!' + i3] === 'undefined') {\n                        let customRendererData = customRenderer.render(\n                            false,\n                            false,\n                            i2,\n                            i3,\n                            false,\n                            (typeof Wptm.datas[i2][i3] !== 'undefined' && Wptm.datas[i2][i3] !== null) ? Wptm.datas[i2][i3] : '',\n                            'cellProperties',\n                            true\n                        )\n\n                        let [cell_value, raw_value] = customRendererData\n                        cell_value = typeof cell_value === 'boolean' ? (cell_value ? 'true' : 'false') : cell_value\n\n                        chartData[i2].push(raw_value || cell_value)\n                        chartDataRaw[i2].push(cell_value)\n                        chartDataPosition[i2 + ':' + i3] = cell_value\n                    }\n                }\n            }\n        }\n    }\n\n    //add missing value for line\n    if (max_value >= 1 && Object.keys(chartDataRaw)?.length > 1) {\n        jQuery.each(chartDataRaw, function (id, dataCell) {\n            if (dataCell.length < max_value) {\n                chartDataRaw[id] =  dataCell.concat(Array(max_value - dataCell.length).fill(0))\n                chartData[id] =  chartData[id].concat(Array(max_value - dataCell.length).fill(0))\n            }\n        })\n    }\n\n    return [chartData, selections, chartDataRaw]\n}\n\n//check val of cells to chart of table\nDropChart.functions.validateCharts = function (change) {\n    var result = true;\n    var $ = jQuery;\n    var editCell = change[0] + \":\" + change[1];\n\n    $.each(DropChart.datas, function (chart_id, chart) {\n        if (chart_id) {\n            var cells = chart.data;\n            if (DropChart.helper.inArrays(editCell, cells)) {\n                var cellsData = [];\n                for (var i = 0; i < cells.length; i++) {\n                    var rowData = [];\n                    for (var j = 0; j < cells[i].length; j++) {\n                        if (cells[i][j] != editCell) {\n                            rowData[j] = tableFunction.getCellData(cells[i][j]);\n                        } else {\n                            rowData[j] = change[3];//new value\n                        }\n                    }\n                    cellsData[i] = rowData;\n                }\n\n                if (!validateDataForChart(cellsData)) {\n                    result = false;\n                }\n            }\n        }\n    });\n\n    return result;\n}\n\nfunction validateDataForChart(Cells) {\n    var rValid, rCells, cValid, subCells, rsubCells;\n    //Check row\n    rValid = DropChart.helper.hasNumbericRow(Cells);\n    if (!rValid) {\n        //check column\n        rCells = DropChart.helper.transposeArr(Cells);\n        cValid = DropChart.helper.hasNumbericRow(rCells);\n        if (!cValid) { //ignore first row and column\n\n            subCells = DropChart.helper.removeFirstRowColumn(rCells);\n            if (subCells.length <= 0) return false;\n\n            rValid = DropChart.helper.hasNumbericRow(subCells);\n            if (!rValid) {\n                rsubCells = DropChart.helper.transposeArr(subCells);\n                cValid = DropChart.helper.hasNumbericRow(rsubCells);\n            }\n        }\n    }\n\n    return (rValid || cValid);\n}\n\nDropChart.helper = {}\n\nDropChart.helper.getStrangeCharacters2 = function (value) {\n    var value1, value0;\n    value0 = typeof value[1] !== 'undefined' ? value[1].toString().replaceAll(' ', '') : value[0].replaceAll(' ', '');\n    value1 = value0.replace(DropChart.currency_symbol, '');\n    value1 = value1.replace(DropChart.thousand_symbol, '');\n    value1 = value1.replace(DropChart.decimal_symbol, '.');\n    value[1] = value1.replace(/[^0-9|\\\\.|-]/g, '');//value\n\n    value[2] = 0;//nan\n    value[3] = 0;//currency_symbol\n    value1 = value1.replace(/[0-9|\\\\.|,|-| ]/g, '');\n\n    if (value1 !== '' || value[0] === '') {//have strange characters or is null\n        value[2] = 1;\n    }\n    if (value[0] !== '' && (value[0].includes(DropChart.currency_symbol) || arguments[1] === true)) {\n        value[3] = 1;\n    }\n\n    return value;\n}\n\nDropChart.helper.getStrangeCharacters = function (value) {\n    var data = [], value1;\n    value1 = value.replace(DropChart.currency_symbol, '');\n    value1 = value1.replace(DropChart.thousand_symbol, '.');\n    value1 = value1.replace(DropChart.decimal_symbol, '');\n    data['value'] = value1.replace(/[^0-9|\\\\.|-]/g, '');\n    data['NaN'] = 0;\n    data['delete'] = 0;\n    value1 = value1.replace(/[0-9|\\\\.|,|-| ]/g, '');\n    if (value1 !== '' || value === '') {//have strange characters or is null\n        data['NaN'] = 1;\n        data['delete'] = 1;\n    }\n    if (data['value'] !== '' && value !== '' && value.includes(DropChart.currency_symbol)) {\n        data['currency_symbol'] = 1;\n    }\n\n    return data;\n}\n//get index of valid number in the array\nDropChart.helper.getValidIndexes = function (arr) {\n    var currency_symbol = typeof Wptm.style.table.currency_symbol === 'undefined'\n        ? default_value.currency_symbol\n        : Wptm.style.table.currency_symbol;\n    var thousand_symbol = typeof Wptm.style.table.thousand_symbol === 'undefined'\n        ? default_value.thousand_symbol\n        : Wptm.style.table.thousand_symbol;\n\n    // var thousand_re = new RegExp(thousand_symbol,\"g\");\n    var thousand_re = new RegExp('[' + thousand_symbol + ']', \"g\");\n    var i, v, x1;\n    var result = [];\n\n    for (i = 0; i < arr.length; i++) {\n\n        v = arr[i] ? arr[i].toString() : \"\";\n        x1 = v.replace(currency_symbol, '');\n        x1 = x1.replace(thousand_re, '');\n        x1 = x1.replace(/[\\\\.|+|,| ]/g, '');\n        x1 = x1.replace(/-/g, '');\n        x1 = x1.replace(/[0-9]/g, '');\n        if (x1 === '') {\n            result.push(i);\n        }\n    }\n    return result;\n}\n//get intersection values of two array\nDropChart.helper.intersection = function (a, b) {\n    var rs = [];\n    for (var i = 0; i < a.length; i++) {\n        if (b.indexOf(a[i]) != -1) {\n            rs.push(a[i]);\n        }\n    }\n    return rs;\n};\n\nDropChart.helper.isNumbericArray = function (arr) {\n    var valid = true;\n    for (var c = 0; c < arr.length; c++) {\n        if (isNaN(arr[c])) {\n            valid = false;\n        }\n    }\n\n    return valid;\n};\n\nDropChart.helper.convertToNumber = function (arr) {\n    var result = [];\n    for (var c = 0; c < arr.length; c++) {\n        // if (!isNaN(arr[c])) {\n        if (typeof arr[c] === 'string') {\n            arr[c] = tableFunction.stringReplace(arr[c], false);\n        }\n        result.push(arr[c]);\n        // }\n    }\n    return result;\n};\n\nDropChart.helper.transposeArr = function (arr) {\n    if (typeof arr === \"undefined\" || arr.length === 0) {\n        return [];\n    }\n    return Object.keys(arr[0]).map(function (c) {\n        return arr.map(function (r) {\n            return r[c];\n        });\n    });\n}\n\nDropChart.helper.inArrays = function (c, cells) {\n    var result = false;\n    for (var r = 0; r < cells.length; r++) {\n        if (cells[r].indexOf(c) > -1) {\n            result = true;\n        }\n    }\n\n    return result;\n}\n// there is at least 2 number\nDropChart.helper.isValidRow = function (arr) {\n    var currency_symbol = typeof Wptm.style.table.currency_symbol === 'undefined'\n        ? default_value.currency_symbol\n        : Wptm.style.table.currency_symbol;\n    var thousand_symbol = typeof Wptm.style.table.thousand_symbol === 'undefined'\n        ? default_value.thousand_symbol\n        : Wptm.style.table.thousand_symbol;\n\n    var thousand_re = new RegExp('[' + thousand_symbol + ']', \"g\");\n    var i, v, x1, count = 0;\n\n    for (i = 0; i < arr.length; i++) {\n        v = arr[i] ? arr[i].toString() : \"\";\n        if (v !== '') {\n            x1 = v.replace(currency_symbol, '');\n            x1 = x1.replace(thousand_re, '');\n            x1 = x1.replace(/[\\\\.|+|,| ]/g, '');\n            x1 = x1.replace(/-/g, '');\n            x1 = x1.replace(/[0-9]/g, '');\n            if (x1 === '') {\n                count++;\n            }\n        }\n    }\n    return (count > 1);\n}\n\nDropChart.helper.hasNumbericRow = function (Cells) {\n    var rValid = false;\n    if (typeof Cells === \"undefined\") {\n        return false;\n    }\n\n    for (var r = 0; r < Cells.length; r++) {\n        if (DropChart.helper.isValidRow(Cells[r])) {\n            rValid = true;\n            break;\n        }\n    }\n    return rValid;\n}\n\n// check val int cel in row\nDropChart.helper.hasNumbericRowCol = function (Cells) {\n    var rValid = true;\n    var rNaN = 0;\n    if (typeof Cells === \"undefined\") {\n        return false;\n    }\n    for (var r = 0; r < Cells.length; r++) {\n        var valid = true;\n        if (typeof (Cells[r]) === 'string' && isNaN(parseInt(tableFunction.stringReplace(Cells[r], false)))) {\n            valid = false;\n        }\n\n        if (!valid) {\n            rNaN++;\n        }\n    }\n\n    if (rNaN === Cells.length) {\n        rValid = false;\n    }\n    return rValid;\n}\n\nDropChart.helper.getRowData = function (row) {\n    var data = [];\n    for (var j = 0; j < row.length; j++) {\n        data[j] = tableFunction.getCellData(row[j]);\n    }\n\n    return data;\n}\n\nDropChart.helper.getRangeData = function (cells) {\n    var datas = [];\n    for (var i = 0; i < cells.length; i++) {\n        datas[i] = DropChart.helper.getRowData(cells[i]);\n    }\n\n    return datas;\n}\n\nDropChart.helper.getCellRangeLabel = function (cells) {\n    var data = [];\n    var firstCell = cells[0][0];\n    var lastRow = cells[cells.length - 1];\n    var lastCell = lastRow[lastRow.length - 1];\n\n    var pos = firstCell.split(\":\");\n    data[0] = parseInt(pos[0]);\n    data[1] = parseInt(pos[1]);\n\n    pos = lastCell.split(\":\");\n    data[2] = parseInt(pos[0]);\n    data[3] = parseInt(pos[1]);\n    return data;\n}\n\nDropChart.helper.canSwitchRowCol = function (cellsData) {\n    var result = -1;\n    var rValid = false;\n    var cValid = false;\n    if (DropChart.helper.hasNumbericRow(cellsData)) {\n        rValid = true;\n    }\n    var rCellsData = DropChart.helper.transposeArr(cellsData);\n    if (DropChart.helper.hasNumbericRow(rCellsData)) {\n        cValid = true;\n    }\n\n    if (rValid && cValid) {\n        result = 3;\n    } else if (rValid) {\n        result = 2;\n    } else if (cValid) {\n        result = 1;\n    } else {\n        // invalid data\n        result = -1;\n    }\n\n    return result;\n}\n\nDropChart.helper.removeFirstRowColumn = function (cells) {\n    cells.shift();\n    if (cells.length > 0) {\n        cells = DropChart.helper.transposeArr(cells);\n        cells.shift();\n    }\n\n    return cells;\n}\n\nDropChart.helper.getEmptyArray = function (len) {\n    var result = [];\n    for (var i = 0; i < len; i++) {\n        result[i] = \"    \";\n    }\n    return result;\n}\n\nDropChart.helper.convertHex = function (hex, opacity) {\n    hex = hex.replace('#', '');\n    var r = parseInt(hex.substring(0, 2), 16);\n    var g = parseInt(hex.substring(2, 4), 16);\n    var b = parseInt(hex.substring(4, 6), 16);\n\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + opacity / 100 + ')';\n}\n\nDropChart.helper.ColorLuminance = function (hex, lum) {\n\n    // validate hex string\n    hex = String(hex).replace(/[^0-9a-f]/gi, '');\n    if (hex.length < 6) {\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n    lum = lum || 0;\n\n    // convert to decimal and change luminosity\n    var rgb = \"#\", c, i;\n    for (i = 0; i < 3; i++) {\n        c = parseInt(hex.substr(i * 2, 2), 16);\n        c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\n        rgb += (\"00\" + c).substr(c.length);\n    }\n\n    return rgb;\n}\n\nexport default DropChart\n","import tableFunction from \"./_functions\";\n\n/*month text and aug calculator cell*/\nvar F_name = [\"january\", \"february\", \"march\", \"april\", \"may\", \"june\", \"july\", \"august\", \"september\", \"october\", \"november\", \"december\"];\nvar M_name = [\"jan\", \"feb\", \"mar\", \"apr\", \"may\", \"jun\", \"jul\", \"aug\", \"sept\", \"oct\", \"nov\", \"dec\"];\nvar l_name = [\"sunday\", \"monday\", \"tuesday\", \"wednesday\", \"thursday\", \"friday\", \"saturday\"];\nvar D_name = [\"sun\", \"mon\", \"tue\", \"wed\", \"thu\", \"fri\", \"sat\"];\nvar regex2 = new RegExp('([a-zA-Z]+)([0-9]+)');\nvar regex3 = new RegExp('([a-zA-Z]+)([0-9]+)', 'g');\n/* List of supported formulas */\nvar regex = new RegExp('^=(DATE|DAY|DAYS|DAYS360|AND|OR|XOR|SUM|MULTIPLY|DIVIDE|COUNT|MIN|MAX|AVG|CONCAT|date|day|days|days360|and|or|xor|sum|multiply|divide|count|min|max|avg|concat)\\\\((.*?)\\\\)$');\nvar regex22 = new RegExp('^=([a-zA-Z]+)\\\\((.*?)\\\\)$');\nvar has_replace = ['AND','OR','XOR','SUM','MULTIPLY','DIVIDE','COUNT','MIN','MAX','AVG'];\nvar Not_range_function = ['DATE','DAY','DAYS','DAYS360'];\n\nvar merge_style_val_cell = function (style_cols, style_rows, Wptm, row, col) {\n    var cellStyle = [];\n\n    if (tableFunction.checkObjPropertyNestedNotEmpty(style_cols, col, 1)) {\n        cellStyle[2] = jquery.extend([], style_cols[col][1]);\n    }\n    if (tableFunction.checkObjPropertyNestedNotEmpty(style_rows, row, 1)) {\n        cellStyle[2] = jquery.extend([], cellStyle[2], style_rows[row][1]);\n    }\n\n    if (tableFunction.checkObjPropertyNested(Wptm.style,'cells', row + \"!\" + col, 2)) {\n        if (tableFunction.checkObjPropertyNestedNotEmpty(Wptm.style.cells[row + \"!\" + col][2], 'tooltip_content')) {\n            cellStyle[2].tooltip_content = Wptm.style.cells[row + \"!\" + col][2].tooltip_content;\n            cellStyle[2].tooltip_width = Wptm.style.cells[row + \"!\" + col][2].tooltip_width;\n        }\n        if (Wptm.type === 'html' || row == 0) {\n            cellStyle[2] = jquery.extend({}, cellStyle[2],  Wptm.style.cells[row + \"!\" + col][2]);\n        }\n    }\n    return cellStyle;\n}\n\n/**\n * function render cell when handsontable render, call in handsontable.renderer\n *\n * @param instance\n * @param td             cell element\n * @param row            now number\n * @param col            col number\n * @param prop\n * @param value          cell value\n * @param cellProperties\n * @returns {*}\n */\nvar render = function (instance, td, row, col, prop, value, cellProperties) {\n    var onl_value_cell = false;\n    if (typeof Array.prototype.slice.call(arguments, 6)[1] !== \"undefined\") {\n        // onl_value_cell = true;\n        onl_value_cell = Array.prototype.slice.call(arguments, 6)[1];\n    }\n\n    if (typeof Array.prototype.slice.call(arguments, 7)[1] !== \"undefined\") {\n        window.Wptm.numberSheetCalculation++\n    } else {\n        window.Wptm.numberSheetCalculation = 1\n    }\n\n    var Wptm = window.Wptm;\n    var function_data = window.table_function_data;\n    var css = {};\n    var celltype = '', tooltip_content = false;\n    var first_cell_merged = false;\n\n    if (typeof (Wptm.style.cells) !== 'undefined') {\n        //Cells rendering\n        var cellStyle = [];\n\n        if (tableFunction.checkObjPropertyNestedNotEmpty( Wptm.style.cols, col, 1)) {\n            cellStyle[2] = jquery.extend([], Wptm.style.cols[col][1]);\n        }\n        if (tableFunction.checkObjPropertyNestedNotEmpty( Wptm.style.rows, row, 1)) {\n            cellStyle[2] = jquery.extend([], cellStyle[2], Wptm.style.rows[row][1]);\n        }\n\n        if (tableFunction.checkObjPropertyNested(Wptm.style,'cells', row + \"!\" + col, 2)) {\n            if (Wptm.type === 'html' || row == 0) {\n                cellStyle[2] = jquery.extend({}, cellStyle[2],  Wptm.style.cells[row + \"!\" + col][2]);\n            }\n        }\n\n        if (!onl_value_cell) {\n            if (typeof (cellStyle[2]) !== 'undefined') {\n                if (typeof cellStyle[2].AlternateColor !== 'undefined' || typeof function_data.allAlternate.default !== 'undefined') {\n                    var numberRow = 0;\n                    css[\"background-color\"] = '';\n                    if (typeof function_data.allAlternate.default !== 'undefined') {\n                        if (function_data.allAlternate.header === '') {\n                            numberRow = -1;\n                        }\n                        switch (row) {\n                            case 0:\n                                if (function_data.allAlternate.header === '') {\n                                    css[\"background-color\"] = function_data.allAlternate.even;\n                                } else {\n                                    css[\"background-color\"] = function_data.allAlternate.header;\n                                }\n                                break;\n                            case _.size(Wptm.style.rows) - 1:\n                                if (function_data.allAlternate.footer === '') {\n                                    if ((row - parseInt(0 + numberRow)) % 2) {\n                                        css[\"background-color\"] = function_data.allAlternate.even;\n                                    } else {\n                                        css[\"background-color\"] = function_data.allAlternate.old;\n                                    }\n                                } else {\n                                    css[\"background-color\"] = function_data.allAlternate.footer;\n                                }\n                                break;\n                            default:\n                                if ((row - parseInt(0 + numberRow)) % 2) {\n                                    css[\"background-color\"] = function_data.allAlternate.even;\n                                } else {\n                                    css[\"background-color\"] = function_data.allAlternate.old;\n                                }\n                                break;\n                        }\n                    } else {\n                        var value_cell_alternateColor = function_data.oldAlternate[cellStyle[2].AlternateColor];\n                        if (typeof value_cell_alternateColor === 'undefined') {\n                            if (typeof function_data.changeAlternate[cellStyle[2].AlternateColor] !== 'undefined' || function_data.changeAlternate.length < 1) {\n                                cellStyle[2].AlternateColor = function_data.changeAlternate[cellStyle[2].AlternateColor];\n                                value_cell_alternateColor = function_data.oldAlternate[cellStyle[2].AlternateColor];\n                            }\n                        }\n\n                        if (typeof value_cell_alternateColor !== 'undefined' && value_cell_alternateColor !== false && typeof value_cell_alternateColor.selection !== 'undefined') {\n                            if (value_cell_alternateColor.header === '') {\n                                numberRow = -1;\n                            }\n                            switch (row) {\n                                case parseInt(value_cell_alternateColor.selection[0]):\n                                    if (value_cell_alternateColor.header === '') {\n                                        css[\"background-color\"] = value_cell_alternateColor.even;\n                                    } else {\n                                        css[\"background-color\"] = value_cell_alternateColor.header;\n                                    }\n                                    break;\n                                case parseInt(value_cell_alternateColor.selection[2]):\n                                    if (value_cell_alternateColor.footer === '') {\n                                        if ((row - parseInt(value_cell_alternateColor.selection[0] + numberRow)) % 2) {\n                                            css[\"background-color\"] = value_cell_alternateColor.even;\n                                        } else {\n                                            css[\"background-color\"] = value_cell_alternateColor.old;\n                                        }\n                                    } else {\n                                        css[\"background-color\"] = value_cell_alternateColor.footer;\n                                    }\n                                    break;\n                                default:\n                                    if ((row - parseInt(value_cell_alternateColor.selection[0] + numberRow)) % 2) {\n                                        css[\"background-color\"] = value_cell_alternateColor.even;\n                                    } else {\n                                        css[\"background-color\"] = value_cell_alternateColor.old;\n                                    }\n                                    break;\n                            }\n                        } else {\n                            delete cellStyle[2].AlternateColor;\n                            if (typeof Wptm.style.cells[row + \"!\" + col][2] !== 'undefined' && typeof Wptm.style.cells[row + \"!\" + col][2].AlternateColor !== 'undefined') {\n                                delete Wptm.style.cells[row + \"!\" + col][2].AlternateColor;\n                            }\n                        }\n                    }\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_type')) {\n                    celltype = cellStyle[2].cell_type;\n                } else if (typeof cellStyle[2].cell_type !== 'undefined') {\n                    delete cellStyle[2].cell_type;\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_background_color')) {\n                    css[\"background-color\"] = cellStyle[2].cell_background_color;\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_top')) {\n                    css[\"border-top\"] = cellStyle[2].cell_border_top;\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_top_start')) {\n                    if (0 == row) {\n                        css[\"border-top\"] = cellStyle[2].cell_border_top_start;\n                    }\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_right')) {\n                    css[\"border-right\"] = cellStyle[2].cell_border_right;\n                }\n\n                //check merge cell and border right\n                if (typeof table_function_data.start_merge_cell_col !== 'undefined' && typeof table_function_data.start_merge_cell_col[col] !== 'undefined') {\n                    window.jquery.each(table_function_data.start_merge_cell_col[col], function (index, value) {\n                        if (typeof value !== 'undefined') {\n                            var start_merge_cell_col = Wptm.mergeCellsSetting[value];\n                            if (start_merge_cell_col.rowspan + start_merge_cell_col.row > row && row >= start_merge_cell_col.row) {\n                                var end_style = merge_style_val_cell(Wptm.style.cols, Wptm.style.rows, Wptm, row, start_merge_cell_col.col + start_merge_cell_col.colspan - 1);\n                                first_cell_merged = true;\n                                if (tableFunction.checkObjPropertyNestedNotEmpty(end_style, 2, 'cell_border_right')) {\n                                    css[\"border-right\"] = end_style[2].cell_border_right;\n                                }\n                            }\n                        }\n                    });\n                }\n\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_bottom')) {\n                    css[\"border-bottom\"] = cellStyle[2].cell_border_bottom;\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_bottom_end')) {\n                    if (_.size(Wptm.style.rows) - 1 == row) {\n                        css[\"border-bottom\"] = cellStyle[2].cell_border_bottom_end;\n                    }\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_left')) {\n                    css[\"border-left\"] = cellStyle[2].cell_border_left;\n                }\n\n                delete css[\"word-wrap\"];\n                delete css[\"overflow\"];\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'text_wrapping')) {\n                    if (cellStyle[2].text_wrapping === 'normal') {\n                        css[\"word-wrap\"] = \"normal\";\n                        css[\"overflow\"] = \"visible\";\n                        css[\"white-space\"] = \"nowrap\";\n                    } else if (cellStyle[2].text_wrapping === 'break-word') {\n                        css[\"word-wrap\"] = \"break-word\";\n                        css[\"overflow\"] = \"visible\";\n                    } else if (cellStyle[2].text_wrapping === 'hidden') {\n                        css[\"overflow\"] = \"hidden\";\n                        css[\"white-space\"] = \"nowrap\";\n                    }\n                }\n\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_bold') && cellStyle[2].cell_font_bold === true) {\n                    css[\"font-weight\"] = \"bold\";\n                } else {\n                    delete css[\"font-weight\"];\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_italic') && cellStyle[2].cell_font_italic === true) {\n                    css[\"font-style\"] = \"italic\";\n                } else {\n                    delete css[\"font-style\"];\n                }\n\n                let cell_format_strikethrough = false;\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_format_strikethrough') && cellStyle[2].cell_format_strikethrough === true) {\n                    css[\"text-decoration\"] = \"line-through\";\n                    cell_format_strikethrough = true;\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_underline') && cellStyle[2].cell_font_underline === true) {\n                    css[\"text-decoration\"] = \"underline\";\n                } else {\n                    if (!cell_format_strikethrough) {\n                        delete css[\"text-decoration\"];\n                    }\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_text_align')) {\n                    css[\"text-align\"] = cellStyle[2].cell_text_align;\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_vertical_align')) {\n                    css[\"vertical-align\"] = cellStyle[2].cell_vertical_align;\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_family')) {\n                    css[\"font-family\"] = cellStyle[2].cell_font_family;\n                    //get list custom fonts used\n                    if (typeof wptm_listFont !== 'undefined' && wptm_listFont.length > 0\n                        && wptm_listFont.includes(cellStyle[2].cell_font_family)\n                        && !Wptm.style.table.fonts_used.includes(cellStyle[2].cell_font_family)) {\n                        Wptm.style.table.fonts_used.push(cellStyle[2].cell_font_family);\n                    }\n                    if (typeof wptm_listsLocalFont !== 'undefined' && wptm_listsLocalFont.length > 0\n                        && wptm_listsLocalFont.includes(cellStyle[2].cell_font_family)\n                        && !Wptm.style.table.fonts_local_used.includes(cellStyle[2].cell_font_family)) {\n                        Wptm.style.table.fonts_local_used.push(cellStyle[2].cell_font_family);\n                    }\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_size')) {\n                    css[\"font-size\"] = cellStyle[2].cell_font_size + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_color')) {\n                    css[\"color\"] = cellStyle[2].cell_font_color;\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_padding_left')) {\n                    css[\"padding-left\"] = cellStyle[2].cell_padding_left + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_padding_top')) {\n                    css[\"padding-top\"] = cellStyle[2].cell_padding_top + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_padding_right')) {\n                    css[\"padding-right\"] = cellStyle[2].cell_padding_right + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_padding_bottom')) {\n                    css[\"padding-bottom\"] = cellStyle[2].cell_padding_bottom + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_background_radius_left_top')) {\n                    css[\"border-top-left-radius\"] = cellStyle[2].cell_background_radius_left_top + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_background_radius_right_top')) {\n                    css[\"border-top-right-radius\"] = cellStyle[2].cell_background_radius_right_top + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_background_radius_right_bottom')) {\n                    css[\"border-bottom-right-radius\"] = cellStyle[2].cell_background_radius_right_bottom + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_background_radius_left_bottom')) {\n                    css[\"border-bottom-left-radius\"] = cellStyle[2].cell_background_radius_left_bottom + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'tooltip_content')) {\n                    tooltip_content = cellStyle[2].tooltip_content !== '' ? true : false;\n                }\n            }\n\n            //render style for table\n            window.jquery(td).css(css);\n\n            if (Object.keys(css).length > 0) {\n                function_data.styleToRender += '.dtr' + row + '.dtc' + col + '{';\n                window.jquery.each(css, function (index, value) {\n                    function_data.styleToRender += index + ':' + value + ';';\n                });\n                function_data.styleToRender += '}';\n            }\n        }\n    }\n\n    if (!onl_value_cell) {\n        switch (celltype) {\n            case 'html':\n                var escaped = Handsontable.helper.stringify(value);\n                //escaped = strip_tags(escaped, '<div><span><img><em><b><a>'); //be sure you only allow certain HTML tags to avoid XSS threats (you should also remove unwanted HTML attributes)\n                td.innerHTML = escaped;\n                window.jquery(td).addClass('isHtmlCell');\n                break;\n            default:\n                window.jquery(td).removeClass('isHtmlCell');\n                Handsontable.renderers.TextRenderer.apply(this, arguments);\n                break;\n        }\n\n        if (tooltip_content) {\n            window.jquery(td).addClass('isTooltipContent');\n        } else {\n            window.jquery(td).removeClass('isTooltipContent');\n        }\n    }\n\n    /* Calculs rendering */\n    if (typeof Wptm.style.table.date_formats === 'undefined') {\n        Wptm.style.table.date_formats = window.default_value.date_formats;\n    }\n    var accounting_for_cells = {};\n    var createRegExpFormatForCell = {};\n    var currency_symbol = '';\n    var setFormat_for_cells = {};\n    var cell_has_format = 0;\n\n    //not has time format\n    [accounting_for_cells, createRegExpFormatForCell, currency_symbol, setFormat_for_cells, cell_has_format] = get_format_for_cell(cellStyle[2], Wptm.style.table, function_data.string_currency_symbols, cell_has_format);\n\n    accounting_for_cells.date_formats = typeof cellStyle[2].date_formats !== 'undefined' && cellStyle[2].date_formats !== false ? cellStyle[2].date_formats : Wptm.style.table.date_formats;\n\n    if (typeof cellStyle[2].date_formats !== 'undefined' && cellStyle[2].date_formats !== '' && cellStyle[2].date_formats !== false) {\n        if (typeof cellStyle[2].date_formats_momentjs !== 'undefined' && cellStyle[2].date_formats_momentjs !== '' && cellStyle[2].date_formats_momentjs !== false) {\n            accounting_for_cells.date_formats_momentjs = cellStyle[2].date_formats_momentjs;\n        } else {\n            accounting_for_cells.date_formats_momentjs = tableFunction.momentjsFormat(accounting_for_cells.date_formats);\n        }\n    } else if (typeof accounting_for_cells.date_formats !== 'undefined') {\n        if (typeof function_data.date_formats_momentjs !== 'undefined' && function_data.date_formats_momentjs !== '') {\n            accounting_for_cells.date_formats_momentjs = function_data.date_formats_momentjs;\n        } else {\n            accounting_for_cells.date_formats_momentjs = tableFunction.momentjsFormat(Wptm.style.table.date_formats);\n        }\n    } else {\n        accounting_for_cells.date_formats_momentjs = '';\n    }\n\n    //accounting_for_cells.date_formats_momentjs from cell/table\n    if (typeof cellStyle[2].date_formats !== 'undefined' && cellStyle[2].date_formats !== false) {\n        createRegExpFormatForCell = tableFunction.createRegExpFormatForCell(false, accounting_for_cells.date_formats, createRegExpFormatForCell);\n    }\n\n    var value_null = value === null || value === '' ? true : false;\n\n    if (typeof (value) === 'string') {\n        var value_cell = value;\n        var valueNotFormat;\n        if (value[0] === '=') {\n            value_cell = evaluateFormulas2(td, row, col, value, function_data, accounting_for_cells, createRegExpFormatForCell, setFormat_for_cells, cell_has_format, onl_value_cell);\n        } else {\n            if (value_null) {\n                window.jquery(td).text(value);\n            }\n            if (currency_symbol !== '' && value.replace(currency_symbol, \"\") === '') {\n                value = value.replaceAll(accounting_for_cells.table.thousand, '');\n                value = value.replaceAll(accounting_for_cells.table.decimal, '.');\n                valueNotFormat = value;\n\n                if (cell_has_format === 1) {\n                    value_cell = accounting.formatNumber(value, accounting_for_cells.number);\n                }\n                if (cell_has_format > 1) {\n                    value_cell = accounting.formatMoney(value, accounting_for_cells.currency);\n                }\n\n                if (onl_value_cell) {\n                    valueNotFormat = accounting.formatMoney(value, \"\", accounting_for_cells.number.precision, typeof Wptm.style.table.thousand_symbol === 'undefined'\n                        ? default_value.thousand_symbol\n                        : Wptm.style.table.thousand_symbol, typeof Wptm.style.table.decimal_symbol === 'undefined'\n                        ? default_value.decimal_symbol\n                        : Wptm.style.table.decimal_symbol);\n                }\n\n                if (!onl_value_cell && !value_null) {\n                    window.jquery(td).text(value_cell);\n                }\n            }\n\n            if (typeof createRegExpFormatForCell.date_format !== 'undefined' && accounting_for_cells.date_formats !== '') {\n                value_cell = moment(value, function_data.date_formats_momentjs).format(cellStyle[2].date_formats_momentjs);\n                valueNotFormat = value;\n\n                if (!onl_value_cell && !value_null) {\n                    window.jquery(td).text(value_cell);\n                }\n            }\n        }\n\n        if (celltype == 'html' && (cell_has_format >= 1 || typeof createRegExpFormatForCell.date_format !== 'undefined')) {\n            tableFunction.getFillArray([[row, col, row, col]], Wptm, {\n                date_formats: false,\n                date_formats_momentjs: false,\n                currency_symbol: false,\n                symbol_position: false,\n                decimal_symbol: false,\n                decimal_count: false,\n                thousand_symbol: false\n            }, 'style');\n            var text = window.jquery(td).text();\n            saveData.push({action: 'edit_cell_html', row: row, col: col, content: text});\n        }\n        if (onl_value_cell) {\n            return typeof value_cell === 'string' ? [value_cell, valueNotFormat] : value_cell;\n        }\n    }\n\n    if (!onl_value_cell) {\n        //add class for lock column of db table\n        if (typeof Wptm.style.table.lock_columns !== 'undefined' && Wptm.style.table.lock_columns[col] != 0) {\n            window.jquery(td).addClass('wptm_lock_column');\n        }\n\n        if (!wptm_administrator) {\n            var lock_cell_id = [], not_lock_cell = false;\n            if (typeof table_function_data.protect_columns !== 'undefined'\n                && typeof table_function_data.protect_columns[col] !== 'undefined') {\n                //protect columns\n                lock_cell_id.push(table_function_data.protect_columns[col]);\n            }\n            if (typeof table_function_data.protect_rows !== 'undefined'\n                && typeof table_function_data.protect_rows[row] !== 'undefined') {\n                //protect rows\n                lock_cell_id.push(table_function_data.protect_rows[row]);\n            }\n            if (typeof Wptm.style.cells[row + \"!\" + col][2].lock_cell !== 'undefined') {\n                lock_cell_id.push(Wptm.style.cells[row + \"!\" + col][2].lock_cell);\n            }\n            if (lock_cell_id.length > 0 && typeof lock_cell_id[0] !== 'undefined'\n                && typeof table_function_data.lock_ranger_cells_user !== 'undefined') {\n                for (var ij in lock_cell_id) {\n                    if (table_function_data.lock_ranger_cells_user[lock_cell_id[ij]]) {//allow edit\n                        not_lock_cell = true;\n                        break;\n                    }\n                }\n                if (!not_lock_cell) {\n                    window.jquery(td).addClass('wptm_lock_cells');\n                }\n            }\n        }\n\n        window.jquery(td).addClass('dtr' + row + ' dtc' + col);\n    }\n\n    return td;\n};\n\nfunction get_format_for_cell(cellStyle, cellStyle2, string_currency_symbols, cell_has_format) {\n    var accounting_for_cells = {};\n    var setFormat_for_cells = {};\n    var createRegExpFormatForCell = {};\n    var currency_symbol = '';\n\n    if ((typeof cellStyle.decimal_count !== 'undefined' && cellStyle.decimal_count !== false)\n        || (typeof cellStyle.decimal_symbol !== 'undefined' && cellStyle.decimal_symbol !== false)\n        || (typeof cellStyle.currency_symbol !== 'undefined' && cellStyle.currency_symbol !== false)) {\n        setFormat_for_cells.thousand_symbol = typeof cellStyle.thousand_symbol !== 'undefined' && cellStyle.thousand_symbol !== false && cell_has_format !== 1 ? cellStyle.thousand_symbol : cellStyle2.thousand_symbol;\n        setFormat_for_cells.decimal_count = typeof cellStyle.decimal_count !== 'undefined' && cellStyle.decimal_count !== false && cell_has_format !== 1 ? cellStyle.decimal_count : cellStyle2.decimal_count;\n        setFormat_for_cells.decimal_symbol = typeof cellStyle.decimal_symbol !== 'undefined' && cellStyle.decimal_symbol !== false && cell_has_format !== 1 ? cellStyle.decimal_symbol : cellStyle2.decimal_symbol;\n\n        setFormat_for_cells.currency_symbol = typeof cellStyle.currency_symbol !== 'undefined' && cellStyle.currency_symbol !== false && cell_has_format < 2 ? cellStyle.currency_symbol : cellStyle2.currency_symbol;\n        setFormat_for_cells.symbol_position = typeof cellStyle.symbol_position !== 'undefined' && cellStyle.symbol_position !== false && cell_has_format < 2 ? cellStyle.symbol_position : cellStyle2.symbol_position;\n\n        accounting_for_cells = tableFunction.setFormat_accounting_for_cells(setFormat_for_cells);\n        if (typeof setFormat_for_cells.currency_symbol === \"undefined\") {\n            setFormat_for_cells.currency_symbol = false;\n        }\n        createRegExpFormatForCell = tableFunction.createRegExpFormatForCell(setFormat_for_cells.currency_symbol, false, {});\n\n        if (typeof cellStyle.currency_symbol !== 'undefined' && cellStyle.currency_symbol !== '' && cellStyle.symbol_position !== false) {\n            cell_has_format += 2;\n        }\n        if (cell_has_format !== 1 && ((typeof cellStyle.decimal_count !== 'undefined' && cellStyle.decimal_count !== false) || (typeof cellStyle.decimal_symbol !== 'undefined' && cellStyle.decimal_symbol !== false))) {\n            cell_has_format += 1;\n        }\n\n        currency_symbol = new RegExp('[0-9| |\\.|\\,|\\\\-|' + (typeof createRegExpFormatForCell.string_currency_symbols !== 'undefined' ? createRegExpFormatForCell.string_currency_symbols : string_currency_symbols) + ']', \"g\");\n    }\n    return [accounting_for_cells, createRegExpFormatForCell, currency_symbol, setFormat_for_cells, cell_has_format];\n}\n\n// Evaluate formula in cell then set value to td\nfunction evaluateFormulas2 (td, row, col, value, function_data, accounting_for_cells, createRegExpFormatForCell, setFormat_for_cells, cell_has_format, onl_value_cell) {\n    var error = false;\n\n    // var result = regex.exec(value);\n    var result = regex22.exec(value);\n    var valueReturn = 'NaN';\n    var valueNotFormat = 'NaN';\n    var cellStyle;\n    var changeFormatCell = 0;\n    var save_change_format = false;\n\n    if (result !== null) {\n        var style_cell = window.Wptm.style.cells[row + '!' + col];\n        var calculation;\n        calculation = result[1];\n        var check_value_data = true;\n        var update_format_second = cell_has_format;\n        var update_date_formats_momentjs = accounting_for_cells.date_formats_momentjs;\n\n        var check_has_currency_symbol = false;\n        var cell_decimal_symbol = typeof accounting_for_cells.decimal !== 'undefined' ? accounting_for_cells.currency.decimal : window.Wptm.style.table.decimal_symbol;\n        var date_format = typeof createRegExpFormatForCell.date_format !== 'undefined' ? createRegExpFormatForCell.date_format : function_data.date_format;\n\n        var currency_symbol = new RegExp('[0-9| |\\.|\\,|\\\\-|' + (typeof createRegExpFormatForCell.string_currency_symbols !== 'undefined' ? createRegExpFormatForCell.string_currency_symbols : function_data.string_currency_symbols) + ']', \"g\");\n        var cells = result[2].split(\";\");\n        var values = [];\n        //(A1:A2)(A1:A2;A3)(A1;A3)(A1;123)(A1;A2;A3:A4)(A1:A2;123)(123 > A1; A2) MIN|MAX|AVG|CONCAT\n        var ij = 0, i = 0;\n\n        for (ij = 0; ij < cells.length; ij++) {\n            var rCells = [];\n            var datas = '';\n            var data = '';\n\n            var vals = [cells[ij]];\n            // if (cells[ij].indexOf('://') <= 0)//is http://, https://\n                vals = cells[ij].split(\":\")\n\n            if (vals.length === 1 ) {//single cell\n\n                values[ij] = '';\n\n                var checkVal = vals[0].match(regex3);\n                if (checkVal !== null) {\n                    i = 0;\n                    for (i = 0; i < checkVal.length; i++) {\n                        //ex: B1 -> B, 1, B1\n                        rCells = regex2.exec(checkVal[i]);\n                        if (rCells !== null) {\n                            cellStyle = window.Wptm.style.cells[(rCells[2] - 1) + '!' + (tableFunction.convertAlpha(rCells[1].toUpperCase()) - 1)];\n\n                            if (changeFormatCell < 1 && cell_has_format < 3\n                                && typeof cellStyle !== 'undefined' && ((typeof cellStyle[2].decimal_count !== 'undefined' && cellStyle[2].decimal_count !== false)\n                                    || (typeof cellStyle[2].decimal_symbol !== 'undefined' && cellStyle[2].decimal_symbol !== false)\n                                    || (typeof cellStyle[2].currency_symbol !== 'undefined' && cellStyle[2].currency_symbol !== false))\n                            ) {\n                                changeFormatCell = 1;\n                                [accounting_for_cells, createRegExpFormatForCell, currency_symbol, setFormat_for_cells, cell_has_format] = get_format_for_cell(cellStyle[2], setFormat_for_cells, function_data.string_currency_symbols, cell_has_format);\n                                if (typeof style_cell !== \"undefined\") {\n                                    if (update_format_second !== 1) {\n                                        if (style_cell[2].thousand_symbol_second !== (typeof setFormat_for_cells.thousand_symbol !== 'undefined' ? setFormat_for_cells.thousand_symbol : false)) {\n                                            style_cell[2].thousand_symbol_second = typeof setFormat_for_cells.thousand_symbol !== 'undefined' ? setFormat_for_cells.thousand_symbol : false;\n                                            save_change_format = true;\n                                        }\n                                        if (style_cell[2].decimal_count_second !== (typeof setFormat_for_cells.decimal_count !== 'undefined' ? setFormat_for_cells.decimal_count : false)) {\n                                            style_cell[2].decimal_count_second = typeof setFormat_for_cells.decimal_count !== 'undefined' ? setFormat_for_cells.decimal_count : false;\n                                            save_change_format = true;\n                                        }\n                                        if (style_cell[2].decimal_symbol_second !== (typeof setFormat_for_cells.decimal_symbol !== 'undefined' ? setFormat_for_cells.decimal_symbol : false)) {\n                                            style_cell[2].decimal_symbol_second = typeof setFormat_for_cells.decimal_symbol !== 'undefined' ? setFormat_for_cells.decimal_symbol : false;\n                                            save_change_format = true;\n                                        }\n                                    }\n                                    if (update_format_second !== 2) {\n                                        if (style_cell[2].currency_symbol_second !== (typeof setFormat_for_cells.currency_symbol !== 'undefined' ? setFormat_for_cells.currency_symbol : false)) {\n                                            style_cell[2].currency_symbol_second = typeof setFormat_for_cells.currency_symbol !== 'undefined' ? setFormat_for_cells.currency_symbol : false;\n                                            save_change_format = true;\n                                        }\n                                        if (style_cell[2].symbol_position_second !== (typeof setFormat_for_cells.symbol_position !== 'undefined' ? setFormat_for_cells.symbol_position : false)) {\n                                            style_cell[2].symbol_position_second = typeof setFormat_for_cells.symbol_position !== 'undefined' ? setFormat_for_cells.symbol_position : false;\n                                            save_change_format = true;\n                                        }\n                                 \n                                    }\n                                }\n                                cell_decimal_symbol = typeof accounting_for_cells.decimal !== 'undefined' ? accounting_for_cells.currency.decimal : setFormat_for_cells.decimal_symbol;\n                            }\n\n                            data = window.Wptm.container.handsontable('getDataAtCell', rCells[2] - 1, tableFunction.convertAlpha(rCells[1].toUpperCase()) - 1);\n                            if (data !== null && typeof data !== 'undefined') {\n                                if (data[0] === '=') {\n                                    let data2 = render(false, false, rCells[2] - 1, tableFunction.convertAlpha(rCells[1].toUpperCase()) - 1, false, data, 'cellProperties', true)\n                                    data = '' + data2[1]\n                                }\n\n                                check_has_currency_symbol = ((typeof data === 'string' && data.indexOf(function_data.string_currency_symbols) > -1) || check_has_currency_symbol) ? true : false;\n                                if (has_replace.includes(calculation.toUpperCase())) {//replace in some calculation\n                                    if (typeof data === 'string' && data.replace(currency_symbol, \"\") === '') {\n                                        data = accounting.unformat(data, window.Wptm.style.table.decimal_symbol);\n                                    } else {\n                                        data = '';\n                                    }\n                                }\n                                if (i === 0) {\n                                    datas = vals[0].replace(checkVal[i], data);\n                                } else {\n                                    datas = datas.replace(checkVal[i], data);\n                                }\n                            } else {\n                                datas = data = '';\n                            }\n                        } else {\n                            check_value_data = false;\n                        }\n                    }\n                } else {\n                    data = datas = vals[0];\n                }\n                if (datas !== null) {\n                    values[ij] = datas;\n                }\n            } else {\n                if (Not_range_function.includes(calculation.toUpperCase())) {//not set range in some calculation\n                    check_value_data = false;\n                }\n                rCells[0] = regex2.exec(vals[0]);\n                rCells[1] = regex2.exec(vals[1]);\n                if (rCells[0] !== null && rCells[1] !== null) {\n                    cellStyle = window.Wptm.style.cells[(rCells[0][2] - 1) + '!' + (tableFunction.convertAlpha(rCells[0][1]) - 1)];\n                    if (changeFormatCell < 1 && cell_has_format < 3 && typeof cellStyle !== 'undefined'\n                        && ((typeof cellStyle[2].decimal_count !== 'undefined' && cellStyle[2].decimal_count !== false)\n                            || (typeof cellStyle[2].decimal_symbol !== 'undefined' && cellStyle[2].decimal_symbol !== false)\n                            || (typeof cellStyle[2].currency_symbol !== 'undefined' && cellStyle[2].currency_symbol !== false))\n                    ) {\n                        changeFormatCell = 1;\n                        [accounting_for_cells, createRegExpFormatForCell, currency_symbol, setFormat_for_cells, cell_has_format] = get_format_for_cell(cellStyle[2], setFormat_for_cells, function_data.string_currency_symbols, cell_has_format);\n                        if (typeof style_cell !== \"undefined\") {\n                            if (update_format_second !== 1) {\n                                if (style_cell[2].thousand_symbol_second !== (typeof setFormat_for_cells.thousand_symbol !== 'undefined' ? setFormat_for_cells.thousand_symbol : false)) {\n                                    style_cell[2].thousand_symbol_second = typeof setFormat_for_cells.thousand_symbol !== 'undefined' ? setFormat_for_cells.thousand_symbol : false;\n                                    save_change_format = true;\n                                }\n                                if (style_cell[2].decimal_count_second !== (typeof setFormat_for_cells.decimal_count !== 'undefined' ? setFormat_for_cells.decimal_count : false)) {\n                                    style_cell[2].decimal_count_second = typeof setFormat_for_cells.decimal_count !== 'undefined' ? setFormat_for_cells.decimal_count : false;\n                                    save_change_format = true;\n                                }\n                                if (style_cell[2].decimal_symbol_second !== (typeof setFormat_for_cells.decimal_symbol !== 'undefined' ? setFormat_for_cells.decimal_symbol : false)) {\n                                    style_cell[2].decimal_symbol_second = typeof setFormat_for_cells.decimal_symbol !== 'undefined' ? setFormat_for_cells.decimal_symbol : false;\n                                    save_change_format = true;\n                                }\n                            }\n                            if (update_format_second !== 2) {\n                                if (style_cell[2].currency_symbol_second !== (typeof setFormat_for_cells.currency_symbol !== 'undefined' ? setFormat_for_cells.currency_symbol : false)) {\n                                    style_cell[2].currency_symbol_second = typeof setFormat_for_cells.currency_symbol !== 'undefined' ? setFormat_for_cells.currency_symbol : false;\n                                    save_change_format = true;\n                                }\n                                if (style_cell[2].symbol_position_second !== (typeof setFormat_for_cells.symbol_position !== 'undefined' ? setFormat_for_cells.symbol_position : false)) {\n                                    style_cell[2].symbol_position_second = typeof setFormat_for_cells.symbol_position !== 'undefined' ? setFormat_for_cells.symbol_position : false;\n                                    save_change_format = true;\n                                }\n                            }\n                        }\n                        cell_decimal_symbol = typeof accounting_for_cells.decimal !== 'undefined' ? accounting_for_cells.currency.decimal : window.Wptm.style.table.decimal_symbol;\n                    }\n\n                    values[ij] = [];\n                    rCells = window.Wptm.container.handsontable('getData', rCells[0][2] - 1, tableFunction.convertAlpha(rCells[0][1]) - 1, rCells[1][2] - 1, tableFunction.convertAlpha(rCells[1][1]) - 1);\n                    i = 0;\n                    for (i = 0; i < rCells.length; i++) {\n                        if (has_replace.includes(calculation.toUpperCase())) {//replace in some calculation\n                            datas = [];\n\n                            for (var j = 0; j < rCells[i].length; j++) {\n                                check_has_currency_symbol = ((rCells[i][j] !== null && String(rCells[i][j]).indexOf(window.Wptm.style.table.currency_symbol) > -1) || check_has_currency_symbol) ? true : false;\n                                if (rCells[i][j] === null) {\n                                    rCells[i][j] = '';\n                                }\n                                if (String(rCells[i][j]).replace(currency_symbol, \"\") === '') {\n                                    datas[j] = accounting.unformat(String(rCells[i][j]), window.Wptm.style.table.decimal_symbol);\n                                } else {\n                                    datas[j] = '';\n                                }\n                                // datas[j] = accounting.unformat(rCells[i][j], window.Wptm.style.table.decimal_symbol);\n                            }\n                        } else {\n                            datas = rCells[i];\n                        }\n                        if (datas === null) {\n                            values[ij][i] = '';\n                        } else {\n                            values[ij][i] = datas;\n                        }\n                    }\n                } else {\n                    if (tableFunction.convertDate(function_data.date_format, cells[ij].match(/[a-zA-Z0-9|+|-|\\\\]+/g), true) !== false) {\n                        values[ij] = cells[ij];\n                    } else {\n                        check_value_data = false;\n                    }\n                }\n            }\n        }\n\n        //remove format..._second\n        if (changeFormatCell < 1 && cell_has_format < 3 && typeof style_cell !== \"undefined\") {\n            if (typeof style_cell[2].thousand_symbol_second !== 'undefined' && style_cell[2].thousand_symbol_second !== false) {\n                style_cell[2].thousand_symbol_second = false;\n                save_change_format = true;\n            }\n            if (typeof style_cell[2].decimal_count_second !== 'undefined' && style_cell[2].decimal_count_second !== false) {\n                style_cell[2].decimal_count_second = false;\n                save_change_format = true;\n            }\n            if (typeof style_cell[2].decimal_symbol_second !== 'undefined' && style_cell[2].decimal_symbol_second !== false) {\n                style_cell[2].decimal_symbol_second = false;\n                save_change_format = true;\n            }\n            if (typeof style_cell[2].currency_symbol_second !== 'undefined' && style_cell[2].currency_symbol_second !== false) {\n                style_cell[2].currency_symbol_second = false;\n                save_change_format = true;\n            }\n            if (typeof style_cell[2].symbol_position_second !== 'undefined' && style_cell[2].symbol_position_second !== false) {\n                style_cell[2].symbol_position_second = false;\n                save_change_format = true;\n            }\n        }\n        if (save_change_format) {\n            saveData.push({action: 'style', selection: [[row, col, row, col]], style: style_cell[2]});\n        }\n\n        if (check_value_data === true) {\n            switch (calculation.toUpperCase()) {\n                case 'SUM':\n                    valueNotFormat = formulajs.SUM(values);\n                    if (check_has_currency_symbol || cell_has_format > 1) {\n                        valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                    } else {\n                        valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                    }\n                    break;\n                case 'MULTIPLY':\n                    valueNotFormat = 1;\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        if (foo !== false) {\n                            var number = Number(foo);\n                            if (!isNaN(number)) {\n                                valueNotFormat = valueNotFormat * number;\n                            } else {\n                                // check_value_data = false;//comment before =MULTIPLY(SUM(A1;A2;A3);2)\n                            }\n                        }\n                    });\n                    if (!check_value_data) {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                    } else {\n                        if (check_has_currency_symbol || cell_has_format > 1) {\n                            valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                        } else {\n                            valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                        }\n                    }\n                    break;\n                case 'DIVIDE':\n                    valueNotFormat = '';\n                    values = merge_value_from_cells(values);\n\n                    if (values.length !== 2) {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                        check_value_data = false;\n                        break;\n                    }\n\n                    values[1] = Number(values[1]);\n\n                    if (isNaN(values[1]) || values[1] == 0 ||  values[1] == '') {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                        check_value_data = false;\n                        break;\n                    }\n\n                    values[0] = Number(values[0]);\n\n                    if (isNaN(values[0])) {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                        check_value_data = false;\n                        break;\n                    }\n\n                    valueNotFormat = values[0] / values[1];\n\n                    if (!check_value_data) {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                    } else {\n                        if (check_has_currency_symbol || cell_has_format > 1) {\n                            valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                        } else {\n                            valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                        }\n                    }\n                    break;\n                case 'AND':\n                    valueReturn = true;\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        valueReturn = valueReturn && normalizationData(foo, cell_decimal_symbol);\n                    });\n                    valueNotFormat = 'true'\n                    if (!valueReturn) {\n                        valueNotFormat = 'false'\n                    }\n                    break;\n                case 'OR':\n                    valueReturn = false;\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        valueReturn = valueReturn || normalizationData(foo, cell_decimal_symbol);\n                    });\n                    valueNotFormat = 'false'\n                    if (valueReturn) {\n                        valueNotFormat = 'true'\n                    }\n                    break;\n                case 'XOR':\n                    valueReturn = 0;\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        valueReturn += Number(normalizationData(foo, cell_decimal_symbol));\n                    });\n                    valueReturn = ((valueReturn % 2) === 1) ? 'true' : 'false';\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'COUNT':\n                    valueReturn = 0;\n                    var currency_symbol = new RegExp('[ |\\.|\\,|\\\\-|' + window.Wptm.style.table.currency_symbol + ']', \"g\");\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        if (foo !== false) {\n                            if (!isNaN(Number(foo)) && foo !== '') {\n                                valueReturn = valueReturn + 1;\n                            }\n                        }\n                    });\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'DATE':\n                    var data_value = '';\n                    if (values.length > 1) {\n                        data_value = values.join('/');\n                    } else {\n                        data_value = values[0];\n                    }\n\n                    if (typeof data_value !== 'undefined') {\n                        valueReturn = moment(data_value).formatWithJDF(accounting_for_cells.date_formats_momentjs);\n                    } else {\n                        valueReturn = 'NaN';\n                        check_value_data = false;\n                    }\n                    valueNotFormat = valueReturn;\n                    // if (values.length === 1) {\n                    //     values = values[0].match(/[a-zA-Z0-9|+|-|\\\\]+/g);\n                    // }\n                    // //convert values --> (string) date pursuant date_format not have timezone\n                    // var date_string = tableFunction.convertDate(function_data.date_format, values, false);\n                    // date_string = date_string !== false ? new Date(date_string) : check_value_data = false;\n                    //\n                    // //convert values --> (string) date pursuant date_format have timezone\n                    // var date_string_timezone = tableFunction.convertDate(function_data.date_format, values, true);\n                    // date_string_timezone = date_string_timezone !== false ? new Date(date_string_timezone) : check_value_data = false;\n                    // if (date_string_timezone && date_string_timezone.getDate() > 0 && check_value_data !== false) {\n                    //     var format_resultCalc = window.Wptm.style.table.date_formats.split(/[a-zA-Z|\\\\]+/g);\n                    //     var date = [];\n                    //\n                    //     date['month'] = date_string.getMonth();\n                    //     date['date'] = date_string.getDate();\n                    //     date['day'] = date_string.getDay();\n                    //     date['year'] = date_string.getUTCFullYear();\n                    //\n                    //     date['D'] = D_name[date['day']];\n                    //     date['l'] = l_name[date['day']];\n                    //     date['j'] = date['date'];\n                    //     date['d'] = (Number(date['date']) < 10) ? '0' + date['date'] : date['date'];\n                    //     date['F'] = F_name[date['month']];\n                    //     date['M'] = M_name[date['month']];\n                    //     date['n'] = Number(date['month']) + 1;\n                    //     date['m'] = (Number(date['month']) < 10) ? '0' + (Number(date['month']) + 1) : Number(date['month']) + 1;\n                    //     date['Y'] = date['year'];\n                    //     date['y'] = Number(date['year']) % 100;\n                    //\n                    //     valueReturn = format_resultCalc[0];\n                    //     window.jquery.each(function_data.date_format, function (i, v) {\n                    //         if (v.indexOf(\"\\\\\") !== -1 || window.jquery.inArray(v, [\"a\", \"A\", \"g\", \"G\", \"h\", \"H\", \"i\", \"s\", \"T\"]) !== -1) {\n                    //             date[v] = values[i];\n                    //         }\n                    //         valueReturn += date[v] + format_resultCalc[i + 1];\n                    //     });\n                    // } else {\n                    //     valueReturn = 'NaN';\n                    //     check_value_data = false;\n                    // }\n                    break;\n                case 'DAY':\n                    if (typeof values[0] !== 'undefined') {\n                        valueNotFormat = values[0];\n                        valueReturn = formulajs.DAY(values[0]);\n                        valueReturn = moment(values[0], accounting_for_cells.date_formats_momentjs).date();\n                    }\n                    break;\n                case 'DAYS':\n                    if (typeof values[0] !== 'undefined' && typeof values[1] !== 'undefined') {\n                        valueReturn = formulajs.DAYS(values[0], values[1]);\n                    }\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'DAYS360':\n                    valueReturn = 0;\n                    if (check_value_data !== false) {\n                        var month = [];\n                        var year = [];\n                        var days = [];\n                        var date1 = 0;\n                        values.map(function (foo) {\n                            if (foo !== false) {\n                                valueReturn++;\n                                var number = foo.match(/[a-zA-Z0-9|+|-|\\\\]+/g);\n                                var string_day = tableFunction.convertDate(function_data.date_format, number, true);\n                                if (string_day !== false) {\n                                    date1 = new Date(string_day);\n                                    if (!isNaN(date1.getTime())) {\n                                        days[valueReturn] = date1.getDate();\n                                        month[valueReturn] = date1.getMonth();\n                                        year[valueReturn] = date1.getFullYear();\n                                    }\n                                }\n                            }\n                        });\n                        if (year.length > 1) {\n                            if (year[2] < year[1]) {\n                                year[2] = year[1] + year[2];\n                                year[1] = year[2] - year[1];\n                                year[2] = year[2] - year[1];\n                                month[2] = month[1] + month[2];\n                                month[1] = month[2] - month[1];\n                                month[2] = month[2] - month[1];\n                                days[2] = days[1] + days[2];\n                                days[1] = days[2] - days[1];\n                                days[2] = days[2] - days[1];\n                                year[4] = -1;\n                            } else {\n                                year[4] = 1;\n                            }\n                            year[3] = 0;\n\n                            for (i = year[1]; i < year[2]; i++) {\n                                year[3] += 1;\n                            }\n                            days[1] = (days[1] === 31) ? 30 : days[1];\n                            days[2] = (days[2] === 31) ? 30 : days[2];\n                            valueReturn = year[4] * (((year[3] - 1) * 360) + ((13 - month[1]) * 30 - days[1]) + ((month[2] - 1) * 30 + days[2]));\n                            check_value_data = !isNaN(valueReturn);\n                        } else {\n                            valueReturn = 'NaN';\n                            check_value_data = false;\n                        }\n                    } else {\n                        valueReturn = 'NaN';\n                    }\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'MIN':\n                    valueNotFormat = formulajs.MIN(values);\n                    if (check_has_currency_symbol || cell_has_format > 1) {\n                        valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                    } else {\n                        valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                    }\n                    break;\n                case 'MAX':\n                    valueNotFormat = formulajs.MAX(values);\n                    if (check_has_currency_symbol || cell_has_format > 1) {\n                        valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                    } else {\n                        valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                    }\n                    break;\n                case 'AVG':\n                    values = merge_value_from_cells(values);\n                    valueNotFormat = formulajs.SUM(values) / values.length;\n                    if (check_has_currency_symbol || cell_has_format > 1) {\n                        valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                    } else {\n                        valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                    }\n                    break;\n                case 'CONCAT':\n                    valueReturn = '';\n\n                    if (value.search(';') > 0) {\n                        value = value.replaceAll(';', ',')\n                    }\n                    valueReturn = table_function_data.FormulaParser.parse(value.slice(1), {row: 1, col: 1, sheet: 'Sheet1'})\n                    valueNotFormat = valueReturn\n                    break;\n                default:\n                    valueReturn = '';\n\n                    if (value.search(';') > 0) {\n                        value = value.replaceAll(';', ',')\n                    }\n                    try {\n                        valueReturn = table_function_data.FormulaParser.parse(value.slice(1), {row: 1, col: 1, sheet: 'Sheet1'})\n\n                        valueNotFormat = valueReturn\n                    } catch (e) {\n                        valueNotFormat = valueReturn = value\n                    }\n                    break;\n            }\n        }\n        let matchValue = value.match(/(DATE|DAY|DAYS|DAYS360|AND|OR|XOR|SUM|MULTIPLY|DIVIDE|COUNT|MIN|MAX|AVG|CONCAT|date|day|days|days360|and|or|xor|sum|multiply|divide|count|min|max|avg|concat)\\(()/g)\n\n        if (matchValue && matchValue.length > 1) {\n            if (value.search(';') > 0) {\n                // let newRegExp = value.match(/([0-9]+);([0-9]+)/g)\n                // let newRegExp2 = value.match(/([0-9]+);([a-zA-Z]+)([0-9]+)/g)\n                // let newRegExp3 = value.match(/([a-zA-Z]+);([a-zA-Z]+)/g)\n\n                value = value.replaceAll(';', ',')\n            }\n            valueReturn = ''\n\n            value = value.replace('MULTIPLY', 'MMULT')\n\n            // let valueReturn2 = table_function_data.FormulaParser.parse(value.slice(1), {row: 1, col: 1, sheet: 'Sheet' + Wptm.numberSheetCalculation}, true)\n\n            valueReturn = table_function_data.FormulaParser.parse(value.slice(1), {row: 1, col: 1, sheet: 'Sheet' + Wptm.numberSheetCalculation})\n            valueNotFormat = valueReturn\n        }\n    } else {\n        if (value.search(';') > 0) {\n            value = value.replaceAll(';', ',')\n        }\n        try {\n            valueReturn = table_function_data.FormulaParser.parse(value.slice(1), {row: 1, col: 1, sheet: 'Sheet' + Wptm.numberSheetCalculation})\n            valueNotFormat = valueReturn\n            check_value_data = true\n        } catch (e) {\n            valueReturn = ''\n        }\n    }\n    if (check_value_data === true) {\n        if (!onl_value_cell) {\n            window.jquery(td).text(valueReturn);\n        }\n    } else {\n        function_data.check_value_data = check_value_data;\n    }\n    return [valueReturn, valueNotFormat];\n}\n\nfunction normalizationData(values, cell_decimal_symbol) {\n    if (typeof values === 'string') {\n        return values === '' ? values : values === 'true'\n    }\n    if (!values) {\n        return ''\n    }\n\n    return values.map(function (foo) {\n        if (typeof foo === 'object') {\n            return normalizationData(foo, cell_decimal_symbol)\n        } else {\n            foo = parse_boolean_calculation(foo, cell_decimal_symbol)\n\n            if (!isNaN(parseFloat(foo)) && typeof foo !== 'boolean')\n                foo = parseFloat(foo);\n\n            return foo\n        }\n    });\n}\n\nfunction merge_value_from_cells(values) {\n    var value = [];\n\n    values.map(function (foo) {\n        if (foo === null) {\n            foo = '';\n        }\n        if (foo !== false) {\n            if (typeof foo === 'object') {\n                value = value.concat(merge_value_from_cells(foo));\n            } else {\n                value = value.concat([foo]);\n            }\n        }\n    });\n\n    return value;\n}\n\nfunction parse_boolean_calculation(values, decimal_symbol) {\n    var math = values.match(/<=|>=|!=|>|<|=/g);\n    var value = true, value1, value2;\n    if (math !== null) {\n        value1 = values.split(math[0])[0];\n        value2 = values.split(math[0])[1];\n        value1 = accounting.unformat(value1, decimal_symbol);\n        value2 = accounting.unformat(value2, decimal_symbol);\n        switch (math[0]) {\n            case '<=':\n                value = Number(value1) <= Number(value2);\n                break;\n            case '>=':\n                value = Number(value1) >= Number(value2);\n                break;\n            case '=':\n                value = Number(value1) === Number(value2);\n                break;\n            case '!=':\n                value = Number(value1) !== Number(value2);\n                break;\n            case '<':\n                value = Number(value1) < Number(value2);\n                break;\n            case '>':\n                value = Number(value1) > Number(value2);\n                break;\n        }\n    } else {\n        value = values === 'true' ? true : (values === 'false' ? false : values);\n    }\n    return value;\n}\n\nexport default {\n    render,\n    evaluateFormulas2,\n}\n","import alternating from \"./_alternating\"\nimport wptmPreview from \"./_wptm\";\nimport {initHandsontable} from \"./_initHandsontable\";\nimport selectOption from \"./_toolbarOptions\"\n\nvar F_name = [\"january\", \"february\", \"march\", \"april\", \"may\", \"june\", \"july\", \"august\", \"september\", \"october\", \"november\", \"december\"];\nvar M_name = [\"jan\", \"feb\", \"mar\", \"apr\", \"may\", \"jun\", \"jul\", \"aug\", \"sept\", \"oct\", \"nov\", \"dec\"];\nvar l_name = [\"sunday\", \"monday\", \"tuesday\", \"wednesday\", \"thursday\", \"friday\", \"saturday\"];\nvar D_name = [\"sun\", \"mon\", \"tue\", \"wed\", \"thu\", \"fri\", \"sat\"];\nvar regex = new RegExp('^=(DATE|DAY|DAYS|DAYS360|AND|OR|XOR|SUM|MULTIPLY|DIVIDE|COUNT|MIN|MAX|AVG|CONCAT|date|day|days|days360|and|or|xor|sum|multiply|divide|count|min|max|avg|concat)\\\\((.*?)\\\\)$');\n\n/*var x2 = (xx) => {return new Promise ((resolve) => {\n    setTimeout(() => {\n        dd = dd + 1000\n        xx = xx + 10\n        console.log(dd + ' x2: ' + xx)\n        resolve(xx)\n    }, 1000)\n})}*/\nasync function eventToCellsSelected(selection, selectionSize, fCallBackCells, fCallBackRow, fCallBackCol, afterLoopCallBack) {\n    if (selection === null) {\n        selection = selectOption.getSelector()\n    }\n\n    let length = selectionSize !== null ? selectionSize : _.size(selection)\n    let returnVal = true;\n    // console.log(selectionSize, fCallBackCells, fCallBackRow, fCallBackCol, afterLoopCallBack)\n    for (let i = 0; i < length; i++) {\n        if (selection[i] !== null) {\n            if (typeof fCallBackRow !== 'undefined' && fCallBackRow !== null) {\n                let fCallBackRowCall = (ranger) => {\n                    return new Promise((resolve) => {\n                        for (let i2 = ranger[0]; i2 <= ranger[2]; i2++) {\n                            returnVal = fCallBackRow(ranger, i2)\n                            if (i2 === ranger[2] && returnVal) {\n                                resolve(true)\n                            }\n                        }\n                    })\n                }\n                try {\n                    returnVal = await fCallBackRowCall(selection[i]);\n                } catch (err) {\n                    console.log(err);\n                }\n            }\n\n            if (typeof fCallBackCol !== 'undefined' && fCallBackCol !== null) {\n                let fCallBackColCall = (ranger) => {\n                    return new Promise((resolve) => {\n                        for (let i2 = ranger[1]; i2 <= ranger[3]; i2++) {\n                            returnVal = fCallBackCol(ranger, i2)\n                            if (i2 === ranger[3] && returnVal) {\n                                resolve(true)\n                            }\n                        }\n                    })\n                }\n                try {\n                    returnVal = await fCallBackColCall(selection[i]);\n                } catch (err) {\n                    console.log(err);\n                }\n            }\n\n            if (typeof fCallBackCells !== 'undefined' && fCallBackCells !== null) {\n                try {\n                    returnVal = await fCallBackCells(selection[i], i)\n                } catch (err) {\n                    console.log(err);\n                }\n            }\n        }\n    }\n    if (typeof afterLoopCallBack !== 'undefined' && afterLoopCallBack !== null) {\n        try {\n            returnVal = await afterLoopCallBack(selection)\n        } catch (e) {\n            console.log(e)\n        }\n    }\n\n    return returnVal\n}\n\n// set value for an html switch-button element from Style object\nfunction updateSwitchButtonFromStyleObject(styleObj, prop, that, defaultValue, callback, changeCallBack) {\n    if (prop === null) {\n        defaultValue = styleObj;\n    } else {\n        if (checkObjPropertyNested(styleObj, prop)) {\n            defaultValue = styleObj[prop];\n        }\n    }\n\n    that.val(defaultValue == 1 ? 'yes' : 'no').prop(\"checked\", defaultValue == 1);\n\n    if (typeof callback !== 'undefined' && callback !== null) {\n        that.on('click', () => {changeCallBack.call(that)})\n    }\n    if (typeof callback !== 'undefined' && callback !== null) {\n        callback.call(that, defaultValue);\n    }\n}\n\n// set value for an html input element from cellStyle object\nfunction updateParamFromStyleObject(styleObj, prop, that, defaultValue, callback) {\n    if (checkObjPropertyNested(styleObj, prop)) {\n        if (styleObj[prop] === false) {\n            that.val('');\n        } else {\n            that.val(styleObj[prop]);\n        }\n    } else {\n        that.val(defaultValue);\n    }\n    if (typeof callback !== 'undefined' && callback !== null) {\n        callback.call(that);\n    }\n}\n\n// set value for an html input element from cellStyle object\nfunction updateParamFromStyleObjectSelectBox(styleObj, prop, that, defaultValue, callback, multiple_select) {\n    if (styleObj !== '') {\n        if (checkObjPropertyNested(styleObj, prop)) {\n            defaultValue = styleObj[prop];\n        }\n    }\n    that.data('value', defaultValue);\n\n    var text = '';\n    if (multiple_select) {\n        jquery.each(defaultValue.split('|'), function (i, v) {\n            if (text !== '') {\n                text += ',' + that.find('li[data-value=\"' + v + '\"]').text();\n            } else {\n                text += that.find('li[data-value=\"' + v + '\"]').text();\n            }\n        })\n    } else {\n        if (that.find('li[data-value=\"' + defaultValue + '\"]').length > 0) {\n            text += that.find('li[data-value=\"' + defaultValue + '\"]').text();\n        }\n    }\n\n    that.prev('.wptm_select_box_before').text(text === '' ? (defaultValue === false ? '' : defaultValue) : text).data('value', defaultValue);\n\n    if (typeof callback !== 'undefined' && callback !== null) {\n        callback.call(that);\n    }\n}\n\nfunction combineChangedCellIntoRow(extendData) {\n    if (changedData.length < 1) {\n        changedData = [{row: extendData.row, cell: [{col: extendData.col, content: extendData.content}]}];\n    } else {\n        var newRow = true;\n        for (var i = 0; i < changedData.length; i++) {\n            var rowData = changedData[i];\n            if (rowData.row === extendData.row) {\n                var newCell = true;\n                for (var j = 0; j < rowData.cell.length; j++) {\n                    var cellData = rowData.cell[j];\n                    if (cellData.col === extendData.col) {\n                        cellData.content = extendData.content;\n                        newCell = false;\n                        break;\n                    }\n                }\n                if (newCell) {\n                    rowData.cell.push({col: extendData.col, content: extendData.content});\n                }\n                newRow = false;\n                break;\n            }\n        }\n        if (newRow) {\n            changedData.push({row: extendData.row, cell: [{col: extendData.col, content: extendData.content}]});\n        }\n    }\n}\n\n// check for existence of nested object key\n// example: var test = {level1:{level2:{level3:'level3'}} };\n// checkObjPropertyNested(test, 'level1', 'level2', 'level3'); // true\nfunction checkObjPropertyNested(obj /*, level1, level2, ... levelN*/) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    for (var i = 0; i < args.length; i++) {\n        if (!obj || !obj.hasOwnProperty(args[i])) {\n            return false;\n        }\n        obj = obj[args[i]];\n    }\n    return true;\n}\n\n// check for existence of nested object key and check value not empty\n// example: var test = {level1:{level2:{level3:'level3'}} };\n// checkObjPropertyNestedNotEmpty(test, 'level1', 'level2', 'level3'); // true\nfunction checkObjPropertyNestedNotEmpty(obj /*, level1, level2, ... levelN*/) {\n    var args = Array.prototype.slice.call(arguments, 1);\n\n    for (var i = 0; i < args.length; i++) {\n        if (!obj || !obj.hasOwnProperty(args[i]) || !obj[args[i]]) {\n            return false;\n        }\n        obj = obj[args[i]];\n    }\n    return true;\n}\n\n/**\n * calculater height for table when change height row\n *\n * @param topElement\n * @returns {number}\n */\nfunction calculateTableHeight(topElement) {\n    var top = topElement.outerHeight() + 33, paddingBottom;\n    if (canInsert == 1) {\n        paddingBottom = 30; //px\n    } else {\n        paddingBottom = 10; //px\n    }\n\n    var windownHeight = jquery(window).height();\n    var height = windownHeight - top - paddingBottom;\n    return height;\n}\n\n//convert aphabel to number when get col number\nfunction convertStringToNumber(val) {\n    var base = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', i, j, result = 0;\n\n    for (i = 0, j = val.length - 1; i < val.length; i += 1, j -= 1) {\n        result += Math.pow(base.length, j) * (base.indexOf(val[i]) + 1);\n    }\n\n    return result;\n}\n\n/*print getSelect cell to element*/\nfunction getSelectedVal(dataSelect, selectRange) {\n    var valueRange = '';\n\n    if (dataSelect[1] > 25) {\n        valueRange += String.fromCharCode(97) + String.fromCharCode(97 + dataSelect[1] - 26);\n    } else {\n        if (dataSelect[1] !== false) {\n            valueRange += String.fromCharCode(97 + dataSelect[1]);\n        }\n    }\n    if (dataSelect[0] !== false && dataSelect[0] !== null) {\n        valueRange += dataSelect[0] + 1;\n    }\n\n    valueRange += ':';\n\n\n    if (dataSelect[3] > 25) {\n        valueRange += String.fromCharCode(97) + String.fromCharCode(97 + dataSelect[3] - 26);\n    } else {\n        if (dataSelect[3] !== false) {\n            valueRange += String.fromCharCode(97 + dataSelect[3]);\n        }\n    }\n    if (dataSelect[2] !== false) {\n        valueRange += dataSelect[2] + 1;\n    }\n    if (typeof selectRange !== 'undefined' && dataSelect[0] !== null) {\n        selectRange.val(valueRange);\n    } else {\n        return valueRange;\n    }\n}\n\nfunction warning_edit_db_table(field, value) {\n    var edit = wptmText.warning_edit_db_table.replace('FIELD_JOOMUNITED', field).replace('FIELD_JOOMUNITED_VALUE', value);\n    wptmBootbox('', edit, true, true, () => {\n        saveData = saveData.concat(Wptm.saveDataDbTable);\n        wptm_element.mainTabContent.addClass('loading_ajax');\n        saveChanges(true);\n    }, () => {\n        Wptm.saveDataDbTable = [];\n    });\n}\n\n/*time out auto save*/\nvar autosaveNotification;\nvar getSaveAjax;\n\nfunction cleanHandsontable() {\n    wptm_element.primary_toolbars.find('#undo_cell').removeClass('active').addClass('no_active');\n    wptm_element.primary_toolbars.find('#redo_cell').removeClass('active').addClass('no_active');\n    setTimeout(function () {\n        jquery(Wptm.container).handsontable('getInstance').undoRedo.clear();\n    }, 500);\n}\n\n/*saving table*/\nfunction saveChanges(autosave, ajaxCallback) {\n    var $ = window.jquery;\n    Wptm.saveDataDbTable = [];\n    if (!(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n        return;\n    }\n    //check save calculate date\n    if (window.table_function_data.check_value_data === false) {\n        setTimeout(function () {\n            $('#saveErrorTable').animate({'top': '+=75px', 'opacity': '1'}, 500).delay(2000).animate({\n                'top': '-=75px',\n                'opacity': '0'\n            }, 1000);\n        }, 1000);\n        window.table_function_data.check_value_data = true;\n        return;\n    }\n\n    if ((typeof autosave == 'undefined' && !enable_autosave) || autosave === false) {\n        checkTimeOut = false;\n        return;\n    }\n    if (!checkTimeOut) {\n        clearTimeout(getSaveAjax);\n    }\n\n    checkTimeOut = false;\n\n    var delay_time = enable_autosave ? 5000 : 0;\n\n    if (autosave === true) {\n        delay_time = 700;//fix async when copy, paste, create row/col\n    }\n\n    getSaveAjax = setTimeout(function () {\n        /*check have the change Alternate*/\n        if (_.size(window.table_function_data.checkChangeAlternate) > 0) {\n            window.Wptm.style.cells = $.extend({}, alternating.reAlternateColor());\n        }\n\n        //fix style.cols length\n        var cols_length = droptablesCheckSize(window.Wptm.style.cols)\n        if (cols_length > window.Wptm.max_Col) {\n            var newCols = {}\n            for (var ii = 0; ii < window.Wptm.max_Col; ii++) {\n                newCols[ii] = window.Wptm.style.cols[ii];\n\n                if (window.Wptm.max_Col === ii + 1) {\n                    window.Wptm.style.cols = $.extend({}, newCols);\n                }\n            }\n        }\n        var save_data;\n        if (window.Wptm.mergeCellsSetting.length > 0) {//update header option by merger cells\n            var i;\n            var maxHeader = window.Wptm.headerOption;\n            for (i = 0; i < window.Wptm.mergeCellsSetting.length; i++) {\n                var mergeSetting = window.Wptm.mergeCellsSetting[i];\n                maxHeader = (mergeSetting.row < maxHeader && mergeSetting.row + mergeSetting.rowspan > maxHeader) ? mergeSetting.row + mergeSetting.rowspan : maxHeader;\n            }\n\n            if (maxHeader > window.Wptm.headerOption) {\n                saveData.push({\n                    action: 'set_header_option',\n                    value: maxHeader\n                });\n                window.Wptm.headerOption = maxHeader;\n\n                if (Wptm.style.table.freeze_row > 0) {\n                    $(Wptm.container).handsontable('updateSettings', {fixedRowsTop: maxHeader});\n                }\n            }\n        }\n\n        if (typeof table_function_data.colsSetType !== 'undefined') {\n            saveData.push({\n                action: 'set_columns_types',\n                value: table_function_data.colsSetType\n            });\n            delete table_function_data.colsSetType;\n        }\n\n        if (table_function_data.save_table_params.length > 0) {\n            save_data = JSON.stringify(table_function_data.save_table_params);\n        } else {\n            if (typeof table_function_data.create_col_after_paste !== 'undefined' && table_function_data.create_col_after_paste.length > 0) {\n                saveData = table_function_data.create_col_after_paste.concat(saveData)\n                table_function_data.create_col_after_paste = []\n            }\n            if (saveData.length < 1) {//create empty data to update other table params\n                saveData.push({\n                    action: 'empty_data',\n                    value: ''\n                });\n            }\n            save_data = JSON.stringify(saveData);\n        }\n        var Wptm_hyperlink = {};\n        if (typeof Wptm.hyperlink !== 'undefined') {\n            Wptm_hyperlink = $.extend({}, {}, Wptm.hyperlink);\n            $.each(Wptm.hyperlink, function (i, v) {\n                Wptm_hyperlink[i] = {};\n                Wptm_hyperlink[i].hyperlink = v.hyperlink;\n                Wptm_hyperlink[i].text = typeof v.text !== 'undefined' ? v.text : '';\n                if (typeof v.text !== 'undefined' && v.text.indexOf('\\\"') > -1) {\n                    Wptm_hyperlink[i].text = v.text.replaceAll('\\\"', '\\\\\"');\n                }\n            })\n        } else {\n            Wptm_hyperlink = {};\n        }\n        var reverseString = (v) => {\n            return v.split('').reverse().join('')\n        }\n\n        //avoid Firewall error (column type name)\n        var styleTableSaving = $.extend({}, {}, window.Wptm.style.table)\n        if (typeof styleTableSaving.col_types !== 'undefined' && styleTableSaving.col_types) {\n            $.each(styleTableSaving.col_types, (i, v) => {\n                styleTableSaving.col_types[i] = typeof v === 'string' ? reverseString(v) : v\n            })\n        }\n\n        var jsonVar = {\n            option_nonce: $('#option_nonce').val(),\n            css: window.Wptm.css,\n            mergeSetting: JSON.stringify(window.Wptm.mergeCellsSetting),\n            count: JSON.stringify({\n                'countRows': $(window.Wptm.container).handsontable('countRows'),\n                countCols: $(window.Wptm.container).handsontable('countCols')\n            }),\n            style: JSON.stringify({\n                'table': styleTableSaving,\n                'cols': window.Wptm.style.cols,\n                'rows': window.Wptm.style.rows\n            }),\n            reverseValue: JSON.stringify({'table': 'col_types'}),\n            save_data: save_data,\n            id: window.Wptm.id\n        };\n\n        if (window.Wptm.type !== 'html')\n            jsonVar.headerOption = 1;\n        else\n            jsonVar.hyperlink = JSON.stringify(Wptm_hyperlink);\n        jsonVar.headerOption = window.Wptm.headerOption;\n\n        if (typeof window.Wptm.syn_hash !== 'undefined' && window.Wptm.syn_hash !== '') {\n            jsonVar.syn_hash = window.Wptm.syn_hash;\n        }\n\n        window.Wptm.style = cleanStyle(window.Wptm.style, $(window.Wptm.container).handsontable('countRows'), $(window.Wptm.container).handsontable('countCols'));\n        var old_slection = window.table_function_data.selection;\n\n        $.ajax({\n            url: wptm_ajaxurl + \"task=table.save\",\n            dataType: \"json\",\n            traditional: true,\n            type: \"POST\",\n            data: $.param(jsonVar),\n            beforeSend: function () {\n                wptm_element.settingTable.find('.wptm_save_error').addClass('wptm_hiden');\n                wptm_element.settingTable.find('.wptm_saving').html('<span>' + wptmText.SAVING + '</span>');\n                wptm_element.settingTable.find('.wptm_saving').removeClass('wptm_hiden');\n                window.table_function_data.firstRender = false;\n            },\n            success: function (datas) {\n                if (datas.response === true) {\n                    wptm_element.settingTable.find('.wptm_save_error').addClass('wptm_hiden');\n                    wptm_element.settingTable.find('.wptm_saving').html('<span>' + wptmText.ALL_CHANGES_SAVED + '</span>');\n\n                    //empty data in saveData\n                    if (table_function_data.save_table_params.length > 0) {\n                        table_function_data.save_table_params = [];\n                    } else {\n                        saveData = [];\n                    }\n\n                    update_after_save(datas.datas, old_slection);\n                    if (typeof ajaxCallback !== 'undefined' && ajaxCallback === 'render') {\n                        setTimeout(function () {\n                            window.jquery(wptm_element.tableContainer).handsontable('render');\n                        }, 500);\n                    }\n\n                    setTimeout(function () {\n                        wptm_element.settingTable.find('.wptm_saving').addClass('wptm_hiden');\n                    }, 1500);\n                } else {\n                    wptmBootbox('', datas.response, true, false);\n                }\n                if (typeof ajaxCallback == 'function') {\n                    ajaxCallback(window.Wptm.id)\n                }\n                window.table_function_data.firstRender = true;\n                $('.prevent_event_popup').hide();\n            },\n            error: function (jqxhr, textStatus, error) {\n                $('.prevent_event_popup').hide();\n                wptmBootbox('', textStatus + \" : \" + error, true, false);\n            }\n        });\n        checkTimeOut = true;\n    }, delay_time);\n}\n\n/**\n * Update some value in Wptm after saving ajax\n * @param datas\n * @param old_slection\n */\nfunction update_after_save(datas, old_slection) {\n    if (typeof datas.type !== 'undefined') {\n        jquery.each(datas.type, function (i, value) {\n            switch (i) {\n                case \"reload_table\":\n                    updateDataAndParamsTable();\n                    break;\n                case \"set_columns_types\":\n                    var selected = [];\n\n                    jquery.each(old_slection, function (i, v) {\n                        selected[i] = [v[0], v[1], v[2], v[3]];\n                        if (typeof Wptm.headerOption !== 'undefined') {\n                            if (v[0] < parseInt(Wptm.headerOption)) {\n                                selected[i][0] = parseInt(Wptm.headerOption);\n                            }\n                        }\n                    });\n\n                    change_value_cells(selected, value, 'col%key');\n                    break;\n                case \"update_params\":\n                    var params = jquery.parseJSON(value);\n                    if (typeof params.headerOption !== 'undefined') {\n                        Wptm.headerOption = parseInt(params.headerOption);\n                    } else {\n                        Wptm.headerOption = 1;\n                    }\n                    try {\n                        Wptm.mergeCellsSetting = jquery.parseJSON(params.mergeSetting);\n                        if (Wptm.mergeCellsSetting == null) {\n                            Wptm.mergeCellsSetting = [];\n                        }\n                    } catch (e) {\n                        Wptm.mergeCellsSetting = [];\n                    }\n\n                    //not update header_data, it was updated\n                    if (typeof params.header_data !== 'undefined') {\n                        var old_header_data = Wptm.style.table.header_data;\n                        delete params.header_data;\n                    }\n                    params.hyperlink = params.hyperlink.replaceAll('\\\\\\\\\\\\\"', '\\\\\"');\n                    Wptm.hyperlink = jquery.parseJSON(params.hyperlink);\n                    window.Wptm.style.table = jquery.extend({}, params);\n                    window.Wptm.style.table.header_data = old_header_data;\n                    break;\n            }\n        });\n\n        if (typeof table_function_data.fetch_data !== 'undefined') {\n            wptmPreview.fetchSpreadsheet(table_function_data.fetch_data);\n        }\n    }\n}\n\n/**\n * convert cell data by column type\n *\n * @param position cell position\n * @param value    New value\n * @returns {string|boolean}\n */\nfunction cell_type_to_column(position, value) {\n    if ((Wptm.type !== 'mysql' && typeof Wptm.style.table.col_types[position[1]] !== 'undefined')\n        || (typeof Wptm.query_option !== 'undefined' && typeof Wptm.query_option.column_options !== 'undefined' && typeof Wptm.query_option.column_options[position[1]] !== 'undefined')) {\n        if (value === null) {\n            value = '';\n        }\n        var type_column;\n        if (Wptm.type === 'mysql' && typeof Wptm.query_option.column_options !== 'undefined' && typeof Wptm.query_option.column_options[position[1]] !== 'undefined') {\n            type_column = Wptm.query_option.column_options[position[1]].Type;\n        } else {\n            type_column = Wptm.style.table.col_types[position[1]];\n        }\n        var data = validate_type_cell(type_column, value);\n        return data;\n    }\n    return true;\n}\n\nfunction deleteRowDbTable(table, field, id_row) {\n    var url = wptm_ajaxurl + \"task=table.deleteRowDbTable\";\n    wptm_element.mainTabContent.addClass('loading_ajax');\n\n    jquery.ajax({\n        url: url,\n        data: {\n            id_table: Wptm.id,\n            value: id_row,\n            field: field,\n            table: table\n        },\n        type: 'POST',\n        success: function (datas) {\n            updateDataAndParamsTable();\n        },\n        error: function (jqxhr, textStatus, error) {\n            wptmBootbox('', textStatus + \" : \" + error, true, false);\n        }\n    })\n}\n\nfunction createRowDbTable(dbtable, list_value) {\n    var url = wptm_ajaxurl + \"task=table.createRowDbTable\";\n    wptm_element.mainTabContent.addClass('loading_ajax');\n    jquery.ajax({\n        url: url,\n        data: {\n            id: Wptm.id,\n            data: list_value,\n            dbtable: dbtable\n        },\n        type: 'POST',\n        success: function (datas) {\n            updateDataAndParamsTable();\n        },\n        error: function (jqxhr, textStatus, error) {\n            wptmBootbox('', textStatus + \" : \" + error, true, false);\n        }\n    })\n}\n\nfunction validate_type_cell(type_column, value) {\n    var date_string;\n    var length = value.length;\n\n    var result = regex.exec(value);\n\n    switch (type_column.toUpperCase()) {\n        case 'INT':\n            if (value === '') {\n                value = '0';\n            }\n\n            if (result === null) {\n                if (value.replace(/[ |0-9]+/g, '') !== '') {\n                    return false;\n                }\n                if (parseInt(value) < -2147483648 && parseInt(value) > 2147483647) {\n                    return false;\n                }\n            }\n            break;\n        case 'SMALLINT':\n            if (value === '') {\n                value = '0';\n            }\n\n            if (result === null) {\n                if (value.replace(/[ |0-9]+/g, '') !== '') {\n                    return false;\n                }\n                if (parseInt(value) < -32768 && parseInt(value) > 32767) {\n                    return false;\n                }\n            }\n            break;\n        case 'TINYINT':\n            if (value === '') {\n                value = '0';\n            }\n\n            if (result === null) {\n                if (value.replace(/[ |0-9]+/g, '') !== '') {\n                    return false;\n                }\n                if (parseInt(value) < -128 && parseInt(value) > 127) {\n                    return false;\n                }\n            }\n            break;\n        case 'MEDIUMINT':\n            if (value === '') {\n                value = '0';\n            }\n            if (result === null) {\n                if (value.replace(/[ |0-9]+/g, '') !== '') {\n                    return false;\n                }\n                if (parseInt(value) < -8368608 && parseInt(value) > 8368607) {\n                    return false;\n                }\n            }\n            break;\n        case 'bigint unsigned':\n            if (value === '') {\n                value = '0';\n            }\n            if (value.replace(/[ |0-9]+/g, '') !== '') {\n                return false;\n            }\n            break;\n        case 'DECIMAL(16,4)':\n            if (value === '') {\n                value = '0';\n            }\n            if (value.replace(/[ |0-9|.]+/g, '') !== '') {\n                return false;\n            }\n            break;\n        case 'DATE':\n            if (value !== '') {\n                date_string = convertDate([\"Y\", \"m\", \"d\"], value.match(/[a-zA-Z0-9|+|-|\\\\]+/g), true);\n                if (date_string === false) {\n                    return false;\n                }\n                if (date_string === '00-00-0000') {\n                    return '0000-00-00';\n                }\n                var date_string1 = new Date(date_string);\n                if (isNaN(date_string1.getTime())) {\n                    return false;\n                }\n                return date_string1.getFullYear() + '-' + ((date_string1.getMonth() < 10) ? '0' + (date_string1.getMonth() + 1) : date_string1.getMonth() + 1) + '-' + date_string1.getDate();\n            } else {\n                return '0000-00-00';\n            }\n            break;\n        case 'DATETIME':\n            if (value !== '') {\n                date_string = convertDate([\"Y\", \"m\", \"d\", \"h\", \"i\", \"s\"], value.match(/[a-zA-Z0-9|+|-|\\\\]+/g), true);\n                if (date_string === false) {\n                    return false;\n                }\n                if (date_string === '00/00/0000 0:00:00 ') {\n                    return '0000-00-00 00:00:00';\n                }\n                date_string = new Date(date_string);\n                if (isNaN(date_string.getTime())) {\n                    return false;\n                }\n                return date_string.getFullYear() + '-' + ((date_string.getMonth() < 10) ? '0' + (date_string.getMonth() + 1) : date_string.getMonth() + 1) + '-' + date_string.getDate() + ' ' + date_string.getHours() + ':' + date_string.getMinutes() + ':' + date_string.getSeconds();\n            } else {\n                return '0000-00-00 00:00:00';\n            }\n            break;\n        case 'TIME':\n            if (value !== '') {\n                date_string = convertDate([\"H\", \"m\", \"S\"], value.match(/[a-zA-Z0-9|+|-|\\\\]+/g), true);\n                if (date_string === false) {\n                    return false;\n                }\n                if (date_string === '00-00-00 ') {\n                    return '00:00:00';\n                }\n                date_string = new Date(date_string);\n                if (isNaN(date_string.getTime())) {\n                    return false;\n                }\n                return date_string.getHours() + ':' + date_string.getMinutes() + ':' + date_string.getSeconds();\n            } else {\n                return '00:00:00';\n            }\n            break;\n        case 'TIMESTAMP':\n            if (value !== '') {\n                if (isNaN(value) || parseInt(value) < 0) {\n                    return false;\n                }\n                date_string = (new Date(value)).getTime() > 0;\n\n                if (date_string === false) {\n                    return false;\n                }\n\n                return value;\n            }\n            break;\n\n        case 'VARCHAR':\n            if (length > 255) {\n                return false;\n            }\n            break;\n        case 'TEXT':\n            if (length > 65500) {\n                return false;\n            }\n            break;\n        case 'LONGTEXT':\n            if (length > 4294967294) {\n                return false;\n            }\n            break;\n        case 'MEDIUMTEXT':\n            if (length > 16777214) {\n                return false;\n            }\n            break;\n        case 'CHAR':\n            if (length > 255) {\n                return false;\n            }\n            break;\n        case 'FLOAT':\n            if (value === '') {\n                value = '0';\n            }\n            if (result === null) {\n                if (isNaN(parseFloat(value))) {\n                    return false;\n                }\n            }\n            break;\n        default:\n            return value;\n            break;\n    }\n    return value;\n}\n\nfunction updateDataAndParamsTable() {\n    var url = wptm_ajaxurl + \"view=table&format=json&id=\" + Wptm.id;\n    var $ = jquery;\n    $.ajax({\n        url: url,\n        type: \"POST\",\n        data: {},\n        dataType: \"json\",\n    }).done(function (data) {\n        if (data.datas === '' || data.datas === false) {\n            delete Wptm.datas;\n            Wptm.datas = [\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n            ];\n        } else {\n            data.datas = JSON.stringify(data.datas);\n            try {\n                Wptm.datas = JSON.parse(data.datas);\n            } catch (err) {\n                Wptm.datas = [\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n                ];\n            }\n        }\n\n        Wptm.style = $.parseJSON(data.style);\n        if (data.params === \"\" || data.params === null || data.params.length == 0) {\n            Wptm.mergeCellsSetting = [];\n            Wptm.headerOption = 1;\n        } else {\n            if (typeof (data.params) == 'string') {\n                data.params = $.parseJSON(data.params);\n            }\n\n            if (typeof data.params.headerOption !== 'undefined') {\n                Wptm.headerOption = parseInt(data.params.headerOption);\n            } else {\n                Wptm.headerOption = 1;\n            }\n            if (Wptm.headerOption > 0 && (typeof Wptm.style.table.header_data === 'undefined' || Wptm.style.table.header_data.length < Wptm.headerOption)) {\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n            window.jquery(window.Wptm.container).data('handsontable').loadData(Wptm.datas);\n        }\n        wptm_element.mainTabContent.removeClass('loading_ajax');\n    })\n    return false;\n}\n\n/**\n * change cells value when add function in toolbar\n *\n * @param selection\n * @param values\n * @param keyColum\n * @param afterLoopCallBack\n */\nfunction change_value_cells(selection, values, keyColum, afterLoopCallBack) {\n    table_function_data.data_argument = [];\n    if (selection === null) {\n        selection = window.jquery.extend([], [], table_function_data.selection);\n    }\n\n    var cellProperties;\n\n    eventToCellsSelected(\n        selection,\n        table_function_data.selectionSize,\n        null,\n        (ranger, i) => {\n            for (let j = ranger[1]; j <= ranger[3]; j++) {\n                cellProperties = check_cell_readOnly(i, j, true)\n                if (typeof cellProperties.readOnly == \"undefined\" || cellProperties.readOnly !== true) {\n                    let value\n                    if (Array.isArray(values)) {\n                        value = !keyColum ? values[i]['col0'] : values[i][keyColum.replace('%key', j)];//default col 0\n                        table_function_data.data_argument.push([i, j, value, 'wptm_change_value_after_set_columns_types']);\n                    } else {\n                        value = values;\n                        table_function_data.data_argument.push([i, j, value]);\n                    }\n                    Wptm.datas[i][j] = value;\n                }\n                if (j === ranger[3]) {\n                    return true\n                }\n            }\n        },\n        null,\n        (ranger) => {\n            const promise1 = new Promise((resolve) => {\n                if (table_function_data.changeTheme) {\n                    wptmPreview.updatepreview(Wptm.id);\n                }\n\n                if (table_function_data.data_argument.length < 5) {//if cells number < 5 then setDataAtCell() is more performance\n                    window.jquery(window.Wptm.container).data('handsontable').setDataAtCell(table_function_data.data_argument, 'setDataAtCell');\n                } else {\n                    window.jquery(window.Wptm.container).data('handsontable').loadData(Wptm.datas);\n                }\n\n                resolve(true)\n            })\n            promise1\n            if (typeof afterLoopCallBack !== 'undefined' && afterLoopCallBack !== null) {\n                afterLoopCallBack.call()\n            }\n        }\n    )\n}\n\n//function in table DB\nfunction loadTableContructor() {\n    var $ = window.jquery;\n    var id_table = $('li.wptmtable.active').data('id-table');\n    var table_type = $('li.wptmtable.active').data('table-type');\n    var $mainTable = $(\"#mainTable\");\n    $mainTable.find(\".tabDataSource\").hide();\n    $mainTable.find(\".groupTable\" + id_table).show();\n    if (table_type == 'mysql') {\n        if ($(\"#tabDataSource_\" + id_table).length == 0) {\n            var firstTab = $mainTable.find('li').get(0);\n            $(firstTab).after('<li><a data-toggle=\"tab\" id=\"tabDataSource_' + id_table + '\" class=\"tabDataSource groupTable' + id_table + '\" href=\"#dataSource_' + id_table + '\">Data Source</a></li>');\n            $('#mainTabContent.tab-content').append('<div class=\"db_table tab-pane\" id=\"dataSource_' + id_table + '\">' +\n                '<div class=\"dataSourceContainer\" style=\"padding-top:10px\" ></div></div>');\n\n            $.ajax({\n                url: wptm_ajaxurl + \"view=dbtable&id_table=\" + id_table,\n                type: \"GET\"\n            }).done(function (data) {\n                $(\"#dataSource_\" + id_table).html(data);\n            });\n        }\n    }\n    //do nothing\n}\n\n// Build column selection for default sort parameter\nfunction default_sortable(tableData) {\n    var $ = window.jquery;\n    if (tableData && typeof tableData[0] !== 'undefined') {\n        var $jform_default_sortable = $('#content_popup_hide').find('.select_columns');\n        var $jform_reponsive_table = $('#content_popup_hide').find('#responsive_table table tbody');\n        var $jform_column_type_table = $('#content_popup_hide').find('#column_type_table table tbody');\n        $jform_default_sortable.contents('li').remove();\n        $jform_reponsive_table.html('');\n        $jform_column_type_table.html('');\n        var html = '';\n        var html2 = '';\n        var column_type_html = '';\n        var ii = 0;\n\n        var responsive_priority = '';\n        for (var number = 0; number < (window.Wptm.max_Col > 12 ? window.Wptm.max_Col : 12); number++) {\n            responsive_priority += '<li data-value=\"' + number + '\">' + number + '</li>\\n';\n        }\n\n        $.each(tableData[0], function (i, e) {\n            var table_headers = jQuery(Wptm.container).handsontable('getColHeader');\n            var header = table_headers[i];\n            html += '<li data-value=\"' + ii + '\">' + header + '</li>';\n\n            html2 += '<tr data-col=\"' + ii + '\">';\n            html2 += '<td><label>' + header + '</label></td>';\n            html2 += '<td><span class=\"responsive_priority popup_select mb-0 wptm_select_box_before\"></span><ul class=\"wptm_select_box\">\\n'\n                + responsive_priority +\n                '</ul></td>';\n            html2 += '</tr>';\n\n            column_type_html += '<tr data-col=\"' + ii + '\">';\n            column_type_html += '<td><label>' + header + '</label></td>';\n            column_type_html += '<td><span class=\"column_type popup_select mb-0 wptm_select_box_before\"></span><ul class=\"wptm_select_box\">\\n' +\n                '                        <li data-value=\"varchar\">' + wptmContext.column_type_varchar + '</li>\\n' +\n                '                        <li data-value=\"int\">' + wptmContext.column_type_int + '</li>\\n' +\n                '                        <li data-value=\"float\">' + wptmContext.column_type_float + '</li>\\n' +\n                '                        <li data-value=\"date\">' + wptmContext.column_type_date + '</li>\\n' +\n                '                        <li data-value=\"datetime\">' + wptmContext.column_type_datetime + '</li>\\n' +\n                '                        <li data-value=\"text\">' + wptmContext.column_type_text + '</li>\\n' +\n                '                    </ul></td>';\n            column_type_html += '</tr>';\n            ii++;\n        });\n        $(html).appendTo($jform_default_sortable);\n        $jform_default_sortable.trigger(\"liszt:updated\");\n        $(html2).appendTo($jform_reponsive_table);\n        $jform_reponsive_table.trigger(\"liszt:updated\");\n        $(column_type_html).appendTo($jform_column_type_table);\n        $jform_column_type_table.trigger(\"liszt:updated\");\n    }\n}\n\n/*render data table, cells, rows, cols*/\nfunction cleanStyle(style, nbRows, nbCols) {\n    for (var col in style.cols) {\n        if (!style.cols[col] || style.cols[col][0] >= nbCols) {\n            delete style.cols[col];\n        }\n    }\n    for (var row in style.rows) {\n        if (!style.rows[row] || style.rows[row][0] >= nbRows) {\n            delete style.rows[row];\n        }\n    }\n    for (var cell in style.cells) {\n        if (style.cells[cell][0] >= nbRows || style.cells[cell][1] >= nbCols) {\n            delete style.cells[cell];\n        }\n    }\n    var propertiesPos, cells;\n    for (var obj in style) {\n        if (obj == 'table') {\n            continue;\n        }\n        for (cells in style[obj]) {\n            propertiesPos = style[obj][cells].length - 1;\n            for (var property in style[obj][cells][propertiesPos]) {\n                if (style[obj][cells][propertiesPos][property] === null) {\n                    delete style[obj][cells][propertiesPos][property];\n                }\n            }\n        }\n    }\n    return style;\n}\n\n/*change text table name, chart name*/\nfunction setText($name_edit, press_enter_selector, obj) {\n    unbindall();\n    /*select rename table*/\n    var oldTitle = $name_edit.text();\n    var wptm_name_edit = document.querySelector('.rename.wptm_name_edit');\n    $name_edit.attr('contentEditable', true).focus();\n\n    $name_edit.not('.editable').bind('click.mm', hstop);  //let's click on the editable object\n    jquery(press_enter_selector).bind('keydown.mm', enterKey); //let's press enter to validate new title'\n    jquery('*').not('.wptm_name_edit').bind('click.mm', houtside);\n\n    // $name_edit.addClass('editable');\n    if (obj.selected) {\n        $name_edit.trigger('click.mm');\n    }\n\n    function unbindall(reselectCell) {\n        $name_edit.not('.editable').unbind('click.mm', hstop);  //let's click on the editable object\n        jquery(press_enter_selector).unbind('keydown.mm', enterKey); //let's press enter to validate new title'\n        jquery('*').not('.wptm_name_edit').unbind('click.mm', houtside);\n        $name_edit.attr('contentEditable', false);\n\n        if (reselectCell && typeof table_function_data.selection[0][1] !== 'undefined') {//reselect cell after enter/esc name table\n            var selection = window.jquery(window.Wptm.container).handsontable('getSelected');\n            window.jquery(Wptm.container).handsontable(\"selectCell\", selection[0][0], selection[0][1], selection[0][0], selection[0][1]);\n        }\n    }\n\n    //Validation\n    function hstop(e) {\n        event.stopPropagation();\n        $name_edit.addClass('editable');\n        if (wptm_name_edit !== null) {\n            wptm_name_edit.focus();\n        }\n        return false;\n    }\n\n    function enterKey(e) {\n        e.stopImmediatePropagation();\n        if (e.which == 13) {\n            e.preventDefault();\n            $name_edit.removeClass('editable');\n            updateTitle($name_edit.text(), jquery);\n            unbindall(true);\n        }\n        if (e.which == 27) {\n            e.preventDefault();\n            $name_edit.text(oldTitle);\n            $name_edit.removeClass('editable');\n            unbindall(true);\n        }\n        $name_edit.removeClass('rename');\n    }\n\n    function houtside(e) {\n        if ($name_edit.hasClass('editable') && !$name_edit.hasClass('rename')) {\n            $name_edit.removeClass('editable');\n            updateTitle($name_edit.text(), jquery);\n            unbindall(true);\n            $name_edit.removeClass('rename');\n        }\n        return false;\n    }\n\n    function updateTitle(title, $) {\n        if (!(Wptm.can.edit || (Wptm.can.editown && data.author === Wptm.author))) {\n            return false;\n        }\n\n        if (oldTitle === title) {\n            return false;\n        }\n\n        if (title.trim() !== '' && typeof obj.url !== 'undefined') {\n            obj.url += title;\n            $.ajax({\n                url: obj.url,\n                type: \"POST\",\n                data: {},\n                dataType: \"json\",\n                beforeSend: function () {\n                    wptm_element.settingTable.find('.wptm_saving div').removeClass('wptm_hiden');\n                },\n                success: function (datas) {\n                    if (datas.response === true) {\n                        $name_edit.text(title);\n                        if ($('#pwrapper').hasClass('wptm_hiden')) {\n                            $('#list_chart').find('.chart-menu.active a').text(title);\n                        } else {\n                            $('#list_chart').find('.current_table a').text(title);\n                        }\n                        if (typeof obj.action !== 'undefined') {\n                            obj.action(title);\n                        }\n                        wptm_element.settingTable.find('.wptm_saving').removeClass('wptm_hiden');\n                        setTimeout(function () {\n                            wptm_element.settingTable.find('.wptm_saving').addClass('wptm_hiden');\n\n                            if (typeof obj.chart_id !== 'undefined') {\n                                localStorage.setItem('wptm_change_chart_name', JSON.stringify({\n                                    'id': Wptm.id,\n                                    'chart_id': obj.chart_id,\n                                    'title': title,\n                                    'modified_time': datas.datas.modified_time\n                                }));\n                            } else {\n                                localStorage.setItem('wptm_change_table_name', JSON.stringify({\n                                    'id': Wptm.id,\n                                    'title': title,\n                                    'modified_time': datas.datas.modified_time\n                                }));\n                            }\n\n                        }, 1500);\n                    } else {\n                        $name_edit.text(oldTitle);\n                        wptmBootbox('', datas.response, true, false);\n                    }\n                },\n                error: function (jqxhr, textStatus, error) {\n                    $name_edit.text(oldTitle);\n                    wptmBootbox('', textStatus, true, false);\n                }\n            });\n        } else {\n            $name_edit.text(oldTitle);\n            return false;\n        }\n        $name_edit.css('white-space', 'normal');\n        setTimeout(function () {\n            $name_edit.css('white-space', '');\n        }, 200);\n    }\n};\n\n//https://gist.github.com/ncr/399624\njQuery.fn.single_double_click = function (single_click_callback, double_click_callback, timeout) {\n    return this.each(function () {\n        var clicks = 0, self = this;\n        jQuery(this).click(function (event) {\n            clicks++;\n            if (clicks == 1) {\n                setTimeout(function () {\n                    if (clicks == 1) {\n                        single_click_callback.call(self, event);\n                    } else {\n                        double_click_callback.call(self, event);\n                    }\n                    clicks = 0;\n                }, timeout || 300);\n            }\n        });\n    });\n}\n\n//add, change style for column, rows, cells\nfunction getFillArray(selection, Wptm, value) {\n    var action = Array.prototype.slice.call(arguments, 3);\n    var save_data = false;\n    var actionInSaveData = null;\n    if (action.length === 0) {\n        actionInSaveData = 'style';\n    } else {\n        if (action.length > 1) {\n            save_data = action[1];\n        }\n        // if (action.length > 2) {\n        //     actionCall = action[2]\n        // }\n        actionInSaveData = action[0];\n    }\n\n    var checkRangeStyleExists = false;\n    if (saveData.length > 0) {\n        var old_saveData = saveData[saveData.length - 1];\n    }\n\n    eventToCellsSelected(\n        selection,\n        table_function_data.selectionSize,\n        (ranger, i) => {\n            return new Promise((resolve) => {\n                if (typeof old_saveData !== 'undefined') {\n                    if (actionInSaveData === old_saveData.action) {\n                        if (old_saveData.selection[i][0] == selection[i][0] &&\n                            old_saveData.selection[i][1] == selection[i][1] &&\n                            old_saveData.selection[i][2] == selection[i][2] &&\n                            old_saveData.selection[i][3] == selection[i][3]) {\n                            checkRangeStyleExists = true;\n                        }\n                    }\n                }\n\n                for (let i2 = ranger[1]; i2 <= ranger[3]; i2++) {\n                    if (table_function_data.option_selected_mysql !== '' && typeof table_function_data.option_selected_mysql !== 'undefined') {\n                        Wptm.style.cols = fillArray(Wptm.style.cols, value, i2);\n\n                        if (i2 === ranger[3]) {\n                            resolve(true)\n                        }\n                    } else {\n                        for (let i3 = ranger[0]; i3 <= ranger[2]; i3++) {\n                            Wptm.style.cells = fillArray(Wptm.style.cells, value, i3, i2);\n\n                            if (i3 === ranger[2]) {\n                                resolve(true)\n                            }\n                        }\n                    }\n                }\n\n            })\n        },\n        null,\n        null,\n        () => {\n            return new Promise((resolve) => {\n                if (typeof old_saveData !== 'undefined') {\n                    if (checkRangeStyleExists) {\n                        old_saveData.style = window.jquery.extend(old_saveData.style, value);\n                    } else {\n                        if (droptablesCheckSize(value) > 0) {\n                            saveData.push({action: actionInSaveData, selection: selection, style: value});\n                            if (save_data) {\n                                saveChanges(true);\n                            }\n                        }\n                    }\n                } else {\n                    if (droptablesCheckSize(value) > 0) {\n                        saveData.push({action: actionInSaveData, selection: selection, style: value});\n                        if (save_data) {\n                            saveChanges(true);\n                        }\n                    }\n                }\n                if (typeof action[2] !== 'string' && typeof action[2] !== 'undefined') {\n                    action[2].call()\n                }\n                resolve(true)\n            })\n        }\n    )\n}\n\nfunction droptablesCheckSize(obj) {\n    var size = 0,\n        key;\n    for (key in obj) {\n        if (obj.hasOwnProperty(key)) size++;\n    }\n    return size;\n};\n\nfunction removeValueInArray(array, parameters, val1, val2) {\n    if (typeof (val2) === 'undefined') {\n        if (typeof (val1) !== 'undefined') {\n            if (typeof (array[val1]) !== 'undefined') {\n                if (typeof array[val1][1][parameters] !== 'undefined') {\n                    delete array[val1][1][parameters];\n                }\n            } else {\n                array[val1] = [val1, {}];\n            }\n        } else {\n            delete array[parameters];\n        }\n    } else {\n        if (typeof (array[val1 + \"!\" + val2]) !== 'undefined') {\n            if (typeof array[val1 + \"!\" + val2][2][parameters] !== 'undefined') {\n                delete array[val1 + \"!\" + val2][2][parameters];\n            }\n        } else {\n            array[val1 + \"!\" + val2] = [val1, val2, {}];\n        }\n    }\n    return array;\n}\n\n//update new value for array\nfunction fillArray(array, val, val1, val2) {\n    if (typeof (val2) === 'undefined') {\n        if (typeof (val1) !== 'undefined') {\n            if (typeof (array[val1]) !== 'undefined') {\n                array[val1][1] = window.jquery.extend(array[val1][1], val);\n            } else {\n                array[val1] = [val1, {}];\n                array[val1][1] = val;\n            }\n        } else {\n            array = window.jquery.extend(array, val);\n        }\n    } else {\n        if (typeof (array[val1 + \"!\" + val2]) !== 'undefined') {\n            array[val1 + \"!\" + val2][2] = window.jquery.extend(array[val1 + \"!\" + val2][2], val);\n        } else {\n            array[val1 + \"!\" + val2] = [val1, val2, {}];\n            array[val1 + \"!\" + val2][2] = val;\n        }\n    }\n    return array;\n}\n\nfunction toggleArray(array, val, val1, val2) {\n    if (typeof (val2) === 'undefined') {\n        if (typeof (array[val1]) !== 'undefined') {\n            if (typeof (val) === 'object') {\n                for (var key in val) {\n                    if (typeof (array[val1][1][key] !== 'undefined')) {\n                        array[val1][1][key] = !array[val1][1][key];\n                    } else {\n                        array[val1][1][key] = val[key];\n                    }\n                }\n            } else {\n                array[val1][1] = jQuery.extend(array[val1][1], val);\n            }\n        } else {\n            array[val1] = [val1, {}];\n            array[val1][1] = val;\n        }\n    } else {\n        if (typeof (array[val1 + \"!\" + val2]) !== 'undefined') {\n            if (typeof (val) === 'object') {\n                for (var key in val) {\n                    if (typeof (array[val1 + \"!\" + val2][2][key] !== 'undefined')) {\n                        array[val1 + \"!\" + val2][2][key] = !array[val1 + \"!\" + val2][2][key];\n                    } else {\n                        array[val1 + \"!\" + val2][2][key] = val[key];\n                    }\n                }\n            } else {\n                array[val1 + \"!\" + val2][2] = jQuery.extend(array[val1 + \"!\" + val2][2], val);\n            }\n        } else {\n            array[val1 + \"!\" + val2] = [val1, val2, {}];\n            array[val1 + \"!\" + val2][2] = val;\n        }\n    }\n\n    return array;\n}\n\n//Code from http://stackoverflow.com/questions/9905533/convert-excel-column-alphabet-e-g-aa-to-number-e-g-25\nvar convertAlpha = function (val) {\n    var base = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', i, j, result = 0;\n\n    for (i = 0, j = val.length - 1; i < val.length; i += 1, j -= 1) {\n        result += Math.pow(base.length, j) * (base.indexOf(val[i]) + 1);\n    }\n\n    return result;\n};\n\nfunction wptm_clone(v) {\n    return JSON.parse(JSON.stringify(v));\n}\n\n//convert value of calculation by format selected\nfunction formatSymbols(resultCalc, decimal_count, thousand_symbols, decimal_symbols, symbol_position, value_unit) {\n    decimal_count = parseInt(decimal_count);\n    if (typeof resultCalc === 'undefined') {\n        return;\n    }\n    var negative = resultCalc < 0 ? \"-\" : \"\",\n        i = parseInt(resultCalc = Math.abs(+resultCalc || 0).toFixed(decimal_count), 10) + \"\",\n        j = (j = i.length) > 3 ? j % 3 : 0;\n\n    resultCalc = (j ? i.substr(0, j) + thousand_symbols : \"\") + i.substr(j).replace(/(\\d{3})(?=\\d)/g, \"$1\" + thousand_symbols) + (decimal_count ? decimal_symbols + Math.abs(resultCalc - i).toFixed(decimal_count).slice(2) : \"\");\n\n    resultCalc = Number(symbol_position) === 0\n        ? ((negative === \"-\") ? negative + value_unit : value_unit) + resultCalc\n        : negative + resultCalc + ' ' + value_unit;\n\n    return resultCalc;\n};\n\n// Convert date in date_format to the format: m/d/Y /a/t g:i A\n// example: number -> array(2016,03,26)\nfunction convertDate(date_format, number, timezone) {\n    var date_array = [];\n    number = (!!number) ? number : [];\n    if (date_format.length !== number.length) {\n        return false;\n    }\n    if (typeof timezone === 'undefined') {\n        timezone = true;\n    }\n    for (var n = 0; n < date_format.length; n++) {\n        number[n] = (!!number[n]) ? number[n] : '';\n        if (date_format[n] === 'd' || date_format[n] === 'j') {\n            date_array[2] = (number[n] !== '') ? number[n] : '';\n        } else if (date_format[n] === 'S' || date_format[n] === 'jS' || date_format[n] === 'dS') {\n            date_array[2] = number[n].match(/[0-9]+/g);\n        } else if (date_format[n] === 'm' || date_format[n] === 'n') {\n            date_array[1] = number[n];\n        } else if (date_format[n] === 'F') {\n            date_array[1] = F_name.indexOf(number[n].toLowerCase()) + 1;\n        } else if (date_format[n] === 'M') {\n            date_array[1] = M_name.indexOf(number[n].toLowerCase()) + 1;\n        } else if (date_format[n].toLowerCase() === 'y') {\n            date_array[3] = number[n];\n        } else if (date_format[n].toLowerCase() === 'g' || date_format[n].toLowerCase() === 'h') {\n            date_array[4] = Number(number[n]);\n        } else if (date_format[n].toLowerCase() === 'ga' || date_format[n].toLowerCase() === 'ha') {\n            date_array[4] = number[n].match(/[0-9]+/g);\n            date_array[4] = (number[n].toLowerCase().match(/[a-z]+/g) === 'am') ? date_array[4] : date_array[4] + 12;\n        } else if (date_format[n].toLowerCase() === 'a') {\n            date_array[7] = number[n];\n        } else if (date_format[n].toLowerCase() === 'i' || date_format[n].toLowerCase() === 'ia') {\n            date_array[5] = number[n].match(/[0-9]+/g);\n        } else if (date_format[n].toLowerCase() === 's' || date_format[n].toLowerCase() === 'sa') {\n            date_array[6] = number[n].match(/[0-9]+/g);\n        } else if (date_format[n] === 'T') {\n            date_array[8] = number[n];\n        } else if (date_format[n] === 'r') {\n            if (M_name.indexOf(number[2].toLowerCase()) + 1 > 0) {\n                date_array[1] = M_name.indexOf(number[2].toLowerCase()) + 1;\n            } else {\n                date_array[1] = F_name.indexOf(number[2].toLowerCase()) + 1;\n            }\n            return date_array[1] + '/' + number[1] + '/' + number[3] + ' ' + number[4] + ':' + number[5] + ':' + number[6] + ' ' + number[7];\n        }\n    }\n    date_array[4] = (!!date_array[4]) ? date_array[4] : 0;\n    date_array[5] = (!!date_array[5]) ? date_array[5] : '00';\n    date_array[6] = (!!date_array[6]) ? date_array[6] : '00';\n    date_array[7] = (!!date_array[7]) ? ' ' + date_array[7] : '';\n    date_array[8] = (!!date_array[8]) ? ' ' + date_array[8] : '';\n    date_array[8] = (timezone === true) ? ' ' + date_array[8] : '';\n\n    if (date_array[7] !== 'undefined' && date_array[7] !== '' && date_array[4] > 12) {\n        date_array[4] = date_array[4] - 12;\n    }\n    if (date_array[1] === 0 || date_array[2] > 31 || date_array[1] > 12) {\n        return false;\n    }\n    return date_array[1] + '/' + date_array[2] + '/' + date_array[3] + ' ' + date_array[4] + ':' + date_array[5] + ':' + date_array[6] + date_array[7] + date_array[8];\n}\n\n//create string_currency_symbols, replace_unit, text_replace_unit, date_format RegExp string\nfunction createRegExpFormat(table_function_data, currency_symbol, date_formats) {\n    if (currency_symbol !== false) {\n        table_function_data.string_currency_symbols = currency_symbol.replace(/ /g, \"\");\n        // create string reg currency symbols\n        table_function_data.replace_unit = new RegExp('[' + table_function_data.string_currency_symbols.replace(/,/g, \"|\") + ']', \"g\");\n\n        // create string reg have not currency symbols\n        table_function_data.text_replace_unit = '[^a-zA-Z|' + table_function_data.string_currency_symbols.replace(/,/g, \"|^\") + ']';\n        table_function_data.text_replace_unit = new RegExp(table_function_data.text_replace_unit, \"g\");\n        table_function_data.text_replace_unit_function = new RegExp('[^ |' + table_function_data.string_currency_symbols.replace(/,/g, \"|^\") + ']', \"g\");\n    }\n    if (date_formats !== false) {\n        table_function_data.date_format = date_formats.match(/[a-zA-Z|\\\\]+/g);\n    }\n    return table_function_data;\n}\n\n// check column is int\nfunction replaceCell($, cellsData, currency_symbol) {\n    var data1 = [];\n    var i = 0;\n    var data2 = -1;\n    var v1 = '';\n    currency_symbol = new RegExp('[0-9|\\.|\\,|\\\\-|' + currency_symbol + ']', \"g\");\n\n    $.each(cellsData, function (k, v) {\n        v = v.toString();\n        v1 = v.replace(currency_symbol, '');\n        if (v1 === '') {\n            data1[i] = k;\n            i++;\n        } else if (v !== '') {\n            data2 = k;\n        }\n    });\n    var data = [];\n    data[1] = '';\n    data[0] = data1;\n    if (data2 !== -1) {\n        data[1] = data2;\n    }\n    return data;\n}\n\n//get size of cell selected when open change height, row popup\nfunction getSizeCells($, Wptm, cells) {\n    if (Wptm.type === 'mysql') {\n        updateParamFromStyleObject(Wptm.style.rows[0][1], 'height', $('#cell_row_height'), '30');\n    } else {\n        if (checkObjPropertyNested(Wptm.style.rows, cells[0], 1, 'height')) {\n            $('#cell_row_height').val(Wptm.style.rows[cells[0]][1].height);\n        }\n    }\n\n    if (checkObjPropertyNested(Wptm.style.cols, cells[1], 1, 'width')) {\n        $('#cell_col_width').val(Wptm.style.cols[cells[1]][1].width);\n    }\n    if (checkObjPropertyNested(Wptm.style.table, 'allRowHeight')) {\n        $('#all_cell_row_height').val(Wptm.style.table.allRowHeight);\n    }\n}\n\nfunction changeValue(oldValue, index, amount, lengths, LeftRight, copyHeightRow) {\n    var i;\n    var new_data = {};\n    if (LeftRight) {//left\n        for (i = index; i < lengths; i++) {\n            if (typeof new_data[i + amount] === 'undefined') {\n                new_data[i + amount] = [i + amount, {}];\n            }\n\n            new_data[i + amount][1] = oldValue[i][1];\n            if (i + 1 === lengths) {\n                var return_data = jquery.extend({}, oldValue, new_data);\n                return return_data;\n            }\n        }\n    } else {//right\n        for (i = index; i < lengths + amount; i++) {\n            if (typeof new_data[i] === 'undefined') {\n                new_data[i] = [i, {}];\n            }\n\n            if (!copyHeightRow) {\n                new_data[i][1] = jquery.extend({}, oldValue[i - amount][1]);\n            }\n\n            if ((i + 1) === (lengths + amount)) {\n                return jquery.extend({}, oldValue, new_data);\n            }\n        }\n    }\n}\n\nfunction pullDims(Wptm, $) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var cols = [];\n    var rows = [];\n    var row, lengthRows, lengthCols, col;\n\n    // get count of Wptm.style.rows\n    if (typeof Wptm.style.rows.length !== 'undefined') {\n        lengthRows = Wptm.style.rows.length;\n    } else {\n        lengthRows = Object.keys(Wptm.style.rows).length;\n    }\n\n    for (row = 0; row < lengthRows; row++) {\n        if (checkObjPropertyNested(Wptm.style.rows[row], 1, 'height')) {\n            rows[row] = Wptm.style.rows[row][1].height;\n        } else if (Wptm.type === 'mysql' && typeof Wptm.style.table.allRowHeight !== 'undefined' && Wptm.style.table.allRowHeight !== '') {\n            rows[row] = Wptm.style.table.allRowHeight;\n        } else {\n            rows[row] = null;\n        }\n    }\n    // get count of Wptm.style.cols\n\n    if (typeof Wptm.style.cols.length !== 'undefined') {\n        lengthCols = Wptm.style.cols.length;\n    } else {\n        lengthCols = Object.keys(Wptm.style.cols).length;\n    }\n\n    for (col = 0; col < lengthCols; col++) {\n        if (checkObjPropertyNested(Wptm.style.cols[col], 1, 'width')) {\n            cols[col] = Wptm.style.cols[col][1].width;\n        } else {\n            cols[col] = null;\n        }\n    }\n    Wptm.updateSettings.manualColumnResize = $.extend([], cols);\n    Wptm.updateSettings.rowHeights = $.extend([], rows);\n\n    if (typeof args[1] === 'undefined' || args[1] === true) {\n        delete Wptm.updateSettings.manualColumnResize;\n        delete Wptm.updateSettings.manualRowResize;\n\n        Wptm.container.handsontable('updateSettings', {'manualColumnResize': cols});\n        Wptm.container.handsontable('updateSettings', {'manualRowResize': rows});\n    }\n}\n\n//add row height, col width for Wptm.style\nfunction pushDims($, Wptm) {\n    //get value height rows\n    var rows = $(Wptm.container).handsontable('countRows');\n    var i = 0;\n    var value = 0;\n    for (i = 0; i < rows; i++) {\n        value = $(Wptm.container).handsontable('getRowHeight', i);\n        if (Wptm.type === 'html') {\n            if (!value || value === 0) {\n                if (typeof (Wptm.style.rows[i]) !== 'undefined' && typeof (Wptm.style.rows[i][1].height) !== 'undefined') {\n                    value = parseInt(Wptm.style.rows[i][1].height);\n                }\n                if (value === null) {\n                    value = 22;\n                }\n            }\n        } else { //type mysql\n            if (checkObjPropertyNestedNotEmpty(Wptm.style.rows[i], 1, 'height')) { //Row height is set\n                value = parseInt(Wptm.style.rows[i][1].height);\n            } else {\n                value = null; //if aviation height is set then height === null\n            }\n        }\n\n        Wptm.style.rows = fillArray(Wptm.style.rows, {height: parseInt(value)}, i);\n        value = 0;\n    }\n    //get value width columns\n    var cols = $(Wptm.container).handsontable('countCols');\n    Wptm.max_Col = cols;\n    Wptm.max_row = rows;\n\n    Wptm.style.table.width = 0;\n    var valueCols = 0;\n    for (i = 0; i < cols; i++) {\n        valueCols = $('#tableContainer').handsontable('getColWidth', i);\n        if (!valueCols || valueCols === 0) {\n            if (typeof (Wptm.style.cols[i]) !== 'undefined' && Wptm.style.cols[i] !== null && (typeof (Wptm.style.cols[i][1].width) !== 'undefined')) {\n                valueCols = parseInt(Wptm.style.cols[i][1].width);\n            } else {\n                valueCols = null;\n            }\n        }\n        if (!valueCols || valueCols === 0) {\n            valueCols = 100;\n        }\n\n        Wptm.style.cols = fillArray(Wptm.style.cols, {width: parseInt(valueCols)}, i);\n\n        Wptm.style.table.width += parseInt(valueCols);\n        valueCols = 0;\n    }\n}\n\n//add res priority of columns to set resposive priority popup\nfunction responsive_col(Wptm) {\n    var col = this.val();\n    if (typeof (Wptm.style.cols) !== 'undefined' && typeof (Wptm.style.cols[col]) !== 'undefined' && typeof (Wptm.style.cols[col][1]) !== 'undefined' && typeof (Wptm.style.cols[col][1].res_priority) !== 'undefined') {\n        var res_priority = Wptm.style.cols[col][1].res_priority;\n\n        this.siblings('#responsive_priority').val(res_priority);\n    } else {\n\n        this.siblings('#responsive_priority').val(0);\n    }\n    this.siblings('#responsive_priority').trigger('liszt:updated');\n}\n\nfunction loading(e) {\n    e.addClass('dploadingcontainer');\n    e.append('<div class=\"dploading\"></div>');\n}\n\nfunction rloading(e) {\n    e.removeClass('dploadingcontainer');\n    e.find('div.dploading').remove();\n}\n\n//add custom css for element\nfunction parseCss($) {\n    var parser = new (less.Parser);\n    var content = '#mainTabContent .handsontable .ht_master .wtHider .wtSpreader .htCore tbody {' + $('#jform_css').val() + '}';\n    content += '#mainTabContent .handsontable .ht_clone_top .wtHider .wtSpreader .htCore tbody {' + $('#jform_css').val() + '}';\n    content += '#mainTabContent .handsontable .ht_clone_bottom .wtHider .wtSpreader .htCore tbody {' + $('#jform_css').val() + '}';\n    content += '#mainTabContent .handsontable .ht_clone_left .wtHider .wtSpreader .htCore tbody {' + $('#jform_css').val() + '}';\n    content += '#mainTabContent .handsontable .ht_clone_top_left_corner .wtHider .wtSpreader .htCore tbody {' + $('#jform_css').val() + '}';\n    content += '.reset {background-color: rgb(238, 238, 238);border-bottom-color: rgb(204, 204, 204);border-bottom-style: solid;border-bottom-width: 1px;border-collapse: collapse;border-left-color: rgb(204, 204, 204);border-left-style: solid;border-left-width: 1px;border-right-color: rgb(204, 204, 204);border-right-style: solid;border-right-width: 1px;border-top-color: rgb(204, 204, 204);border-top-style: solid;border-top-width: 1px;box-sizing: content-box;color: rgb(34, 34, 34);display: table-cell;empty-cells: show;font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;font-size: 13px;font-weight: normal;line-height: 21px;outline-width: 0px;overflow-x: hidden;overflow-y: hidden;padding-bottom: 0px;padding-left: 4px;padding-right: 4px;padding-top: 0px;text-align: center;vertical-align: top;white-space: nowrap;position: relative;}';\n    content += '#mainTabContent .handsontable .ht_master .wtHider .wtSpreader .htCore tbody tr th {.reset() !important;}'\n    parser.parse(content, function (err, tree) {\n        if (err) {\n            //Here we can throw the erro to the user\n            return false;\n        } else {\n            Wptm.css = $('#jform_css').val();\n            if ($('#headCss').length === 0) {\n                $('head').append('<style id=\"headCss\"></style>');\n            }\n            $('#headCss').text(tree.toCSS());\n            return true;\n        }\n    });\n}\n\nfunction getCellData(cellPos) {\n    var pos = cellPos.split(\":\");\n    var value = Wptm.container.handsontable('getDataAtCell', parseInt(pos[0]), parseInt(pos[1]));\n\n    return value;\n}\n\n//replace string by decimal_symbol value and thousand_symbol value in calculation cell\nfunction stringReplace(arr, unit) {\n    var thousand_symbol = (!Wptm.style.table.thousand_symbol) ? default_value.thousand_symbol : Wptm.style.table.thousand_symbol;\n    var decimal_symbol = (!Wptm.style.table.decimal_symbol) ? default_value.decimal_symbol : Wptm.style.table.decimal_symbol;\n    if (typeof arr === 'number') {\n        return arr;\n    }\n    var thousand_re = new RegExp('[' + thousand_symbol + ']', \"g\");\n    // var thousand_re = new RegExp(thousand_symbol,\"g\");\n    if (typeof arr !== 'undefined' && arr !== '' && arr !== null) {\n        if (unit === true) {\n            if (typeof arr !== 'string') {\n                arr = arr.toString();\n            }\n            arr = arr.replace(table_function_data.text_replace_unit, \"\");\n        } else {\n            arr = arr.replace(table_function_data.replace_unit, \"\");\n            arr = arr.replace(thousand_re, \"\");\n            // arr = (thousand_symbol === ',') ? arr.replace(/,/g, \"\") : (thousand_symbol === '.' ? arr.replace(/\\./g, \"\") : arr);\n            arr = (decimal_symbol === ',') ? arr.replace(/,/g, \".\") : arr;\n        }\n    } else {\n        arr = '';\n    }\n    return arr;\n}\n\n//Toggle between the charts and the table\nfunction showChartOrTable(showChart, $chart) {\n    if (showChart) {//show chart\n        jquery('#wptm_chart').removeClass('wptm_hiden');\n        jquery('#pwrapper').addClass('wptm_hiden');\n        $chart.trigger('click');\n        jquery('#list_chart').find('.current_table').unbind('click').on('click', showChartOrTable.bind(this, false));\n    } else {//show table\n        if (jquery('#inserttable').length > 0) {\n            Wptm.chart_active = 0;\n            if (!jquery('#inserttable').hasClass('not_change_type')) {\n                jquery('#inserttable').data('type', 'table').attr('data-type', 'table').text(insert_table);\n            }\n            jquery('#inserttable').removeClass(\"no_click\");\n        }\n        jquery('#wptm_chart').addClass('wptm_hiden');\n        jquery('#pwrapper').removeClass('wptm_hiden');\n        Wptm.container.handsontable('render');\n    }\n    jquery('#over_loadding_open_chart').hide();\n    wptm_element.primary_toolbars.find('.menu_loading').closest('li').removeClass('menu_loading');\n    wptm_element.settingTable.find('.ajax_loading').removeClass('loadding').addClass('wptm_hiden');\n}\n\nfunction ripple_button(that) {\n    that.find(\".wptm_ripple\").click(function (e) {\n        // Remove any old one\n        jquery(\".ripple\").remove();\n\n        // Setup\n        var posX = jquery(this).offset().left,\n            posY = jquery(this).offset().top,\n            buttonWidth = jquery(this).width(),\n            buttonHeight = jquery(this).height();\n\n        // Add the element\n        jquery(this).prepend(\"<span class='ripple'></span>\");\n\n        // Make it round!\n        if (buttonWidth >= buttonHeight) {\n            buttonHeight = buttonWidth;\n        } else {\n            buttonWidth = buttonHeight;\n        }\n\n        // Get the center of the element\n        var x = e.pageX - posX - buttonWidth / 2;\n        var y = e.pageY - posY - buttonHeight / 2;\n\n        // Add the ripples CSS and start the animation\n        jquery(\".ripple\").css({\n            width: buttonWidth,\n            height: buttonHeight,\n            top: y + 'px',\n            left: x + 'px'\n        }).addClass(\"rippleEffect\");\n    });\n}\n\nfunction isSameArray(array1, array2) {\n    return array1.length === array2.length && array1.every(function (element, index) {\n        return element === array2[index];\n    });\n}\n\n//mer rows, columns style to cells style\nfunction mergeCollsRowsstyleToCells() {\n    var style = jquery.extend({}, window.Wptm.style);\n    jquery.each(style.cols, function (col, cValue) {\n        jquery.each(style.rows, function (row, rValue) {\n            var styleCell = {};\n            if (typeof (window.Wptm.style.cells[row + '!' + col]) === 'undefined') {\n                window.Wptm.style.cells[row + '!' + col] = [row, col, {}];\n            }\n            if (typeof (style.rows[row]) !== 'undefined' && style.rows[row] !== null && Object.keys(style.rows[row][1]).length !== 0) {\n                styleCell = jquery.extend({}, styleCell, rValue[1]);\n            }\n            if (typeof (style.cols[col]) !== 'undefined' && style.cols[col] !== null && Object.keys(style.cols[col][1]).length !== 0) {\n                styleCell = jquery.extend({}, styleCell, cValue[1]);\n            }\n            window.Wptm.style.cells[row + '!' + col][2] = jquery.extend({}, styleCell, window.Wptm.style.cells[row + '!' + col][2]);\n        });\n    });\n}\n\nfunction setFormat_accounting() {\n    var data = {};\n    data.thousand_symbol = Wptm.style.table.thousand_symbol;\n    data.symbol_position = Wptm.style.table.symbol_position;\n    data.decimal_symbol = Wptm.style.table.decimal_symbol;\n    data.decimal_count = Wptm.style.table.decimal_count;\n    data.currency_symbol = Wptm.style.table.currency_symbol;\n\n    accounting.settings = {\n        currency: {\n            symbol: data.currency_symbol,   // default currency symbol is '$'\n            format: data.symbol_position == 1 ? \"%v %s\" : \"%s %v\", // controls output: %s = symbol, %v = value/number (can be object: see below)\n            decimal: data.decimal_symbol,  // decimal point separator\n            thousand: data.thousand_symbol,  // thousands separator\n            precision: data.decimal_count   // decimal places\n        },\n        number: {\n            decimal: data.decimal_symbol,  // decimal point separator\n            thousand: data.thousand_symbol,  // thousands separator\n            precision: data.decimal_count   // decimal places\n        }\n    };\n}\n\nfunction updateStyleAutofill(start_rangess, new_range, direction) {\n    var respectively = [], data_respectively;\n    var maxRange = [start_rangess[2] - start_rangess[0] + 1, start_rangess[3] - start_rangess[1] + 1];\n\n    for (var i = new_range[0]; i <= new_range[2]; i++) {//rows\n        for (var j = new_range[1]; j <= new_range[3]; j++) {//cols\n            respectively[0] = i - new_range[0] > maxRange[0]\n                ? ((i - new_range[0]) % maxRange[0]) + start_rangess[0]\n                : i - new_range[0] + start_rangess[0];\n            respectively[1] = j - new_range[1] > maxRange[1]\n                ? ((j - new_range[1]) % maxRange[1]) + start_rangess[1]\n                : j - new_range[1] + start_rangess[1];\n            //update cell hyperlink\n            if (typeof Wptm.hyperlink[i + '!' + j] !== 'undefined') {\n                delete Wptm.hyperlink[i + '!' + j];\n            }\n            if (typeof Wptm.hyperlink[respectively[0] + '!' + respectively[1]] !== 'undefined') {\n                data_respectively = Wptm.hyperlink[respectively[0] + '!' + respectively[1]];\n                Wptm.hyperlink[i + '!' + j] = {};\n                Wptm.hyperlink[i + '!' + j].hyperlink = data_respectively.hyperlink;\n                Wptm.hyperlink[i + '!' + j].text = data_respectively.text;\n            }\n\n            //update cell type and col type\n            var selection = {'0': [i, j, i, j]};\n            if (typeof Wptm.style.cells[i + '!' + j] !== 'undefined'\n                && Wptm.style.cells[i + '!' + j][2].cell_type === 'html') {\n                Wptm.style.cells[i + '!' + j][2].cell_type = null;\n                saveData.push({action: 'set_cells_type', selection: selection, style: {cell_type: null}});\n            } else if (typeof Wptm.style.cells[i + '!' + j] === 'undefined' || typeof Wptm.style.cells[i + '!' + j][2] === 'undefined') {\n                Wptm.style.cells[i + '!' + j] = [i, j, {}];\n            }\n\n            if (typeof Wptm.style.cells[respectively[0] + '!' + respectively[1]] !== 'undefined'\n                && Wptm.style.cells[respectively[0] + '!' + respectively[1]][2].cell_type === 'html') {\n                Wptm.style.cells[i + '!' + j][2].cell_type = 'html';\n                saveData.push({action: 'set_cells_type', selection: selection, style: {cell_type: 'html'}});\n\n                if (typeof Wptm.style.table.col_types !== 'undefined'\n                    && Wptm.style.table.col_types[j] !== 'text') {\n                    Wptm.style.table.col_types[j] = 'text';\n                    if (typeof table_function_data.colsSetType === 'undefined') {\n                        table_function_data.colsSetType = {};\n                    }\n                    table_function_data.colsSetType[j] = 'text';\n                }\n            }\n        }\n    }\n}\n\nfunction setPositionForHtmlCellEditor() {\n    var tdOffset = jquery(window.Wptm.container).find('.isHtmlCell.dtr' + table_function_data.selection[0][0] + '.dtc' + table_function_data.selection[0][1]).offset();\n    var offsetTable = wptm_element.tableContainer.offset();\n    var heightTable = wptm_element.tableContainer.outerHeight() + offsetTable.top;\n    var widthTable = wptm_element.tableContainer.outerWidth() + offsetTable.left;\n\n    var wptm_edit_html_cell_width = wptm_element.wptm_edit_html_cell.outerWidth();\n    var wptm_edit_html_cell_height = wptm_element.wptm_edit_html_cell.outerHeight();\n\n    if (wptm_edit_html_cell_width + tdOffset.left > widthTable) {\n        tdOffset.left = widthTable - wptm_edit_html_cell_width - 30;\n    }\n    if (350 + tdOffset.top > heightTable) {\n        tdOffset.top = heightTable - 350;\n    }\n\n    return tdOffset;\n}\n\nfunction hashFnv32a() {\n    return Math.random().toString(36).substr(2) + Math.random().toString(36).substr(2);\n}\n\nfunction copy_text(that, default_value) {\n    var copyText = jquery(that).parent().find('.wptm_copy_text_content');\n    var textArea = document.createElement(\"textarea\");\n\n    if (copyText[0].nodeName === 'INPUT') {\n        if (copyText.val() === '') {\n            textArea.value = default_value;\n        } else {\n            textArea.value = copyText.val();\n        }\n    } else {\n        if (copyText.text() === '') {\n            textArea.value = default_value;\n        } else {\n            textArea.value = copyText.text();\n        }\n    }\n\n    document.body.appendChild(textArea);\n    textArea.select();\n    document.execCommand(\"Copy\");\n    textArea.remove();\n}\n\nfunction getLinkSync(link, type, warningDisplay) {\n    var data = {};\n    switch (type) {\n        case 'excel':\n            if (link.indexOf(\"docs.google.com/spreadsheet\") !== -1 && warningDisplay) {\n                wptmBootbox('', wptmText.error_link_import_sync, wptmText.GOT_IT, false);\n                Wptm.style.table.excel_url = '';\n                return false;\n            }\n            data.auto_sync = Wptm.style.table.excel_auto_sync != '1' ? 0 : 1;\n            data.spreadsheet_style = Wptm.style.table.excel_spreadsheet_style != '1' ? 0 : 1;\n            data.url = encodeURI(link);\n\n            break;\n        case 'csv':\n            data.auto_sync = Wptm.style.table.auto_sync_csv != '1' ? 0 : 1;\n            data.url = encodeURI(link);\n\n            break;\n        case 'onedrive':\n            if (link.indexOf(\"sharepoint\") === -1 && link.indexOf(\"onedrive.live.com\") === -1 && warningDisplay) {\n                wptmBootbox('', wptmText.error_link_import_sync, wptmText.GOT_IT, false);\n                Wptm.style.table.onedrive_url = '';\n                return false;\n            }\n            data.auto_sync = Wptm.style.table.auto_sync_onedrive != '1' ? 0 : 1;\n            data.spreadsheet_style = Wptm.style.table.onedrive_style != '1' ? 0 : 1;\n\n            if (link.indexOf(\"onedrive.live.com\") !== -1 && link.indexOf(\"download?\") === -1) {\n                if (link.indexOf(\"<iframe\") !== -1) {\n                    link = link.match(/src=\"(.*?)\"/)[1];\n                }\n                link = link.replace(\"embed?\", \"download?\");\n            } else if (link.indexOf(\"sharepoint\") !== -1 && link.indexOf(\"download=\") === -1) {\n                link += '&download=1';\n            }\n            data.url = link;\n\n            break;\n        case 'spreadsheet':\n            var end_link = link.split('?');\n            var end_link0 = end_link[0].slice(-7);\n            if (link.indexOf(\"docs.google.com/spreadsheet\") === -1 && end_link0.match(/html|csv|pdf|xlsx/gi) === null && (typeof end_link[1] !== \"undefined\" && end_link[1].match(/sharing|html|csv|pdf|xlsx/gi) === null) && warningDisplay) {\n                wptmBootbox('', wptmText.error_link_google_sync, wptmText.GOT_IT, false);\n                Wptm.style.table.spreadsheet_url = '';\n                return false;\n            }\n            data.auto_sync = Wptm.style.table.auto_sync != '1' ? 0 : 1;\n            data.spreadsheet_style = Wptm.style.table.spreadsheet_style != '1' ? 0 : 1;\n            data.url = encodeURI(link);\n            break;\n    }\n\n    return data;\n}\n\n//convert droptables's dateformat to momentjs's dateformat\nfunction momentjsFormat(value) {\n    value = value.replaceAll(\"M\", \"MMM\");\n    value = value.replaceAll(\"n\", \"M\");\n    value = value.replaceAll(\"F\", \"MMMM\");\n    value = value.replaceAll(\"m\", \"MM\");\n\n    value = value.replaceAll(\"D\", \"ddd\");\n    let date = new RegExp('(\\\\b)d(?!d)', \"g\");\n    value = value.replaceAll(date, \"DD\");\n\n    value = value.replaceAll(\"j\", \"D\");\n    value = value.replaceAll(\"z\", \"DDDD\");\n    value = value.replaceAll(\"l\", \"dddd\");\n    value = value.replaceAll(\"S\", \"Do\");\n    value = value.replaceAll(\"N\", \"e\");\n\n    value = value.replaceAll(\"w\", \"do\");\n    value = value.replaceAll(\"W\", \"w\");\n\n    value = value.replaceAll(\"Y\", \"YYYY\");\n    value = value.replaceAll(\"o\", \"Y\");\n    value = value.replaceAll(\"y\", \"YY\");\n\n\n    value = value.replaceAll(\"h\", \"hh\");\n    value = value.replaceAll(\"g\", \"h\");\n    value = value.replaceAll(\"H\", \"HH\");\n    value = value.replaceAll(\"G\", \"H\");\n\n    value = value.replaceAll(\"i\", \"mm\");\n    value = value.replaceAll(\"s\", \"ss\");\n    value = value.replaceAll(\"T\", \"z\");\n    return value;\n}\n\nfunction checkCellsOptionsValidate(selection, parametor, value) {\n    let returnVal = false;\n    if (typeof arguments[3] !== 'undefined') {\n        let j = arguments[3];\n        for (let i = 0; i < j.length; i++) {\n            if (typeof j[i][parametor] !== 'undefined' && j[i][parametor] == value) {\n                return true;\n            }\n        }\n        return returnVal;\n    } else if (selection.length > 0) {\n        eventToCellsSelected(\n            selection,\n            table_function_data.selectionSize,\n            (ranger, i) => {\n                for (let i2 = ranger[0]; i2 <= ranger[2]; i2++) {\n                    for (let j = ranger[1]; j <= ranger[3]; j++) {\n                        if (typeof Wptm.style.cells[i2 + '!' + j] !== 'undefined' && typeof Wptm.style.cells[i2 + '!' + j][2] !== 'undefined') {\n                            if (typeof Wptm.style.cells[i2 + '!' + j][2][parametor] !== 'undefined' && Wptm.style.cells[i2 + '!' + j][2][parametor] == value) {\n                                returnVal = true\n                                return true;\n                            }\n                        }\n                    }\n                }\n            },\n            null,\n            null,\n            null\n        )\n        return returnVal;\n    }\n}\n\nfunction setFormat_accounting_for_cells(setFormat_accounting_for_cells_raw) {\n\n    return {\n        currency: {\n            symbol: setFormat_accounting_for_cells_raw.currency_symbol,   // default currency symbol is '$'\n            format: setFormat_accounting_for_cells_raw.symbol_position == 1 ? \"%v%s\" : \"%s%v\", // controls output: %s = symbol, %v = value/number (can be object: see below)\n            decimal: setFormat_accounting_for_cells_raw.decimal_symbol,  // decimal point separator\n            thousand: setFormat_accounting_for_cells_raw.thousand_symbol,  // thousands separator\n            precision: typeof setFormat_accounting_for_cells_raw.decimal_count !== 'undefined' ? setFormat_accounting_for_cells_raw.decimal_count : 0   // decimal places\n        },\n        number: {\n            decimal: setFormat_accounting_for_cells_raw.decimal_symbol,  // decimal point separator\n            thousand: setFormat_accounting_for_cells_raw.thousand_symbol,  // thousands separator\n            precision: typeof setFormat_accounting_for_cells_raw.decimal_count !== 'undefined' ? setFormat_accounting_for_cells_raw.decimal_count : 0   // decimal places\n        },\n        table: {\n            decimal: Wptm.style.table.decimal_symbol,  // decimal point separator\n            thousand: Wptm.style.table.thousand_symbol,  // thousands separator\n            precision: Wptm.style.table.decimal_count,   // decimal places\n            format: Wptm.style.table.symbol_position,\n            symbol: Wptm.style.table.currency_symbol\n        }\n    };\n}\n\n//create string_currency_symbols, replace_unit, text_replace_unit, date_format RegExp string\nfunction createRegExpFormatForCell(currency_symbol, date_formats, cell_function_data) {\n    if (currency_symbol !== false) {\n        cell_function_data.string_currency_symbols = currency_symbol.replace(/ /g, \"\");\n        // create string reg currency symbols\n        cell_function_data.replace_unit = new RegExp('[' + cell_function_data.string_currency_symbols.replace(/,/g, \"|\") + ']', \"g\");\n\n        // create string reg have not currency symbols\n        cell_function_data.text_replace_unit = '[^a-zA-Z|' + cell_function_data.string_currency_symbols.replace(/,/g, \"|^\") + ']';\n        cell_function_data.text_replace_unit = new RegExp(cell_function_data.text_replace_unit, \"g\");\n        cell_function_data.text_replace_unit_function = new RegExp('[^ |' + cell_function_data.string_currency_symbols.replace(/,/g, \"|^\") + ']', \"g\");\n    }\n    if (date_formats !== false) {\n        cell_function_data.date_format = date_formats.match(/[a-zA-Z|\\\\]+/g);\n    }\n    return cell_function_data;\n}\n\nfunction status_notic(status, text) {\n    var $ = window.jquery;\n    var status_e = $('#savedInfoTable');\n    if (status === 1) {\n        status_e = $('#savedInfoTable');\n    } else {\n        status_e = $('#saveErrorTable');\n    }\n\n    var args = Array.prototype.slice.call(arguments, 1);\n    if (typeof args[1] !== \"undefined\") {\n        status_e = args[1];\n    }\n\n    status_e.html(text);\n    var position = window.jquery('#setting-cells').offset();\n    setTimeout(function () {\n        status_e.animate({'opacity': '0.8', 'top': position.top - 35}, 500).delay(2000).animate({\n            'opacity': '0',\n            'top': '-45px'\n        }, 1000);\n    }, 1000);\n}\n\nfunction check_cell_readOnly_mysql(row, col, cellProperties) {\n    if (row < 1) {\n        cellProperties.readOnly = false;\n        if (typeof Wptm.style.table.lock_columns !== 'undefined' && Wptm.style.table.lock_columns[col] != 0) {\n            cellProperties.readOnly = true;\n        }\n    }\n    if (Wptm.table_editing != '1' && row >= 1) {\n        cellProperties.readOnly = true;\n    }\n    return cellProperties;\n}\n\nfunction check_cell_readOnly(row, col, prop) {\n    var cellProperties = {};\n\n    if (window.Wptm.type === 'mysql') {\n        cellProperties = check_cell_readOnly_mysql(row, col, cellProperties);\n    }\n\n    if (!wptm_administrator) {\n        var lock_cell_id = [], not_lock_cell = false;\n        if (typeof table_function_data.protect_columns !== 'undefined'\n            && typeof table_function_data.protect_columns[col] !== 'undefined') {\n            //protect columns\n            lock_cell_id.push(table_function_data.protect_columns[col]);\n        }\n        if (typeof table_function_data.protect_rows !== 'undefined'\n            && typeof table_function_data.protect_rows[col] !== 'undefined') {\n            //protect rows\n            lock_cell_id.push(table_function_data.protect_rows[row]);\n        }\n        if (typeof Wptm.style.cells[row + \"!\" + col][2].lock_cell !== 'undefined') {\n            lock_cell_id.push(Wptm.style.cells[row + \"!\" + col][2].lock_cell);\n        }\n        if (lock_cell_id.length > 0 && typeof lock_cell_id[0] !== 'undefined'\n            && typeof table_function_data.lock_ranger_cells_user !== 'undefined') {\n            for (var ij in lock_cell_id) {\n                if (table_function_data.lock_ranger_cells_user[lock_cell_id[ij]]) {//allow edit\n                    not_lock_cell = true;\n                    break;\n                }\n            }\n            if (!not_lock_cell) {\n                cellProperties.readOnly = true;\n            }\n        }\n    }\n\n    return cellProperties;\n}\n\nfunction check_duplicate_ranger(value) {\n    var duplicate = [];\n    for (var i = 0; i < value.length; i++) {\n        if (i + 1 < value.length) {\n            var search = value.indexOf(value[i], i + 1);\n            if (search > 0) {\n                duplicate.push([i, search]);\n            }\n        }\n    }\n    return duplicate;\n}\n\nfunction merger_duplicate_ranger_user(duplicate, current_rangers, current_rangers_user) {\n    var current_rangers1 = [];\n    var current_rangers_user1 = [];\n    var ranger_user_1, ranger_user_2, ranger_user_new;\n    for (var i = 0; i < duplicate.length; i++) {\n        ranger_user_1 = current_rangers_user[duplicate[i][1]].split('|');\n        ranger_user_2 = current_rangers_user[duplicate[i][0]].split('|');\n        ranger_user_new = ranger_user_1.concat(ranger_user_2.filter((item) => ranger_user_1.indexOf(item) < 0));\n        current_rangers_user[duplicate[i][1]] = ranger_user_new.join('|');\n\n        current_rangers.splice(duplicate[i][0] - i, 1);\n        current_rangers1.push(duplicate[i][0]);\n    }\n    current_rangers_user1 = current_rangers_user.filter((value, index) => current_rangers1.indexOf(index) < 0);\n    return [current_rangers, current_rangers_user1];\n}\n\nfunction create_ranger_cells_lock(Wptm, table_function_data, update_rangers) {\n    var lock_ranger_cells_user;\n    // table_function_data.ranger_cells_lock_top = '';\n    // table_function_data.ranger_cells_lock_left = '';\n    // table_function_data.ranger_cells_lock_right = '';\n    // table_function_data.ranger_cells_lock_bottom = '';\n    table_function_data.lock_ranger_cells_user = [];\n    table_function_data.protect_columns = [];\n    table_function_data.protect_rows = [];\n    // table_function_data.render_first_cell_protect_has_icon = [];\n\n    if (typeof Wptm.style.table.lock_ranger_cells_user == 'undefined') {\n        Wptm.style.table.lock_ranger_cells_user = [];\n    }\n\n    var ij, enable_lock, value;\n    if (typeof Wptm.style.table.lock_ranger_cells === 'undefined' || Wptm.style.table.lock_ranger_cells.length < 1) {\n        return false;\n    }\n\n    if (update_rangers !== null) {\n        var current_rangers = [];\n        var current_ranger_cells_user = [];\n    }\n\n    var i;\n\n    for (i = 0; i < Wptm.style.table.lock_ranger_cells.length; i++) {\n        // table_function_data.render_first_cell_protect_has_icon[i] = true;\n        enable_lock = false;\n        table_function_data.lock_ranger_cells_user[i] = false;\n        if (typeof Wptm.style.table.lock_ranger_cells_user[i] !== 'undefined') {\n            lock_ranger_cells_user = Wptm.style.table.lock_ranger_cells_user[i].split('|');\n            if (lock_ranger_cells_user.indexOf(wptm_userRoles) !== -1) {//ok edit\n                table_function_data.lock_ranger_cells_user[i] = true;\n            } else if (!wptm_administrator) {\n                enable_lock = true;\n            }\n        }\n\n        value = Wptm.style.table.lock_ranger_cells[i].replace(/[ ]+/g, \"\").toUpperCase();\n        var arrayRange = value.split(\":\");\n\n        var check_value = 0;\n        if (arrayRange[0].replace(/[ |A-Za-z]+/g, \"\") === '') {\n            check_value = 1;//value A:B\n        } else if (arrayRange[0].replace(/[ |1-9]+/g, \"\") === '') {\n            check_value = 2;//value 8:9\n        }\n\n        var selection = [];\n        if (check_value === 0) {\n            if (typeof arrayRange[1] == 'undefined') {\n                arrayRange[1] = arrayRange[0];\n            }\n            selection.push(parseInt(arrayRange[0].split(/[ |A-Za-z]+/g)[1]) - 1);\n            selection.push(convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1);\n            selection.push(parseInt(arrayRange[1].split(/[ |A-Za-z]+/g)[1]) - 1);\n            selection.push(convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1);\n\n            if (update_rangers !== null) {\n                if (update_rangers.type === 'create_row') {\n                    if (selection[0] >= update_rangers.index) {//rows >= index\n                        if (selection[2] >= update_rangers.amount + update_rangers.index) {//index + amount <= after_col\n                            selection[2] = selection[2] + update_rangers.amount;\n                            selection[0] = update_rangers.amount + update_rangers.index >= selection[0] ? selection[0] : (selection[0] + update_rangers.amount);\n                        } else {//index + amount > after_col\n                            selection[2] = selection[2] + update_rangers.amount;\n                        }\n                    } else if (selection[0] < update_rangers.index && selection[2] >= update_rangers.index) {//row < index < after_row\n                        selection[2] = selection[2] + update_rangers.amount;\n                    }\n                }\n                if (update_rangers.type === 'delete_row') {\n                    if (selection[0] >= update_rangers.index) {//rows >= index\n                        if (update_rangers.amount + update_rangers.index >= selection[2]) {//remove all index + amount >= after_rows\n                            continue;\n                        }\n                        if ((update_rangers.amount + update_rangers.index) >= selection[0]\n                            && (update_rangers.amount + update_rangers.index) < selection[2]) {//index <= rows <= index + amount < after_rows\n                            selection[0] = update_rangers.index;\n                            selection[2] = selection[2] - update_rangers.amount;\n                        } else {//index + amount < rows\n                            selection[0] = selection[0] - update_rangers.amount;\n                            selection[2] = selection[2] - update_rangers.amount;\n                        }\n                    } else if (selection[0] < update_rangers.index && selection[2] >= update_rangers.index) {//rows < index < after_rows\n                        selection[2] = update_rangers.amount + update_rangers.index >= selection[2] ? (update_rangers.index - 1) : (selection[2] - update_rangers.amount);\n                    }\n                }\n                if (update_rangers.type === 'add_col') {\n                    if (selection[1] > update_rangers.index) {//col >= index\n                        if (selection[3] >= update_rangers.amount + update_rangers.index) {//index + amount <= after_col\n                            selection[3] = selection[3] + update_rangers.amount;\n                            selection[1] = update_rangers.amount + update_rangers.index >= selection[1] ? selection[1] : (selection[1] + update_rangers.amount);\n                        } else {//index + amount > after_col\n                            selection[3] = selection[3] + update_rangers.amount;\n                        }\n                    } else if (selection[1] < update_rangers.index && selection[3] >= update_rangers.index) {//row < index < after_row\n                        selection[3] = selection[3] + update_rangers.amount;\n                    }\n                }\n                if (update_rangers.type === 'delete_col') {\n                    if (selection[1] >= update_rangers.index) {//col >= index\n                        if (update_rangers.amount + update_rangers.index >= selection[3]) {//remove all index + amount >= after_col\n                            continue;\n                        }\n                        if ((update_rangers.amount + update_rangers.index) >= selection[1]\n                            && (update_rangers.amount + update_rangers.index) < selection[3]) {//index <= col <= index + amount < after_col\n                            selection[1] = update_rangers.index;\n                            selection[3] = selection[3] - update_rangers.amount;\n                        } else {//index + amount < col\n                            selection[1] = selection[1] - update_rangers.amount;\n                            selection[3] = selection[3] - update_rangers.amount;\n                        }\n                    } else if (selection[1] < update_rangers.index && selection[3] >= update_rangers.index) {//col < index < after_col\n                        selection[3] = update_rangers.amount + update_rangers.index >= selection[3] ? (update_rangers.index - 1) : (selection[3] - update_rangers.amount);\n                    }\n                }\n\n                current_rangers.push(getSelectedVal(selection));\n                if (typeof Wptm.style.table.lock_ranger_cells_user[i] !== 'undefined') {\n                    current_ranger_cells_user.push(Wptm.style.table.lock_ranger_cells_user[i]);\n                }\n            }\n\n            for (ij = selection[0]; ij <= selection[2]; ij++) {//row\n                for (var ij2 = selection[1]; ij2 <= selection[3]; ij2++) {\n                    if (typeof Wptm.style.cells[ij + '!' + ij2] !== 'undefined') {\n                        Wptm.style.cells[ij + '!' + ij2][2] = window.jquery.extend(Wptm.style.cells[ij + '!' + ij2][2], {lock_cell: i});\n                    }\n                }\n            }\n        } else if (check_value === 1) {//columns\n            selection.push(convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1);\n            selection.push(convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1);\n\n            if (update_rangers !== null) {\n                if (update_rangers.type === 'add_col') {\n                    if (selection[0] >= update_rangers.index) {//col >= index\n                        selection[1] = selection[1] + update_rangers.amount;\n                        selection[0] = update_rangers.amount + update_rangers.index >= selection[0] ? selection[0] : (selection[0] + update_rangers.amount);\n                    }\n                    if (selection[0] < update_rangers.index && selection[1] >= update_rangers.index) {//row < index < after_row\n                        selection[1] = selection[1] + update_rangers.amount;\n                    }\n                }\n                if (update_rangers.type === 'delete_col') {\n                    if (selection[0] >= update_rangers.index) {//col >= index\n                        if (update_rangers.amount + update_rangers.index >= selection[1]) {//remove all\n                            continue;\n                        }\n                        if (update_rangers.amount + update_rangers.index < selection[0]) {\n                            selection[0] = selection[0] - update_rangers.amount;\n                            selection[1] = selection[1] - update_rangers.amount;\n                        } else {\n                            selection[0] = update_rangers.index;\n                            selection[1] = selection[1] - update_rangers.amount - update_rangers.index;\n                        }\n                    }\n                    if (selection[0] < update_rangers.index && selection[1] >= update_rangers.index) {//col < index < after_col\n                        selection[1] = update_rangers.amount + update_rangers.index >= selection[1] ? (update_rangers.index - 1) : (selection[1] - update_rangers.amount);\n                    }\n                }\n\n                current_rangers.push(getSelectedVal([false, selection[0], false, selection[1]]));\n                if (typeof Wptm.style.table.lock_ranger_cells_user[i] !== 'undefined') {\n                    current_ranger_cells_user.push(Wptm.style.table.lock_ranger_cells_user[i]);\n                }\n            }\n\n            for (ij = selection[0]; ij <= selection[1]; ij++) {\n                table_function_data.protect_columns[ij] = i;\n            }\n        } else {//rows\n            selection.push(parseInt(arrayRange[0].split(/[ |A-Za-z]+/g)[0]) - 1);\n            selection.push(parseInt(arrayRange[1].split(/[ |A-Za-z]+/g)[0]) - 1);\n\n            if (update_rangers !== null) {\n                if (update_rangers.type === 'create_row') {\n                    if (selection[0] >= update_rangers.index) {//col >= index\n                        selection[1] = selection[1] + update_rangers.amount;\n                        selection[0] = update_rangers.amount + update_rangers.index >= selection[0] ? selection[0] : (selection[0] + update_rangers.amount);\n                    }\n                    if (selection[0] < update_rangers.index && selection[1] >= update_rangers.index) {//row < index < after_row\n                        selection[1] = selection[1] + update_rangers.amount;\n                    }\n                }\n                if (update_rangers.type === 'delete_row') {\n                    if (selection[0] >= update_rangers.index) {//col >= index\n                        if (update_rangers.amount + update_rangers.index >= selection[1]) {//remove all\n                            continue;\n                        }\n                        if (update_rangers.amount + update_rangers.index < selection[0]) {\n                            selection[0] = selection[0] - update_rangers.amount;\n                            selection[1] = selection[1] - update_rangers.amount;\n                        } else {\n                            selection[0] = update_rangers.index;\n                            selection[1] = selection[1] - update_rangers.amount - update_rangers.index;\n                        }\n                    }\n                    if (selection[0] < update_rangers.index && selection[1] >= update_rangers.index) {//col < index < after_col\n                        selection[1] = update_rangers.amount + update_rangers.index >= selection[1] ? (update_rangers.index - 1) : (selection[1] - update_rangers.amount);\n                    }\n                }\n\n                current_rangers.push(getSelectedVal([selection[0], false, selection[1], false]));\n                if (typeof Wptm.style.table.lock_ranger_cells_user[i] !== 'undefined') {\n                    current_ranger_cells_user.push(Wptm.style.table.lock_ranger_cells_user[i]);\n                }\n            }\n\n            for (ij = selection[0]; ij <= selection[1]; ij++) {\n                table_function_data.protect_rows[ij] = i;\n            }\n        }\n    }\n    ;\n\n    if (update_rangers !== null) {\n        Wptm.style.table.lock_ranger_cells = jquery.extend([], current_rangers);\n        Wptm.style.table.lock_ranger_cells_user = jquery.extend([], current_ranger_cells_user);\n        // render_css_lock(Wptm, table_function_data);\n    }\n}\n\nfunction render_css_lock(Wptm, table_function_data) {\n    var column_i;\n    var css_lock_columns = '';\n    var $wptm_add_css_lock_columns = document.getElementById('wptm_add_css_lock_columns');\n\n    // if (typeof table_function_data.ranger_cells_lock_top !== 'undefined' && table_function_data.ranger_cells_lock_top !== '') {\n    //     css_lock_columns += table_function_data.ranger_cells_lock_top + '{border-top: 1px solid #4b89ff !important;}'\n    // }\n    // if (typeof table_function_data.ranger_cells_lock_bottom !== 'undefined' && table_function_data.ranger_cells_lock_bottom !== '') {\n    //     css_lock_columns += table_function_data.ranger_cells_lock_bottom + '{border-bottom: 1px solid #4b89ff !important;}'\n    // }\n    // if (typeof table_function_data.ranger_cells_lock_left !== 'undefined' && table_function_data.ranger_cells_lock_left !== '') {\n    //     css_lock_columns += table_function_data.ranger_cells_lock_left + '{border-left: 1px solid #4b89ff !important;}'\n    // }\n    // if (typeof table_function_data.ranger_cells_lock_right !== 'undefined' && table_function_data.ranger_cells_lock_right !== '') {\n    //     css_lock_columns += table_function_data.ranger_cells_lock_right + '{border-right: 1px solid #4b89ff !important;}'\n    // }\n\n    if (typeof Wptm.style.table.lock_columns !== 'undefined') {\n        for (column_i in Wptm.style.table.lock_columns) {\n            if (Wptm.style.table.lock_columns[column_i] != 0) {\n                column_i = parseInt(column_i);\n                css_lock_columns += ' .handsontable table thead th:nth-child(' + (column_i + 2) + ') {position: relative;} ';\n                css_lock_columns += ' .handsontable table thead th:nth-child(' + (column_i + 2) + '):after {content: \"lock\";} ';\n            }\n        }\n    }\n\n\n    setTimeout(function () {\n        if (css_lock_columns !== '') {\n            $wptm_add_css_lock_columns.innerHTML = css_lock_columns;\n            $wptm_add_css_lock_columns.cssText = css_lock_columns;\n        }\n    }, 100);\n}\n\nfunction check_collide_two_range(selection1, selection2) {\n    if ((Math.abs(selection1[0] - selection2[0]) < Math.abs(selection1[2] - selection1[0] + selection2[2] - selection2[0]) / 2)\n        && (Math.abs(selection1[1] - selection2[1]) < Math.abs(selection1[3] - selection1[1] + selection2[3] - selection2[1]) / 2)\n    ) {\n        return true;\n    }\n    return false;\n}\n\nfunction input_not_negative(value, name, min, max) {\n    var input_not_negative = ['cell_font_size', 'col_width', 'row_height', 'table_height'];\n    if (input_not_negative.includes(name)) {\n        if ((min !== null && value < min) || (max !== null && value > max)) {\n            return true;\n        }\n    }\n    return false;\n}\n\nfunction wptmBootbox(headrText, bodyText, doneButton, cancelButton, submitCallFunction, cancelCallFunction, type) {\n    var popup = {\n        'html': wptm_element.content_popup_hide.find('#wptm_bootbox'),\n        'showAction': function () {\n            if (headrText !== '') {\n                this.find('.popup_top span').text(headrText);\n            } else {\n                this.find('.popup_top').hide();\n            }\n            if (bodyText !== '') {\n                this.find('.control-group span').html(bodyText);\n            } else {\n                this.find('.control-group').hide();\n            }\n            if (doneButton === false) {\n                this.find('#popup_done').hide();\n            } else if (typeof doneButton === 'string') {\n                this.find('#popup_done').val(doneButton);\n            }\n            if (cancelButton === false) {\n                this.find('#popup_cancel').hide();\n            } else if (typeof cancelButton === 'string') {\n                this.find('#popup_cancel').val(cancelButton);\n            }\n            if (typeof type !== 'undefined') {\n                switch (type) {\n                    case 'warning':\n                        this.find('.control-group').css({'line-height': 1})\n                        this.find('.control-group span').css({'font-weight': 300})\n                        break\n                    default:\n                        break\n                }\n            }\n            return true;\n        },\n        'submitAction': function () {\n            if (typeof submitCallFunction !== 'undefined' && submitCallFunction !== null) {\n                submitCallFunction.call();\n            }\n            wptm_element.wptm_popup.animate({'opacity': '0'}, 10);\n            setTimeout(function () {\n                wptm_element.wptm_popup.hide();\n                wptm_element.wptm_popup.siblings('#over_popup').hide();\n                return true;\n            }, 200);\n        },\n        'cancelAction': function () {\n            if (typeof cancelCallFunction !== 'undefined' && cancelCallFunction !== null) {\n                cancelCallFunction.call();\n            }\n            return true;\n        }\n    };\n    selectOption.wptm_popup(wptm_element.wptm_popup, popup, true, false, false);\n}\n\nfunction WptmLoading(that, stop, start, timeOut, text = null, status = '') {\n    that.addClass('show').attr('data-status', status);\n    var c = start;\n    var $counter = that.find(\".counter h5\");\n    var $hr = that.find(\".counter hr\");\n    if (text) {\n        $counter.text(text);\n    }\n\n    var loadingInterval = setInterval(() => {\n        if (!text && status === '') {\n            $counter.text(c + \"%\");\n        }\n        $hr.css(\"width\", c + \"%\");\n        start++;\n        c++;\n\n        if (start >= stop) {\n            clearInterval(loadingInterval);\n        }\n    }, timeOut);\n}\n\nfunction wptmSetZoom(zoom, reset) {\n    if (zoom) {\n        zoom = parseFloat(zoom)\n    } else {\n        return false\n    }\n\n    const elements = [\n        ['.handsontableInputHolder', '', '', 1],\n        ['.ht_master', '', '', '.wtHider'],\n        ['.ht_clone_top', 'ht_clone_top', '', '.wtHider'],\n        ['.manualColumnResizer', '', '', 1],\n        ['.ht_clone_left', '', 'ht_clone_left', '.wtHider'],\n        ['.manualRowResizer', '', '', 1],\n        ['.ht_clone_top_left_corner', 'ht_clone_top_left_corner', 'ht_clone_top_left_corner', '.wtHider']\n    ]\n\n    var p = [\"webkit\", \"moz\", \"ms\", \"o\"],\n        content = '';\n    const zoomsize = zoom / (table_function_data.zoom || 1)\n\n    // console.group()\n    if (zoomsize !== 1) {\n        jquery.each(elements, (i, v) => {\n            let $parent_element = wptm_element.tableContainer.find(v[0])\n\n            if ($parent_element.length > 0) {\n                // console.log(v, $parent_element.outerHeight(), $parent_element.outerWidth())\n\n                if (v[1] !== '') {\n                    content += '#tableContainer .' + v[1] + '{height: ' + (zoomsize * $parent_element.outerHeight()) + 'px !important;}'\n                    if ($parent_element.find('.wtHolder'))\n                        content += '#tableContainer .' + v[1] + ' .wtHolder {height: ' + (zoomsize * $parent_element.outerHeight()) + 'px !important;}'\n                }\n                if (v[2] !== '') {\n                    content += '#tableContainer .' + v[2] + '{width: ' + (zoomsize * $parent_element.outerWidth()) + 'px !important;}'\n                    if ($parent_element.find('.wtHolder'))\n                        content += '#tableContainer .' + v[2] + ' .wtHolder {width: ' + (zoomsize * $parent_element.outerWidth()) + 'px !important;}'\n                }\n            }\n\n            if (v[3] !== '') {\n                let $wtHider = v[3] !== 1 ? $parent_element.find(v[3]) : $parent_element\n                content += '#tableContainer ' + v[0] + (v[3] !== 1 ? (' ' + v[3]) : '') + ' {transform-origin: 0% 0%;}'\n                content += '#tableContainer ' + v[0] + (v[3] !== 1 ? (' ' + v[3]) : '') + ' {transform: scale(' + zoom + ');}'\n\n                for (var i1 = 0; i1 < p.length; i1++) {\n                    if ($wtHider.length > 0) {\n                        $wtHider[0].style[p[i1] + \"Transform\"] = \"scale(\" + zoom + \")\";\n                        $wtHider[0].style[p[i1] + \"TransformOrigin\"] = '0% 0%';\n                    }\n                }\n            }\n        })\n    }\n\n    // console.log(zoom, zoomsize)\n    // console.groupEnd()\n    if (content !== '') {\n        var parser = new (less.Parser)\n        parser.parse(content, function (err, tree) {\n            if (err) {\n                //Here we can throw the erro to the user\n                return false;\n            } else {\n                if (jquery('head').find('.wptmHeadCssZoom').length < 1)\n                    jquery('head').append('<style class=\"wptmHeadCssZoom\"></style>');\n\n                if (reset === true) {\n                    jquery('.wptmHeadCssZoom').text('')\n                } else {\n                    jquery('.wptmHeadCssZoom').text(tree.toCSS())\n                }\n            }\n        });\n    }\n\n    if (zoom)\n        table_function_data.zoom = zoom\n}\n\nfunction unsafeRedactName(text, name) {\n    return text.replace(new RegExp(name, \"g\"), \",\");\n}\n\nfunction wptmCollapsible() {\n    jquery('.wptmCollapsible').unbind('click').on('click', function() {\n        this.classList.toggle(\"active\");\n        var content = this.nextElementSibling;\n        if (jquery(content).hasClass('wptm_show')) {\n            jquery(content).animate({'opacity': '0', height: \"hide\"}, 1000, function() {\n                jquery(this).removeClass('wptm_show')\n            })\n        } else {\n            jquery(content).animate({'opacity': '1', height: \"show\"}, 1000, function() {\n                jquery(this).addClass('wptm_show')\n            })\n        }\n    });\n}\n\nfunction wptm_tooltip(that) {\n    jquery(that).find('.wptm_tooltip').each(function (i, e) {\n        let content = jquery(e).data(\"tooltip_text\")\n            ? jquery(e).data(\"tooltip_text\")\n            : (jquery(e).data(\"tooltip_img\") ? '<img src=\"' + jquery(e).data(\"tooltip_img\") + '\"/>' : '')\n        jquery(e).tipso({\n            useTitle: false,\n            tooltipHover: true,\n            background: \"#000000\",\n            color: \"#ffffff\",\n            offsetY: 0,\n            width: 150,\n            content: '<span class=\"wptm_tooltipcontent\">' + content + '</span>',\n            onShow: function (ele, tipso, obj) {\n                //calculate top tipso_bubble when set width\n                var size = realHeight(obj.tooltip());\n                jquery(obj.tipso_bubble[0]).css(\n                    \"top\",\n                    obj.tipso_bubble[0].offsetTop +\n                    (size.height - obj.tipso_bubble.outerHeight())\n                );\n            },\n        });\n    });\n\n    function realHeight(obj) {\n        var clone = obj.clone();\n        clone.css(\"visibility\", \"hidden\");\n        jquery(\"body\").append(clone);\n        var height = clone.outerHeight();\n        var width = clone.outerWidth();\n        clone.remove();\n        return {\n            width: width,\n            height: height,\n        };\n    }\n}\n\n/*col = [start, end], row = [start, end], ranger = [seelctions[0]]*/\nfunction getRangercells(col, row, ranger = null) {\n    let min, max\n    if (ranger !== null) {\n\n    } else {\n\n    }\n\n\n    return [min, max]\n}\n\nexport default {\n    eventToCellsSelected,\n    unsafeRedactName,\n    setText,\n    updateSwitchButtonFromStyleObject,\n    updateParamFromStyleObject,\n    updateParamFromStyleObjectSelectBox,\n    checkObjPropertyNested,\n    calculateTableHeight,\n    convertStringToNumber,\n    getSelectedVal,\n    checkObjPropertyNestedNotEmpty,\n    autosaveNotification,\n    cleanHandsontable,\n    warning_edit_db_table,\n    saveChanges,\n    cell_type_to_column,\n    deleteRowDbTable,\n    createRowDbTable,\n    validate_type_cell,\n    change_value_cells,\n    default_sortable,\n    convertAlpha,\n    convertDate,\n    formatSymbols,\n    getSizeCells,\n    changeValue,\n    pullDims,\n    pushDims,\n    getFillArray,\n    fillArray,\n    removeValueInArray,\n    responsive_col,\n    createRegExpFormat,\n    replaceCell,\n    loading,\n    rloading,\n    wptm_clone,\n    parseCss,\n    getCellData,\n    stringReplace,\n    showChartOrTable,\n    ripple_button,\n    combineChangedCellIntoRow,\n    isSameArray,\n    mergeCollsRowsstyleToCells,\n    setFormat_accounting,\n    updateStyleAutofill,\n    setPositionForHtmlCellEditor,\n    hashFnv32a,\n    copy_text,\n    getLinkSync,\n    momentjsFormat,\n    setFormat_accounting_for_cells,\n    createRegExpFormatForCell,\n    checkCellsOptionsValidate,\n    status_notic,\n    check_cell_readOnly,\n    check_duplicate_ranger,\n    merger_duplicate_ranger_user,\n    create_ranger_cells_lock,\n    check_collide_two_range,\n    render_css_lock,\n    input_not_negative,\n    droptablesCheckSize,\n    wptmBootbox,\n    WptmLoading,\n    wptmSetZoom,\n    wptmCollapsible,\n    wptm_tooltip\n}","//setTimeout change height table by rows height\nimport tableFunction from \"./_functions\";\nimport selectOption from \"./_toolbarOptions\";\nimport customRenderer from \"./_customRenderer\";\nimport DropChart from \"./_chart\";\n\n/**\n * Call handsontable lib\n *\n * @param datas Wptm.datas\n */\nfunction initHandsontable(datas) {\n    var checkScroll = false;\n    var autoScroll;\n    window.Wptm.container = window.wptm_element.tableContainer;\n    var modifyRow = null;\n    var totalRows = datas.length;\n    var copyHeightRow = false;\n\n    window.Wptm.container.handsontable({\n        data: datas,\n        startRows: 5,\n        startCols: 5,\n        editor: window.CustomEditor,\n        search: true,\n        renderAllRows: false,\n        fillHandle: ((window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)) && window.Wptm.type === 'html') ? {\n            autoInsertRow:false,\n        } : false,\n        modifyAutofillRange: function (startArea, entireArea) {//entireArea is start ranger\n            var directionFill = -1;//-1 is not fill, 0 is top, 1 is bottom, 2 is left, 3 is right\n            var new_range = [startArea[0], startArea[1], startArea[2], startArea[3]];\n\n            if (startArea[0] !== entireArea[0]) {\n                directionFill = 0;\n                new_range[2] = entireArea[0] - 1;\n            } else if (startArea[2] !== entireArea[2]) {\n                directionFill = 1;\n                new_range[0] = entireArea[2] + 1;\n            } else if (startArea[1] !== entireArea[1]) {\n                directionFill = 2;\n                new_range[3] = entireArea[1] - 1;\n            } else if (startArea[3] !== entireArea[3]) {\n                directionFill = 3;\n                new_range[1] = entireArea[3] + 1;\n            }\n\n            if (directionFill > -1) {\n                //update cell type, hyperlink\n                tableFunction.updateStyleAutofill(entireArea, new_range, directionFill);\n            }\n        },\n        copyPaste: true,\n        beforePaste: (data, coords) => {\n            tableFunction.saveChanges(true)\n            //vcl, asynchronous\n        },\n        beforeCopy: (data, coords) => {\n            var selection = table_function_data.selection[0];\n            table_function_data.copyData = [];\n            table_function_data.copyWidthCols = [];\n            table_function_data.copyTypeCols = [];\n            table_function_data.copyHeightRows = [];\n            table_function_data.copyMergeCells = [];\n            table_function_data.copyDataSelection = [selection[2] - selection[0], selection[3] - selection[1]];//[row, col]\n            table_function_data.copyHeightRow = [];\n            table_function_data.createCellWhenCopy = [];\n            jquery.map(window.Wptm.style.rows, function (v) {\n                table_function_data.copyHeightRow.push(v[1].height);\n            });\n\n            var i2 = 0, j2;\n            for (var i = selection[0]; i <= selection[2]; i++) {//row\n                j2 = 0;\n                for (var j = selection[1]; j <= selection[3]; j++) {\n                    if (typeof Wptm.style.cells[i + '!' + j] !== 'undefined') {\n                        table_function_data.copyData[i2 + '!' + j2] = window.jquery.extend({}, Wptm.style.cells[i + '!' + j][2]);\n\n                        if (typeof Wptm.newSelect !== 'undefined') {\n                            if (Wptm.newSelect === 'row' && typeof Wptm.style.rows[i][1] !== 'undefined') {\n                                table_function_data.copyHeightRows[i2 + '!'] = Wptm.style.rows[i][1].height;\n                            }\n                            if (Wptm.newSelect === 'col' && typeof Wptm.style.cols[j][1] !== 'undefined') {\n                                table_function_data.copyWidthCols[j2 + '!'] = Wptm.style.cols[j][1].width;\n                                table_function_data.copyTypeCols[j2 + '!'] = Wptm.style.table.col_types[j];\n                            }\n                        }\n\n                        delete table_function_data.copyData[i2 + '!' + j2].AlternateColor;\n                        delete table_function_data.copyData[i2 + '!' + j2].lock_cell;\n                        delete table_function_data.copyData[i2 + '!' + j2].width;\n                        delete table_function_data.copyData[i2 + '!' + j2].height;\n                    }\n                    j2++;\n                }\n                i2++;\n            }\n\n            //check merge cells\n            jquery.map(Wptm.mergeCellsSetting, function (v) {\n                if (v.col >= selection[1] && v.row >= selection[0]) {\n                    if ((v.col + v.colspan - 1) <= selection[3] && (v.row + v.rowspan - 1) <= selection[2]) {\n                        table_function_data.copyMergeCells[(v.row - selection[0]) + '!' + (v.col - selection[1])] = [v.rowspan - 1, v.colspan - 1];\n                    }\n                }\n            });\n        },\n        afterCopy: function (data, coords) {\n        },\n        afterPaste: function (data, coords) {\n        },\n        colHeaders: true,\n        rowHeaders: true,\n        autoRowSize: false,\n        autoColSize: false,\n        renderer: customRenderer.render,\n        // beforeOnCellMouseDown: function() {//event mouse down\n        // },\n        height: tableFunction.calculateTableHeight(window.jquery('#wptm-toolbars')),\n        afterInit: function () {\n            DropChart.functions.loadCharts();\n            Wptm.container.handsontable(\"selectCell\", 0, 0, 0, 0);\n            window.table_function_data.firstRender = true;\n\n            tableFunction.render_css_lock(Wptm, table_function_data);\n        },\n        beforeRender: function (isForced) {\n            Wptm.style.table.fonts_used = window.jquery.extend([], []);\n            Wptm.style.table.fonts_local_used = window.jquery.extend([], []);\n            window.table_function_data.styleToRender = '';\n        },\n        beforeChange: function (changes, source) {\n            if (source === 'auto_convert_data') {\n                return;\n            }\n            var paste_start = [changes[0][0], changes[0][1]];\n            var paste_x = 0, paste_y = 0, before_next_row;\n            copyHeightRow = false;\n            var updateSettings = {};\n            var cols_selected = [];\n            var number_cols = changes.length / (changes[changes.length - 1][0] - changes[0][0] + 1);\n            var mergeCellsSetting = jquery.extend([], window.Wptm.mergeCellsSetting);\n\n            for (var i = 0; i < changes.length; i++) {\n                before_next_row = false;\n                if ((i + 1) % number_cols === 0) {\n                    before_next_row = true;\n                }\n                var optionsCell = changes[i];\n\n                //paste style options cells\n                if (source === 'CopyPaste.paste' && typeof table_function_data.copyDataSelection !== \"undefined\" && table_function_data.copyDataSelection[0] >= 0) {\n                    // optionsCell\n                    if (optionsCell[0] - paste_start[0] > table_function_data.copyDataSelection[0]) {//row\n                        paste_y = 0;\n                    }\n                    if (optionsCell[1] - paste_start[1] > table_function_data.copyDataSelection[1]) {//col\n                        paste_x = 0;\n                    }\n                    if (typeof (window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]]) === 'undefined') {\n                        window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]] = [optionsCell[0], optionsCell[1], {}];\n                        table_function_data.createCellWhenCopy[optionsCell[0] + '!' + optionsCell[1]] = optionsCell[0] + '!' + optionsCell[1];\n                    }\n                    if (table_function_data.copyData[paste_y + '!' + paste_x].cell_type === 'html') {\n                        setTimeout((optionsCell) => {\n                            saveData.push({action: 'set_cells_type', selection: [[optionsCell[0], optionsCell[1], optionsCell[0], optionsCell[1]]], style: {cell_type: 'html'}});\n                        }, 300, optionsCell);\n                    } else {\n                        if (window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2].cell_type === 'html') {\n                            setTimeout((optionsCell) => {\n                                saveData.push({action: 'set_cells_type', selection: [[optionsCell[0], optionsCell[1], optionsCell[0], optionsCell[1]]], style: {cell_type: null}});\n                            }, 300, optionsCell);\n                        }\n                    }\n                    // window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2] = window.jquery.extend({}, window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2], table_function_data.copyData[paste_y + '!' + paste_x]);\n                    let cellParams = {}\n                    if (typeof window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]] !== 'undefined' && typeof window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2].AlternateColor !== \"undefined\")\n                        cellParams.AlternateColor = window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2].AlternateColor;\n\n                    window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2] = window.jquery.extend({}, cellParams, table_function_data.copyData[paste_y + '!' + paste_x]);\n\n                    if (typeof table_function_data.copyHeightRows !== 'undefined' && table_function_data.copyHeightRows[paste_y + '!'] > 0) {\n                        if (typeof (window.Wptm.style.rows[optionsCell[0]]) === 'undefined') {\n                            window.Wptm.style.rows[optionsCell[0]] = [optionsCell[0], {}];\n                        }\n                        window.Wptm.style.rows[optionsCell[0]][1].height = table_function_data.copyHeightRows[paste_y + '!'];\n                        table_function_data.copyHeightRow[optionsCell[0]] = table_function_data.copyHeightRows[paste_y + '!'];\n                        copyHeightRow = true;\n                    }\n                    if (typeof table_function_data.copyWidthCols !== 'undefined' && table_function_data.copyWidthCols[paste_x + '!'] > 0) {\n                        if (typeof (window.Wptm.style.cols[optionsCell[1]]) === 'undefined') {\n                            window.Wptm.style.cols[optionsCell[1]] = [optionsCell[1], {}];\n                            window.Wptm.style.cols[optionsCell[1]][1].res_priority = 0;\n                        }\n\n                        window.Wptm.style.cols[optionsCell[1]][1].width = table_function_data.copyWidthCols[paste_x + '!'];\n                    }\n\n                    if (typeof table_function_data.copyTypeCols !== 'undefined' && table_function_data.copyTypeCols[paste_x + '!']) {\n                        Wptm.style.table.col_types[optionsCell[1]] = 'text';\n                        cols_selected[optionsCell[1]] = 'text';\n                    }\n\n                    if (typeof table_function_data.copyMergeCells !== 'undefined' && typeof table_function_data.copyMergeCells[paste_y + '!' + paste_x] !== 'undefined') {\n                        mergeCellsSetting.push({\n                            col: optionsCell[1],\n                            colspan: table_function_data.copyMergeCells[paste_y + '!' + paste_x][1] + 1,\n                            row: optionsCell[0],\n                            rowspan: table_function_data.copyMergeCells[paste_y + '!' + paste_x][0] + 1\n                        });\n\n                        updateSettings.mergeCells = mergeCellsSetting;\n                    }\n\n                    setTimeout((optionsCell, changes, i, updateSettings, copyHeightRow) => {\n                        saveData.push({action: 'style',\n                            selection: [[optionsCell[0], optionsCell[1], optionsCell[0], optionsCell[1]]],\n                            style: window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2]\n                        });\n\n                        if (i + 1 === changes.length) {\n                            if (copyHeightRow) {\n                                updateSettings.manualRowResize = table_function_data.copyHeightRow;\n                            }\n\n                            if (tableFunction.droptablesCheckSize(updateSettings) > 0) {\n                                Wptm.container.handsontable('updateSettings', updateSettings);\n                            }\n                        }\n                    }, 300, optionsCell, changes, i, updateSettings, copyHeightRow);\n                    paste_x++;\n\n                    if (i + 1 === changes.length) {\n                        if (tableFunction.droptablesCheckSize(cols_selected) > 0) {\n                            if (saveData[0] && saveData[0].action === 'create_col_after_paste') {\n                                saveData.splice(1, 0, {\n                                    action: 'set_columns_types_copy',\n                                    value: cols_selected\n                                })\n                            } else {\n                                saveData.unshift({\n                                    action: 'set_columns_types_copy',\n                                    value: cols_selected\n                                });\n                            }\n                        }\n                    }\n\n                    if (before_next_row) {\n                        paste_y++;\n                        paste_x = 0;\n                    }\n                }\n\n                //check validate chart\n                if (jquery('#list_chart').find('.chart-menu').length > 0) {//check chart exist\n                    if (!DropChart.functions.validateCharts(optionsCell)) {\n                        tableFunction.wptmBootbox('', wptmText.CHANGE_INVALID_CHART_DATA, true, false);\n                        return false;\n                    }\n                }\n            }\n        },\n        afterRender: function (isForced) {\n            var parser = new (less.Parser);\n            var Wptm = window.Wptm;\n            var $ = window.jquery;\n            window.table_function_data.content = '#mainTabContent .handsontable .ht_master .htCore {' + window.table_function_data.styleToRender + '}';\n            if (Wptm.style.table.responsive_type == 'scroll' && Wptm.style.table.freeze_row) {\n                window.table_function_data.content += ' #mainTabContent .handsontable .ht_clone_top .htCore {' + window.table_function_data.styleToRender + '}';\n            }\n            if (Wptm.style.table.responsive_type == 'scroll' && Wptm.style.table.freeze_col) {\n                window.table_function_data.content += ' #mainTabContent .handsontable .ht_clone_left .htCore {' + window.table_function_data.styleToRender + '}';\n            }\n            if (Wptm.style.table.responsive_type == 'scroll' && Wptm.style.table.freeze_row && Wptm.style.table.freeze_col) {\n                window.table_function_data.content += ' #mainTabContent .handsontable .ht_clone_corner .htCore {' + window.table_function_data.styleToRender + '}';\n            }\n\n            // await parser.parse(window.table_function_data.content, function (err, tree) {\n            parser.parse(window.table_function_data.content, function (err, tree) {\n                if (err) {\n                    //Here we can throw the error to the user\n                    return false;\n                } else {\n                    Wptm.css = $('#jform_css').val();\n                    if ($('#headMainCss').length === 0) {\n                        $('head').append('<style id=\"headMainCss\"></style>');\n                    }\n                    $('#headMainCss').text(tree.toCSS());\n                    return true;\n                }\n            });\n\n            if ($('#content_popup_hide').find('select.select_columns option').length < 1) {\n                // Build column selection for default sort parameter\n                tableFunction.default_sortable(window.Wptm.datas);\n            }\n            //set Wptm.style.rows , Wptm.style.cols value\n            tableFunction.pushDims($, Wptm);\n\n            if (table_function_data.needSaveAfterRender === true) {\n                tableFunction.saveChanges();\n                table_function_data.needSaveAfterRender = false;\n            }\n\n            Wptm.style.table.class_name && $('#tableContainer').addClass(Wptm.style.table.class_name);\n        },\n        afterChange: function (change, source) {//play when change content cell\n            table_function_data.copyWidthCols = [];\n            if (source === 'CopyPaste.paste') {\n                table_function_data.createCellWhenCopy = [];\n                table_function_data.copyHeightRows = [];\n                table_function_data.copyHeightRow = [];\n            }\n\n            if (typeof table_function_data.data_argument !== 'undefined' && source === 'loadData') {\n                source = 'edit';\n                change = jquery.extend([], table_function_data.data_argument);\n            }\n\n            //fix handsontable merge cells remove data of cells\n            if ((source === 'MergeCells' || source === 'populateFromArray')&& typeof change.length !== 'undefined') {\n                for (i = 0; i < change.length; i++) {\n                    if (change[i][2] !== null && change[i][3] === null) {\n                        Wptm.datas[change[i][0]][change[i][1]] = change[i][2];\n                    }\n                }\n            }\n\n            if (source === 'populateFromArray' && change.length > 0 && change[0][2] === change[0][3]) {\n                tableFunction.cleanHandsontable();\n            }\n\n            if (source === 'loadData' || source === 'populateFromArray' || !(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n                return; //don't save this change\n            }\n            var action = ['CopyPaste.paste', 'edit', 'UndoRedo.undo', 'UndoRedo.redo', 'Autofill.fill', 'setDataAtCell'];\n\n            //validate data cells when mergeCells\n            if (change) {\n                var i;\n                var notSaveData;\n                var editHeader = false;\n                var mysql_column_edit, mysql_column_key;\n\n                for (i = 0; i < change.length; i++) {\n                    if (action.includes(source)) {\n                        notSaveData = true;\n                        if (typeof change[i][3] === 'undefined' || change[i][3] === 'wptm_change_value_after_set_columns_types') {\n                            change[i][3] = change[i][2];//loadData when edit cells > 5ommit\n                            notSaveData = false;\n                        }\n                        if (change[i][3] === change[i][4]) {\n                            notSaveData = false;\n                        }\n\n                        var optionsCell = change[i];\n\n                        if (typeof Wptm.headerOption == 'undefined' || optionsCell[0] >= Wptm.headerOption) {//check cell in table header\n                            if (typeof optionsCell[3] !== 'undefined' && optionsCell[3] !== null) {\n                                var value = tableFunction.cell_type_to_column(optionsCell, optionsCell[3]);\n                                var value_change;\n                                if (value === false) {\n                                    wptm_element.mainTabContent.find('td.dtr' + optionsCell[0] + '.dtc' + optionsCell[1]).addClass('invalid_data');\n                                    tableFunction.wptmBootbox('', wptmText.CHANGE_INVALID_CELL_DATA, true, false);\n                                    return;\n                                } else {\n                                    wptm_element.mainTabContent.find('td.dtr' + optionsCell[0] + '.dtc' + optionsCell[1]).removeClass('invalid_data');\n                                    if (value !== true) {\n                                        if (notSaveData) {\n                                            if (Wptm.type !== 'mysql') {\n                                                if (window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]]\n                                                    && window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2]\n                                                    && window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2].cell_type === 'html')\n                                                    saveData.push({action: 'edit_cell_html', row: optionsCell[0], col: optionsCell[1], content: value});\n                                                else\n                                                    saveData.push({action: 'edit_cell', row: optionsCell[0], col: optionsCell[1], content: value});\n                                            } else if ( Wptm.query_option.column_options !== null && typeof Wptm.query_option.column_options[optionsCell[1]] !== \"undefined\") {\n                                                if (optionsCell[2] !== value) {\n                                                    mysql_column_edit = Wptm.query_option.column_options[optionsCell[1]].table + '.' + Wptm.query_option.column_options[optionsCell[1]].Field;\n                                                    mysql_column_key = Wptm.query_option.column_options[table_function_data.keyPosition].table + '.' + Wptm.query_option.column_options[table_function_data.keyPosition].Field;\n                                                    value_change = Wptm.datas[optionsCell[0]][table_function_data.keyPosition];\n                                                    Wptm.saveDataDbTable.push({\n                                                        action: 'edit_cell_mysql',\n                                                        row: optionsCell[0],\n                                                        col: optionsCell[1],\n                                                        content: value,\n                                                        id: Wptm.datas[optionsCell[0]][table_function_data.keyPosition],\n                                                        column: mysql_column_edit,\n                                                        column_key: mysql_column_key\n                                                    });\n                                                }\n                                            }\n                                            if (Wptm.headerOption > 0 && optionsCell[0] < Wptm.headerOption) {\n                                                Wptm.style.table.header_data[optionsCell[0]][optionsCell[1]] = value;\n                                            }\n                                        }\n                                        if (value !== optionsCell[3]) {//has convert cell value\n                                            window.Wptm.container.handsontable('setDataAtCell', optionsCell[0], optionsCell[1], value, 'auto_convert_data');\n                                        }\n                                    } else {\n                                        if (notSaveData) {\n                                            if (Wptm.type !== 'mysql') {\n                                                if (window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]]\n                                                    && window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2]\n                                                    && window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2].cell_type === 'html')\n                                                    saveData.push({action: 'edit_cell_html', row: optionsCell[0], col: optionsCell[1], content: optionsCell[3]});\n                                                else\n                                                    saveData.push({action: 'edit_cell', row: optionsCell[0], col: optionsCell[1], content: optionsCell[3]});\n                                            } else if ( Wptm.query_option.column_options !== null && typeof Wptm.query_option.column_options[optionsCell[1]] !== \"undefined\")  {\n                                                if (optionsCell[2] !== optionsCell[3]) {\n                                                    mysql_column_edit = Wptm.query_option.column_options[optionsCell[1]].table + '.' + Wptm.query_option.column_options[optionsCell[1]].Field;\n                                                    mysql_column_key = Wptm.query_option.column_options[table_function_data.keyPosition].table + '.' + Wptm.query_option.column_options[table_function_data.keyPosition].Field;\n                                                    value_change = Wptm.datas[optionsCell[0]][table_function_data.keyPosition];\n                                                    Wptm.saveDataDbTable.push({\n                                                        action: 'edit_cell_mysql',\n                                                        row: optionsCell[0],\n                                                        col: optionsCell[1],\n                                                        content: optionsCell[3],\n                                                        id: Wptm.datas[optionsCell[0]][table_function_data.keyPosition],\n                                                        column: mysql_column_edit,\n                                                        column_key: mysql_column_key\n                                                    });\n                                                }\n                                            }\n                                            if (Wptm.headerOption > 0 && optionsCell[0] < Wptm.headerOption) {\n                                                Wptm.style.table.header_data[optionsCell[0]][optionsCell[1]] = optionsCell[3];\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        } else {\n                            editHeader = true;\n                            if (notSaveData) {\n                                if (Wptm.type === 'mysql' && Wptm.query_option.column_options !== null && typeof Wptm.query_option.column_options[optionsCell[1]] !== \"undefined\") {\n                                    if (optionsCell[2] !== optionsCell[3]) {\n                                        mysql_column_edit = Wptm.query_option.column_options[optionsCell[1]].table + '.' + Wptm.query_option.column_options[optionsCell[1]].Field;\n                                        mysql_column_key = Wptm.query_option.column_options[table_function_data.keyPosition].table + '.' + Wptm.query_option.column_options[table_function_data.keyPosition].Field;\n                                        value_change = Wptm.datas[optionsCell[0]][table_function_data.keyPosition];\n                                        Wptm.saveDataDbTable.push({\n                                            action: 'edit_cell_mysql',\n                                            row: optionsCell[0],\n                                            col: optionsCell[1],\n                                            content: optionsCell[3],\n                                            id: Wptm.datas[optionsCell[0]][table_function_data.keyPosition],\n                                            column: mysql_column_edit,\n                                            column_key: mysql_column_key\n                                        });\n                                    }\n                                } else {\n                                    if (window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]]\n                                        && window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2]\n                                        && window.Wptm.style.cells[optionsCell[0] + '!' + optionsCell[1]][2].cell_type === 'html')\n                                        saveData.push({action: 'edit_cell_html', row: optionsCell[0], col: optionsCell[1], content: optionsCell[3]});\n                                    else\n                                        saveData.push({action: 'edit_cell', row: optionsCell[0], col: optionsCell[1], content: optionsCell[3]});\n                                }\n                                if (Wptm.headerOption > 0 && optionsCell[0] < Wptm.headerOption) {\n                                    Wptm.style.table.header_data[optionsCell[0]][optionsCell[1]] = optionsCell[3];\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            // clearTimeout(tableFunction.autosaveNotification);\n\n            //change[0][2] & change[0][3] === undefined when edit html cell\n            if (action.includes(source) && typeof change[0] !== 'undefined' && !(typeof change[0][2] === 'undefined' && typeof change[0][3] === 'undefined')) {\n                table_function_data.needSaveAfterRender = (change[0][2] !== change[0][3] || source ==='setDataAtCell') ? true : false;\n            }\n\n            if (change && Wptm.type === 'mysql' && notSaveData && Wptm.saveDataDbTable.length > 0) {//mysql table edited\n                if (typeof value !== 'undefined' || editHeader) {\n                    saveData = saveData.concat(Wptm.saveDataDbTable);\n                    wptm_element.mainTabContent.addClass('loading_ajax');\n                    Wptm.saveDataDbTable = [];\n                    tableFunction.saveChanges(true);\n                }\n                table_function_data.needSaveAfterRender = false;\n            }\n\n            //update merge cells when autofill\n            if ('Autofill.fill' === source) {\n                tableFunction.cleanHandsontable();\n                updateMergeCells(true);\n            } else {\n                setTimeout(function () {\n                    if (jquery(Wptm.container).handsontable('getInstance').undoRedo.isUndoAvailable()) {\n                        wptm_element.primary_toolbars.find('#undo_cell').addClass('active').removeClass('no_active');\n                    } else {\n                        wptm_element.primary_toolbars.find('#undo_cell').removeClass('active').addClass('no_active');\n                    }\n                    if (jquery(Wptm.container).handsontable('getInstance').undoRedo.isRedoAvailable()) {\n                        wptm_element.primary_toolbars.find('#redo_cell').addClass('active').removeClass('no_active');\n                    } else {\n                        wptm_element.primary_toolbars.find('#redo_cell').removeClass('active').addClass('no_active');\n                    }\n                }, 100);\n            }\n\n            if (table_function_data.needSaveAfterRender === true) {\n                tableFunction.saveChanges();\n                table_function_data.needSaveAfterRender = false;\n            }\n        },\n        afterCreateRow: async function (index, amount) {\n        // afterCreateRow: function (index, amount) {\n            var selector = table_function_data.selection[table_function_data.selectionSize - 1];\n            var $ = window.jquery;\n            var Wptm = window.Wptm;\n            var above = selector[0] === index ? true : false;//check above/below\n            /*fix create many rows when copy many lines. add create_row action before edit_cell action(in afterChange)*/\n            saveData.push({action: 'create_row', index: index, amount: amount, above: above});\n\n            var changing_style_cell = await changeCellAfterCreateRow(index, amount, selector, above)\n\n            //remove tooltip in new cells created\n            await tableFunction.getFillArray([[index, 0, index + amount - 1, Wptm.max_Col - 1]], Wptm, {tooltip_content: null});\n\n            if (typeof (Wptm.style.rows) !== 'undefined') {\n                Wptm.style.rows = await tableFunction.changeValue(Wptm.style.rows, index, amount, Wptm.max_row, selector[0] === index, copyHeightRow);\n                // Wptm.style.rows = tableFunction.changeValue(Wptm.style.rows, index, amount, Wptm.max_row, selector[0] === index, copyHeightRow);\n            }\n\n            if (parseInt(Wptm.headerOption) > 0) {\n                delete Wptm.style.table.header_data;\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n\n            // update merged row index and get tableFunction.saveChanges();\n            // setTimeout(function () {\n            await updateMergeCells(window.table_function_data.firstRender);\n                // updateMergeCells(window.table_function_data.firstRender);\n            // }, 100);\n            // await tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'create_row', index: index, amount: amount});\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'create_row', index: index, amount: amount});\n            tableFunction.cleanHandsontable();\n        },\n        afterRemoveRow: function (index, amount) {\n            var selector = table_function_data.selection[table_function_data.selectionSize - 1];\n            var $ = jquery;\n            var Wptm = window.Wptm;\n            if (typeof (Wptm.style.cells) !== 'undefined') {\n                var newCells = {};\n                var cell, i, cells;\n\n                for (cell in Wptm.style.cells) {\n                    cells = Wptm.style.cells[cell];\n                    if (cells[0] > index + amount - 1) {\n                        newCells[parseInt(cells[0] - amount) + '!' + cells[1]]\n                            = [cells[0] - amount, cells[1], $.extend({}, cells[2])];\n                    }\n                    if (cells[0] < index) {\n                        newCells[cell]\n                            = [cells[0], cells[1], $.extend({}, cells[2])];\n                    }\n                }\n                Wptm.style.cells = $.extend({}, newCells);\n\n                if (typeof Wptm.style.table.alternateColorValue !== 'undefined') {//update Wptm.style.table.alternateColorValue by index, amount\n                    var alternateColorValue = Wptm.style.table.alternateColorValue;\n                    for (i in alternateColorValue) {\n                        if (alternateColorValue[i] !== false) {\n                            if (alternateColorValue[i].selection[2] >= index && alternateColorValue[i].selection[2] <= (index + amount - 1)) {\n                                alternateColorValue[i].selection[2] = index - 1;//selection[2] in selector\n                            }\n                            if (alternateColorValue[i].selection[2] >= index + amount) {\n                                alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] - amount;//selection[2] > selector\n                            }\n                            if (alternateColorValue[i].selection[0] >= index && alternateColorValue[i].selection[0] < (index + amount)) {\n                                alternateColorValue[i].selection[0] = index;//selection[0] in selector\n                            }\n                            if (alternateColorValue[i].selection[0] >= index + amount) {\n                                alternateColorValue[i].selection[0] = alternateColorValue[i].selection[0] - amount;//selection[0] > selector\n                            }\n                            if (alternateColorValue[i].selection[0] > alternateColorValue[i].selection[2]) {//alternateColor in selector\n                                delete alternateColorValue[i];\n                            }\n                        }\n                    }\n                }\n            }\n\n            if (typeof (Wptm.style.cols) !== 'undefined') {\n                var new_data = $.extend({}, Wptm.style.rows);\n                var max = _.size(Wptm.style.rows);\n                var jj;\n                for (jj = index; jj < max; jj++) {\n                    if (jj < index + amount) {\n                        delete new_data[jj];\n                    }\n                    if (typeof (new_data[jj + amount]) !== 'undefined' && new_data[jj + amount] !== null) {\n                        new_data[jj] = [jj, {}];\n                        new_data[jj][1] = $.extend({}, new_data[jj + amount][1]);\n                    }\n                    if (jj + amount >= max) {\n                        delete new_data[jj];\n                    }\n                }\n                Wptm.style.rows = $.extend({}, new_data);\n            }\n\n            //remove col in header table\n            if (parseInt(Wptm.headerOption) > 0) {\n                delete Wptm.style.table.header_data;\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n\n            saveData.push({action: 'del_row', index: index, amount: amount, old_rows: $(window.Wptm.container).handsontable('countRows') + amount});\n            // update merged row index and get tableFunction.saveChanges();\n\n            setTimeout(function () {\n                updateMergeCells(window.table_function_data.firstRender);\n            }, 100);\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'delete_row', index: index, amount: amount});\n\n            tableFunction.cleanHandsontable();\n        },\n        afterCreateCol: function (index, amount) {\n            var selector = table_function_data.selection[table_function_data.selectionSize - 1];\n            var $ = jquery;\n            var Wptm = window.Wptm;\n            var left = selector[1] === index ? true : false;//check insert left/right\n            var createColsWhenPaste = false;\n\n            if (typeof (Wptm.style.cells) !== 'undefined') {\n                var newCells = {};\n                var cell, i, cells;\n\n                for (cell in Wptm.style.cells) {\n                    cells = Wptm.style.cells[cell];\n                    if (cells[1] >= index) {//cols >= index\n                        if (typeof table_function_data.createCellWhenCopy !== 'undefined' && typeof table_function_data.createCellWhenCopy[cell] !== 'undefined') {\n                            newCells[cell] = $.extend([], cells);\n                            createColsWhenPaste = true;\n                        } else {\n                            newCells[cells[0] + '!' + parseInt(cells[1] + amount)]\n                                = [cells[0], cells[1] + amount, $.extend({}, cells[2])];\n                        }\n                    }\n                    if (cells[1] < index) {//cols < index\n                        newCells[cell]\n                            = [cells[0], cells[1], $.extend({}, cells[2])];\n                    }\n                    if (cells[1] <= selector[3] && selector[1] <= cells[1]) {//new cols copy style of selector\n                        if (typeof table_function_data.createCellWhenCopy !== 'undefined' && typeof table_function_data.createCellWhenCopy[cell] !== 'undefined') {\n                            newCells[cell] = $.extend([], cells);\n                            createColsWhenPaste = true;\n                        } else {\n                            newCells[cells[0] + '!' + parseInt(cells[1] - selector[1] + index)]\n                                = [cells[0], parseInt(cells[1] - selector[1] + index), $.extend({}, cells[2])];\n                        }\n                    }\n                }\n                Wptm.style.cells = $.extend({}, newCells);\n\n                if (typeof Wptm.style.table.alternateColorValue !== 'undefined') {//update Wptm.style.table.alternateColorValue by index, amount\n                    var alternateColorValue = Wptm.style.table.alternateColorValue;\n                    for (i in alternateColorValue) {\n                        if (alternateColorValue[i] !== false) {\n                            if (left) {//insert left\n                                if (alternateColorValue[i].selection[1] >= index) { // alternateColorValue > new rows\n                                    alternateColorValue[i].selection[1] = alternateColorValue[i].selection[1] + amount;\n                                    alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] + amount;\n                                }\n                                if (alternateColorValue[i].selection[1] < index && alternateColorValue[i].selection[3] >= index) {\n                                    alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] + amount;\n                                }\n                            } else {//insert right\n                                if (alternateColorValue[i].selection[1] >= index) { // alternateColorValue > new rows\n                                    alternateColorValue[i].selection[1] = alternateColorValue[i].selection[1] + amount;\n                                    alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] + amount;\n                                }\n                                if (alternateColorValue[i].selection[1] < index && alternateColorValue[i].selection[3] >= index) {\n                                    alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] + amount;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            if (createColsWhenPaste) {\n                if (typeof table_function_data.create_col_after_paste === 'undefined') {\n                    table_function_data.create_col_after_paste = []\n                }\n                table_function_data.create_col_after_paste.push({action: 'create_col_after_paste', index: index, amount: amount, left: left});\n            } else {\n                saveData.push({action: 'create_col', index: index, amount: amount, left: left});\n            }\n            //remove tooltip in new cells created\n            tableFunction.getFillArray([[0, index, Wptm.max_row - 1, index + amount - 1]], Wptm, {tooltip_content: null});\n\n            if (typeof (Wptm.style.cols) !== 'undefined') {\n                // index, amount\n                var new_data = $.extend({}, Wptm.style.cols);\n                var jj;\n                if (selector[1] === index) {//left\n                    for (jj = index; jj < tableFunction.droptablesCheckSize(Wptm.style.cols); jj++) {\n                        new_data[jj + amount] = [jj + amount, {}];\n                        new_data[jj + amount][1] = $.extend({}, Wptm.style.cols[jj][1]);\n                    }\n                } else {\n                    for (jj = index; jj < tableFunction.droptablesCheckSize(Wptm.style.cols) + amount; jj++) {\n                        // if (typeof new_data[jj] === 'undefined') {\n                            new_data[jj] = [jj, {}];\n                            new_data[jj][1] = $.extend({}, Wptm.style.cols[jj - amount][1]);\n                        // }\n                    }\n                }\n\n                Wptm.style.cols = $.extend({}, new_data);\n            }\n\n            for (var i = index; i <= (index + amount - 1) ; i++) {\n                if (createColsWhenPaste) {\n                    Wptm.style.table.col_types.splice(i, 0, 'text');\n                } else {\n                    Wptm.style.table.col_types.splice(i, 0, 'varchar');\n                }\n            }\n\n            if (parseInt(Wptm.headerOption) > 0) {\n                delete Wptm.style.table.header_data;\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n\n            // Build column selection for default sort parameter\n            tableFunction.default_sortable(window.Wptm.datas);\n\n\n            window.jquery(window.Wptm.container).handsontable('render');\n\n            // update merged row index and get tableFunction.saveChanges();\n            setTimeout(function () {\n                updateMergeCells(window.table_function_data.firstRender);\n            }, 100);\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'add_col', index: index, amount: amount});\n\n            tableFunction.cleanHandsontable();\n        },\n        afterRemoveCol: function (index, amount) {\n            var selector = table_function_data.selection[table_function_data.selectionSize - 1];\n            var $ = jquery;\n            var Wptm = window.Wptm;\n            if (typeof (Wptm.style.cells) !== 'undefined') {\n                var newCells = {};\n                var cell, i, cells;\n\n                for (cell in Wptm.style.cells) {\n                    cells = Wptm.style.cells[cell];\n                    if (cells[1] > index + amount - 1) {\n                        newCells[cells[0] + '!' + parseInt(cells[1] - amount)]\n                            = [cells[0], cells[1] - amount, $.extend({}, cells[2])];\n                    }\n                    if (cells[1] < index) {\n                        newCells[cell]\n                            = [cells[0], cells[1], $.extend({}, cells[2])];\n                    }\n                }\n                Wptm.style.cells = $.extend({}, newCells);\n\n                if (typeof Wptm.style.table.alternateColorValue !== 'undefined') {//update Wptm.style.table.alternateColorValue by index, amount\n                    var alternateColorValue = Wptm.style.table.alternateColorValue;\n                    for (i in alternateColorValue) {\n                        if (alternateColorValue[i] !== false) {\n                            if (alternateColorValue[i].selection[3] >= index && alternateColorValue[i].selection[3] <= (index + amount - 1)) {\n                                alternateColorValue[i].selection[3] = index - 1;//selection[3] in selector\n                            }\n                            if (alternateColorValue[i].selection[3] >= index + amount) {\n                                alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] - amount;//selection[3] > selector\n                            }\n                            if (alternateColorValue[i].selection[1] >= index && alternateColorValue[i].selection[1] < (index + amount)) {\n                                alternateColorValue[i].selection[1] = index;//selection[0] in selector\n                            }\n                            if (alternateColorValue[i].selection[1] >= index + amount) {\n                                alternateColorValue[i].selection[1] = alternateColorValue[i].selection[1] - amount;//selection[0] > selector\n                            }\n                            if (alternateColorValue[i].selection[1] > alternateColorValue[i].selection[3]) {//alternateColor in selector\n                                delete alternateColorValue[i];\n                            }\n                        }\n                    }\n                }\n            }\n\n            for (var i = (index + amount - 1); i >= index ; i--) {\n                Wptm.style.table.col_types.splice(i, 1);\n            }\n            if (typeof (Wptm.style.cols) !== 'undefined') {\n                var new_data = $.extend({}, Wptm.style.cols);\n                var max = _.size(Wptm.style.cols);\n                var jj;\n                for (jj = index; jj < max; jj++) {\n                    if (jj < index + amount) {\n                        delete new_data[jj];\n                    }\n                    if (typeof (new_data[jj + amount]) !== 'undefined' && new_data[jj + amount] !== null) {\n                        new_data[jj] = [jj, {}];\n                        new_data[jj][1] = $.extend({}, new_data[jj + amount][1]);\n                    }\n                    if (jj + amount >= max) {\n                        delete new_data[jj];\n                    }\n                }\n                Wptm.style.cols = $.extend({}, new_data);\n            }\n\n            //remove col in header table\n            if (parseInt(Wptm.headerOption) > 0) {\n                delete Wptm.style.table.header_data;\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n\n            // Build column selection for default sort parameter\n            tableFunction.default_sortable(window.Wptm.datas);\n            jquery(Wptm.container).data('handsontable').render();\n            saveData.push({action: 'del_col', index: index, amount: amount, old_columns: $(window.Wptm.container).handsontable('countCols') + amount});\n\n            setTimeout(function () {\n                updateMergeCells(window.table_function_data.firstRender);\n            }, 100);\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'delete_col', index: index, amount: amount});\n\n            tableFunction.cleanHandsontable();\n        },\n        afterColumnResize: function (col, width) {\n            tableFunction.saveChanges();\n        },\n        beforeRowResize: function (currentRow, newSize, isDoubleClick) {\n            if (modifyRow !== null) {//currentRow is current size row\n                Wptm.style.rows[modifyRow][1].height = newSize;\n            }\n        },\n        modifyRow: function (row) {\n            modifyRow = row;\n        },\n        afterRowResize: function (row1, height) {\n            Wptm.style.rows[row1][1].height = height;\n\n            tableFunction.saveChanges();\n        },\n        // currentRowClassName: 'wptmCurrentRow',\n        afterSelectionByProp: (row, column, row2, column2, preventScrolling, selectionLayerLevel) => {\n            preventScrolling.value = true;//turn off scroll when selection cell\n            // console.log('afterSelectionByProp')\n        },\n        // afterDrawSelection: (currentRow, currentColumn, cornersOfSelection, layerLevel) => {\n            // console.log(currentRow, currentColumn, cornersOfSelection, layerLevel)\n            // return 'cell_selected'\n        // },\n        afterSelection: function (r, c, r2, c2, preventScrolling, selectionLayerLevel) {\n            wptm_element.handsontableInputHolder = wptm_element.tableContainer.find('.handsontableInputHolder');\n            // console.log('afterSelection')\n            preventScrolling.value = true;\n            if ((table_function_data.zoom || 1) != 1) {\n                tableFunction.wptmSetZoom(table_function_data.zoom || 1, false)\n\n                wptm_element.handsontableInputHolder.addClass('wptm_hiden')\n            }\n\n            if (table_function_data.checkCellValueChange !== false && typeof table_function_data.cellValueChange !== 'undefined') {\n                tableFunction.change_value_cells(table_function_data.checkCellValueChange, wptm_element.cellValue.val());\n            }\n            selectOption.loadSelection(window.jquery, window.Wptm, [[r, c, r2, c2]]);\n            Wptm.max_Col = Wptm.datas[0].length;\n            Wptm.max_row = Wptm.datas.length;\n            if (typeof Wptm.datas[Wptm.max_row - 1] !== 'undefined') {\n                var max_col_2 = Wptm.datas[Wptm.max_row - 1].length;\n                Wptm.max_Col = Wptm.max_Col < max_col_2 ? max_col_2 : Wptm.max_Col;\n            }\n            if (r * r2 == 0 && (r2 + r) == (Wptm.max_row - 1)) {\n                Wptm.newSelect = 'col';\n            } else if (c * c2 == 0 && (c2 + c) == Wptm.max_Col - 1) {\n                Wptm.newSelect = 'row';\n            } else {\n                delete Wptm.newSelect;\n            }\n        },\n        afterBeginEditing: (row, column) => {\n            if ((table_function_data.zoom || 1) != 1) {\n                checkScroll = true;\n                clearTimeout(autoScroll);\n                autoScroll = setTimeout(function () {\n                    checkScroll = afterScrollEditors(checkScroll);\n                }, 50);\n                // console.log('afterBeginEditing')\n            }\n        },\n        afterMomentumScroll: function () {//Fired after a scroll event, which is identified as a momentum scroll (e.g. on an iPad).\n            if ((table_function_data.zoom || 1) != 1) {\n                // wptm_element.handsontableInputHolder.addClass('wptm_hiden')\n                checkScroll = true;\n                clearTimeout(autoScroll);\n                autoScroll = setTimeout(function () {\n                    checkScroll = afterScrollEditors(checkScroll);\n                }, 50);\n            }\n        },\n        afterScrollHorizontally: function () {\n            //change position of Editors when ScrollHorizontally\n            if ((table_function_data.zoom || 1) != 1) {\n                wptm_element.handsontableInputHolder.addClass('wptm_hiden')\n                checkScroll = true;\n                clearTimeout(autoScroll);\n                autoScroll = setTimeout(function () {\n                    checkScroll = afterScrollEditors(checkScroll);\n                }, 50);\n            }\n        },\n        afterScrollVertically: function () {\n            //change position of Editors when ScrollHorizontally\n            if ((table_function_data.zoom || 1) != 1) {\n                // wptm_element.handsontableInputHolder.addClass('wptm_hiden')\n                checkScroll = true;\n                clearTimeout(autoScroll);\n                autoScroll = setTimeout(function () {\n                    checkScroll = afterScrollEditors(checkScroll);\n                }, 50);\n            }\n        },\n        afterMergeCells: function (cellRange, mergeParent, auto) {\n            updateMergeCells(window.table_function_data.firstRender);\n            // if (window.table_function_data.firstRender) {\n            //     tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'mergeCells'});\n            // }\n        },\n        afterUnmergeCells: function (cellRange, auto) {\n            updateMergeCells(window.table_function_data.firstRender);\n            // if (window.table_function_data.firstRender) {\n            //     tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'mergeCells'});\n            // }\n        },\n        colWidths: function (index) {\n            if (tableFunction.checkObjPropertyNested(window.Wptm.style, 'cols', index, 1, 'width')) {\n                return window.Wptm.style.cols[index][1].width;\n            } else if (typeof window.Wptm.style.cols === 'object'\n                && (typeof window.Wptm.style.cols[index] === 'undefined' || typeof window.Wptm.style.cols[index][1].width === 'undefined')) {\n                return 100;\n            }\n        },\n        rowHeights: function (index) {\n            if (tableFunction.checkObjPropertyNestedNotEmpty(window.Wptm.style, 'rows', index, 1, 'height')) {\n                return window.Wptm.style.rows[index][1].height;\n            } else {\n                // Table rows is large than 1000, set default row height to 30\n                if (totalRows >= 1000) {\n                    return 30;\n                }\n                var h;\n                if (typeof Wptm.style.table.allRowHeight !== 'undefined' && Wptm.style.table.allRowHeight !== '') {\n                    h = Wptm.style.table.allRowHeight;\n                } else {\n                    h = window.Wptm.container.find('.ht_master .htCore tbody tr').eq(index).height();\n                }\n                return h;\n            }\n        },\n        fixedRowsTop: (window.Wptm.style.table.responsive_type == 'scroll' && parseInt(window.Wptm.style.table.freeze_row) > 0) ? window.Wptm.headerOption : 0,\n        fixedColumnsLeft: (window.Wptm.style.table.responsive_type == 'scroll') ? parseInt(window.Wptm.style.table.freeze_col) : 0,\n        manualColumnResize: (window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)),\n        manualRowResize: (window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)),\n        outsideClickDeselects: false,\n        columnSorting: false,\n        // columnSorting: true,\n        // filters: true,\n        // dropdownMenu: true,\n        undo: true,\n        mergeCells: window.Wptm.mergeCellsSetting,\n        readOnly: ((window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)) && window.Wptm.type === 'html') ? false : (Wptm.table_editing != \"1\" ? true : false),\n        // readOnly: true,\n        // selectionMode: table_function_data.mysqlEdit ? 'single' : 'range',\n        selectionMode: 'multiple',\n        columns: typeof table_function_data.columns !== 'undefined' ? table_function_data.columns : undefined,\n        // columns: undefined,\n        beforeKeyDown: function (e) {\n            var evtobj = window.event? event : e;\n\n            if (evtobj.keyCode == 90 && (evtobj.ctrlKey || evtobj.metaKey)) {//undo\n                if (!evtobj.shiftKey) {\n                    if (!window.jquery(Wptm.container).handsontable('getInstance').undoRedo.isUndoAvailable()) {\n                        tableFunction.status_notic(1, wptmText.some_action_cant_be_done + '!', jquery('#undoNotic'));\n                    }\n                }\n                if (evtobj.shiftKey) {\n                    if (!window.jquery(Wptm.container).handsontable('getInstance').undoRedo.isRedoAvailable()) {\n                        tableFunction.status_notic(1, wptmText.some_action_cant_be_done + '!', jquery('#undoNotic'));\n                    }\n                }\n            }\n        },\n        // readOnlyCellClassName: 'wptm_lock_column', //ncc error conflict header, conflict html cell\n        cells: function(row, col, prop) {\n            return tableFunction.check_cell_readOnly(row, col, prop);\n        },\n        contextMenu: (((window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)) && window.Wptm.type === 'html')\n            ? {\n                items: {\n                    \"cut\": {\n                        name: wptmContext.cut,\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"copy\": {\n                        name: wptmContext.copy,\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        },\n                    },\n                    // \"paste\": {\n                    //     key: 'paste',\n                    //     name: 'Paste',\n                    //     disabled: function() {\n                    //         return clipboardCache.length === 0;\n                    //     },\n                    //     callback: function() {\n                    //         var plugin = this.getPlugin('copyPaste');\n                    //\n                    //         this.listen();\n                    //         plugin.paste(clipboardCache);\n                    //     }\n                    // },\n                    \"remove\": {\n                        name: wptmContext.remove,\n                        key: 'remove',\n                        submenu: {\n                            items: [\n                                {\n                                    key: \"remove:remove_row\",\n                                    name: wptmContext.remove_rows,\n                                    callback: function (key, selection, clickEvent) {\n                                        var selection = table_function_data.selection;\n                                        var i;\n                                        for (i = 0; i < table_function_data.selectionSize; i++) {\n                                            if (selection[i][2] != null || selection[i][0] != selection[i][2]) {\n                                                window.Wptm.container.handsontable('alter', 'remove_row', selection[i][0], selection[i][2] - selection[i][0] + 1);\n                                            } else {\n                                                window.Wptm.container.handsontable('alter', 'remove_row', selection[i][0]);\n                                            }\n                                        }\n                                    },\n                                },\n                                {\n                                    key: \"remove:remove_col\",\n                                    name: wptmContext.remove_cols,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection;\n                                        var i;\n                                        for (i = 0; i < table_function_data.selectionSize; i++) {\n                                            if (selection[i][3] != null || selection[i][1] != selection[i][3]) {\n                                                window.Wptm.container.handsontable('alter', 'remove_col', selection[i][1], selection[i][3] - selection[i][1] + 1);\n                                            } else {\n                                                window.Wptm.container.handsontable('alter', 'remove_col', selection[i][1]);\n                                            }\n                                        }\n                                    },\n                                },\n                                {\n                                    key: \"remove:remove_cell_format\",\n                                    name: wptmContext.remove_cell_format,\n                                    callback: function (key, selection, clickEvent) {\n                                        tableFunction.getFillArray(table_function_data.selection, Wptm, {\n                                            date_formats: false,\n                                            date_formats_momentjs: false,\n                                            currency_symbol: false,\n                                            symbol_position: false,\n                                            decimal_symbol: false,\n                                            decimal_count: false,\n                                            thousand_symbol: false\n                                        }, 'style', true, function () {\n                                            window.jquery(wptm_element.tableContainer).handsontable('render');\n                                        });\n                                    },\n                                    hidden: function () {//hiden when has html cell\n                                        if (table_function_data.selectionSize > 0) {\n                                            if (!tableFunction.checkCellsOptionsValidate(table_function_data.selection, 'cell_type', 'html')) {\n                                                return false;\n                                            }\n                                        }\n                                        return true;\n                                    }\n                                },\n                                {\n                                    key: \"remove:remove_alternating_color\",\n                                    // name: function () {\n                                    //     return (table_function_data.selectionSize > 2\n                                    //         || (table_function_data.selectionSize < 2 && (table_function_data.selection[0][2] > table_function_data.selection[0][0] + 1) || (table_function_data.selection[0][3] > table_function_data.selection[0][1] + 1)))\n                                    //         ? wptmContext.remove_alternating_color_cells\n                                    //         : wptmContext.remove_alternating_color;\n                                    // },\n                                    name: wptmContext.remove_alternating_color,\n                                    callback: function (key, selection, clickEvent) {\n                                        var i, ij, ik, alternateColorCell, selection_cell = null;\n                                        for (i = 0; i < table_function_data.selectionSize; i++) {\n                                            if (selection_cell !== null) {\n                                                break;\n                                            }\n                                            for (ij = table_function_data.selection[i][0]; ij <= table_function_data.selection[i][2]; ij++) {\n                                                if (selection_cell !== null) {\n                                                    break;\n                                                }\n                                                for (ik = table_function_data.selection[i][1]; ik <= table_function_data.selection[i][3]; ik++) {\n                                                    if (typeof Wptm.style.cells[ij + \"!\" + ik] !== 'undefined' && typeof Wptm.style.cells[ij + \"!\" + ik][2].AlternateColor !== 'undefined') {\n                                                        alternateColorCell = parseInt(Wptm.style.cells[ij + \"!\" + ik][2].AlternateColor);\n                                                        if (typeof Wptm.style.table.alternateColorValue[alternateColorCell] !== 'undefined' && typeof Wptm.style.table.alternateColorValue[alternateColorCell].selection !== 'undefined') {\n                                                            selection_cell = Wptm.style.table.alternateColorValue[alternateColorCell].selection;\n                                                            Wptm.container.handsontable(\"selectCell\", selection_cell[0], selection_cell[1], selection_cell[2], selection_cell[3]);\n                                                            break;\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                        if (selection_cell !== null) {\n                                            tableFunction.wptmBootbox('', wptmText.warning_remove_alternating_color, true, true, () => {\n                                                table_function_data.oldAlternate[alternateColorCell] = false;\n                                                Wptm.style.table.alternateColorValue[alternateColorCell] = false;\n                                                setTimeout(function () {\n                                                    saveData.push({action: 'deleteStyle', selection: table_function_data.selection, style: 'AlternateColor'});\n                                                    tableFunction.saveChanges(true, 'render');\n                                                }, 100);\n                                            });\n                                        }\n                                    },\n                                    hidden: function () {//hiden when has html cell\n                                        if (table_function_data.selectionSize > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                }],\n                        },\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"---------\": {},\n                    \"rows_size\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined') {\n                                var selectSize = table_function_data.selection[table_function_data.selectionSize - 1];\n                                if (Wptm.newSelect === 'row') {\n                                    if (selectSize[0] !== selectSize[2]) {\n                                        return '<span>' + wptmContext.define + 's ' + (selectSize[0] + 1) + '-' + (selectSize[2] + 1) + '</span>';\n                                    }\n                                    return '<span>' + wptmContext.define + '</span>';\n                                } else {\n                                    if (selectSize[1] !== selectSize[3]) {\n                                        return '<span>' + wptmContext.define + 's ' + String.fromCharCode(65 + selectSize[1]) + '-' + String.fromCharCode(65 + selectSize[3]) + '</span>';\n                                    }\n                                    return '<span>' + wptmContext.defineColumn + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'row') {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"resize_row\"]').trigger('click');\n                            } else {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"resize_column\"]').trigger('click');\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            if (typeof Wptm.newSelect !== 'undefined' && Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"insert\": {\n                        name: wptmContext.insert,\n                        key: 'insert',\n                        submenu: {\n                            items: [\n                                {\n                                    key: \"insert:row_above\",\n                                    name: wptmContext.insert_above,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                                        if (selection[2] != null || selection[0] != selection[2]) {\n                                            window.Wptm.container.handsontable('alter', 'insert_row', selection[0], selection[2] - selection[0] + 1);\n                                        } else {\n                                            window.Wptm.container.handsontable('alter', 'insert_row', selection[0]);\n                                        }\n                                    },\n                                    hidden: function () {\n                                        if (Wptm.max_Col > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                },\n                                {\n                                    key: \"insert:row_below\",\n                                    name: wptmContext.insert_below,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                                        if (selection[2] != null || selection[0] != selection[2]) {\n                                            window.Wptm.container.handsontable('alter', 'insert_row', selection[2] + 1, selection[2] - selection[0] + 1);\n                                        } else {\n                                            window.Wptm.container.handsontable('alter', 'insert_row', selection[2] + 1);\n                                        }\n                                    },\n                                    hidden: function () {\n                                        if (Wptm.max_Col > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                },\n                                {\n                                    key: \"insert:col_left\",\n                                    name: wptmContext.insert_left,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                                        if (selection[3] != null || selection[1] != selection[3]) {\n                                            window.Wptm.container.handsontable('alter', 'insert_col', selection[1], selection[3] - selection[1] + 1);\n                                        } else {\n                                            window.Wptm.container.handsontable('alter', 'insert_col', selection[1]);\n                                        }\n                                    },\n                                    hidden: function () {\n                                        if (Wptm.max_row > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                },\n                                {\n                                    key: \"insert:col_right\",\n                                    name: wptmContext.insert_right,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                                        if (selection[3] != null || selection[1] != selection[3]) {\n                                            window.Wptm.container.handsontable('alter', 'insert_col', selection[3] + 1, selection[3] - selection[1] + 1);\n                                        } else {\n                                            window.Wptm.container.handsontable('alter', 'insert_col', selection[3] + 1);\n                                        }\n                                    },\n                                    hidden: function () {\n                                        if (Wptm.max_row > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                }],\n                        }\n                    },\n                    \"undo\": {\n                        name: wptmContext.undo,\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"redo\": {\n                        name: wptmContext.redo,\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"protect_range\": {\n                        name: function () {\n                            // if (typeof Wptm.newSelect !== 'undefined' && Wptm.newSelect === 'col') {\n                            //     var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                            //     var ij;\n                            //     table_function_data.protect_columns_check = false;\n                            //     if (typeof Wptm.style.table.protect_columns !== 'undefined') {\n                            //         for (ij = selection[1]; ij <= selection[3]; ij++) {\n                            //             if (Wptm.style.table.protect_columns[ij] != 1) {\n                            //                 table_function_data.protect_columns_check = false;\n                            //                 return '<span>' + wptmContext.protect_columns + '</span>';\n                            //             }\n                            //         }\n                            //         table_function_data.protect_columns_check = true;\n                            //         return '<span class=\"selected\">' + wptmContext.protect_columns + '</span>';\n                            //     } else {\n                            //         Wptm.style.table.protect_columns = [];\n                            //         for (ij = 0; ij < Wptm.max_Col; ij++) {\n                            //             Wptm.style.table.protect_columns[ij] = '0';\n                            //         }\n                            //         return '<span>' + wptmContext.protect_columns + '</span>';\n                            //     }\n                            // }\n                            return '<span>' + wptmContext.protect_range + '</span>';\n                        },\n                        callback: function (key, selections, clickEvent) {\n                            // if (typeof Wptm.newSelect !== 'undefined' && Wptm.newSelect === 'col') {\n                            //     var ij;\n                            //     if (typeof Wptm.style.table.protect_columns == 'undefined') {\n                            //         Wptm.style.table.protect_columns = [];\n                            //         for (ij = 0; ij < Wptm.max_Col; ij++) {\n                            //             Wptm.style.table.protect_columns[ij] = '0';\n                            //         }\n                            //     }\n                            //\n                            //     var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                            //     for (ij = selection[1]; ij <= selection[3]; ij++) {\n                            //         if (typeof table_function_data.protect_columns_check !== 'undefined'\n                            //             && table_function_data.protect_columns_check) {\n                            //             Wptm.style.table.protect_columns[ij] = '0';\n                            //         } else {\n                            //             Wptm.style.table.protect_columns[ij] = '1';\n                            //         }\n                            //     }\n                            // } else {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"lock_ranger_cells\"]').trigger('click');\n                            // }\n                            return true;\n                        },\n                        hidden: function () {\n                            if (wptm_administrator == 1) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"mergeCells\": {\n                        // name: wptmContext.merge,\n                    },\n                    \"Add tooltip\": {\n                        name: wptmContext.tooltip,\n                        callback: function (key, selection, clickEvent) {\n                            wptm_element.editToolTip.trigger('click');\n                        },\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row < 1) {\n                                return true;\n                            }\n                            if (table_function_data.selectionSize > 1\n                                || (table_function_data.selection[0][2] - table_function_data.selection[0][0] > 0\n                                    || table_function_data.selection[0][3] - table_function_data.selection[0][1] > 0)) {\n                                return true;\n                            }\n                            return false;\n                        }\n                    },\n                    \"Insert a cell selection\": {\n                        name: wptmContext.insert_selection,\n                        callback: function (key, selection, clickEvent) {\n                            wptm_element.primary_toolbars.find('.table_option[name=\"cell_insertion_shortcode\"]').trigger('click');\n                        },\n                        hidden: function () {\n                            return false;\n                        }\n                    },\n                    \"Column type\": {\n                        name: wptmContext.column_type,\n                        key: 'column_type',\n                        submenu: {\n                            items: [\n                                {\n                                    key: \"column_type:varchar\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && (table_function_data.type_column_selected === 'varchar' || table_function_data.type_column_selected.toLowerCase() === 'varchar(255)')) {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_varchar + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_varchar + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        tableFunction.wptmBootbox('', wptmText.ALERT_CHANGE_COLUMN_TYPE, true, true, () => {\n                                            var cols_selected = [];\n                                            var i, jj;\n                                            for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                    cols_selected[i] = 'varchar';\n                                                    Wptm.style.table.col_types[i] = 'varchar';\n                                                }\n                                            }\n\n                                            // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                            saveData.push({\n                                                action: 'set_columns_types',\n                                                value: cols_selected\n                                            });\n                                            tableFunction.cleanHandsontable();\n                                            tableFunction.saveChanges(true);\n                                        });\n                                    },\n                                },\n                                {\n                                    key: \"column_type:int\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'int') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_int + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_int + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        tableFunction.wptmBootbox('', wptmText.ALERT_CHANGE_COLUMN_TYPE, true, true, () => {\n                                            var cols_selected = [];\n                                            var i, jj;\n                                            for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                    cols_selected[i] = 'int';\n                                                    Wptm.style.table.col_types[i] = 'int';\n                                                }\n                                            }\n\n                                            // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                            saveData.push({\n                                                action: 'set_columns_types',\n                                                value: cols_selected\n                                            });\n                                            tableFunction.cleanHandsontable();\n                                            tableFunction.saveChanges(true);\n                                        });\n                                    },\n                                },\n                                {\n                                    key: \"column_type:float\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'float') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_float + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_float + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        tableFunction.wptmBootbox('', wptmText.ALERT_CHANGE_COLUMN_TYPE, true, true, () => {\n                                            var cols_selected = [];\n                                            var i, jj;\n                                            for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                    cols_selected[i] = 'float';\n                                                    Wptm.style.table.col_types[i] = 'float';\n                                                }\n                                            }\n\n                                            // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                            saveData.push({\n                                                action: 'set_columns_types',\n                                                value: cols_selected\n                                            });\n                                            tableFunction.cleanHandsontable();\n                                            tableFunction.saveChanges(true);\n                                        });\n                                    },\n                                },\n                                {\n                                    key: \"column_type:date\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'date') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_date + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_date + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        tableFunction.wptmBootbox('', wptmText.ALERT_CHANGE_COLUMN_TYPE, true, true, () => {\n                                            var cols_selected = [];\n                                            var i, jj;\n                                            for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                    cols_selected[i] = 'date';\n                                                    Wptm.style.table.col_types[i] = 'date';\n                                                }\n                                            }\n\n                                            // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                            saveData.push({\n                                                action: 'set_columns_types',\n                                                value: cols_selected\n                                            });\n                                            tableFunction.cleanHandsontable();\n                                            tableFunction.saveChanges(true);\n                                        });\n                                    },\n                                },\n                                {\n                                    key: \"column_type:datetime\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'datetime') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_datetime + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_datetime + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        tableFunction.wptmBootbox('', wptmText.ALERT_CHANGE_COLUMN_TYPE, true, true, () => {\n                                            var cols_selected = [];\n                                            var i, jj;\n                                            for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                    cols_selected[i] = 'datetime';\n                                                    Wptm.style.table.col_types[i] = 'datetime';\n                                                }\n                                            }\n\n                                            // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                            saveData.push({\n                                                action: 'set_columns_types',\n                                                value: cols_selected\n                                            });\n                                            tableFunction.cleanHandsontable();\n                                            tableFunction.saveChanges(true);\n                                        });\n                                    },\n                                },\n                                {\n                                    key: \"column_type:text\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'text') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_text + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_text + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        tableFunction.wptmBootbox('', wptmText.ALERT_CHANGE_COLUMN_TYPE, true, true, () => {\n                                            var cols_selected = [];\n                                            var i, jj;\n                                            for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                    cols_selected[i] = 'text';\n                                                    Wptm.style.table.col_types[i] = 'text';\n                                                }\n                                            }\n\n                                            // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                            saveData.push({\n                                                action: 'set_columns_types',\n                                                value: cols_selected\n                                            });\n                                            tableFunction.cleanHandsontable();\n                                            tableFunction.saveChanges(true);\n                                        });\n                                    },\n                                },\n                            ]\n                        },\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row < 1) {\n                                return true;\n                            }\n                            if (table_function_data.selectionSize > 1 || table_function_data.selection[0][3] - table_function_data.selection[0][1] > 0) {\n                                return true;\n                            }\n                            return false;\n                        }\n                    },\n                    \"hide_column\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined' && Wptm.newSelect === 'col') {\n                                var selection = table_function_data.selection;\n                                if (typeof Wptm.style.cols[selection[0][1]] !== 'undefined'\n                                    && Wptm.style.cols[selection[0][1]] !== null\n                                    && typeof Wptm.style.cols[selection[0][1]][1].hide_column !== 'undefined'\n                                    && Wptm.style.cols[selection[0][1]][1].hide_column == 1) {\n                                    return '<span class=\"selected\">' + wptmContext.hide_column + '</span>';\n                                } else {\n                                    return '<span>' + wptmContext.hide_column + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'col') {\n                                var selection = table_function_data.selection;\n                                if (typeof Wptm.style.cols[selection[0][1]] !== 'undefined' && Wptm.style.cols[selection[0][1]] !== null) {\n                                    if (typeof Wptm.style.cols[selection[0][1]][1].hide_column !== 'undefined' && Wptm.style.cols[selection[0][1]][1].hide_column == 1) {\n                                        Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {hide_column: 0}, selection[0][1]);\n                                    } else {\n                                        Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {hide_column: 1}, selection[0][1]);\n                                    }\n                                    tableFunction.saveChanges(true);\n                                }\n                                return true;\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            var selection = table_function_data.selection;\n                            if (typeof Wptm.newSelect === 'undefined' || Wptm.newSelect !== \"col\" || selection[0][3] - selection[0][1] >= 1) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    }\n                }\n            }\n            : {\n                items: {\n                    \"hide_column\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined' && Wptm.newSelect === 'col') {\n                                var selection = table_function_data.selection;\n                                if (typeof Wptm.style.cols[selection[0][1]] !== 'undefined'\n                                    && Wptm.style.cols[selection[0][1]] !== null\n                                    && typeof Wptm.style.cols[selection[0][1]][1].hide_column !== 'undefined'\n                                    && Wptm.style.cols[selection[0][1]][1].hide_column == 1) {\n                                    return '<span class=\"selected\">' + wptmContext.hide_column + '</span>';\n                                } else {\n                                    return '<span>' + wptmContext.hide_column + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'col') {\n                                var selection = table_function_data.selection;\n                                if (typeof Wptm.style.cols[selection[0][1]] !== 'undefined' && Wptm.style.cols[selection[0][1]] !== null) {\n                                    if (typeof Wptm.style.cols[selection[0][1]][1].hide_column !== 'undefined' && Wptm.style.cols[selection[0][1]][1].hide_column == 1) {\n                                        Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {hide_column: 0}, selection[0][1]);\n                                    } else {\n                                        Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {hide_column: 1}, selection[0][1]);\n                                    }\n                                }\n                                return true;\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            var selection = table_function_data.selection;\n                            if (typeof Wptm.newSelect === 'undefined' || Wptm.newSelect !== \"col\" || selection[0][3] - selection[0][1] >= 1) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"remove_alternating_color\": {\n                        name: wptmContext.remove_alternating_color,\n                        callback: function (key, selection, clickEvent) {\n                            tableFunction.fillArray(table_function_data, {allAlternate: {}});\n                            tableFunction.fillArray(Wptm.style.table, {allAlternate: {}});\n                            window.jquery(wptm_element.tableContainer).handsontable('render');\n                            tableFunction.saveChanges(true);\n                        },\n                        hidden: function () {\n                            if (typeof table_function_data.allAlternate !== 'undefined' && typeof table_function_data.allAlternate.even !== 'undefined') {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"delete_row_dbtable\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined') {\n                                if (Wptm.newSelect === 'row') {\n                                    return '<span>' + wptmContext.delete_row_db_table + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'row') {\n                                if (typeof Wptm.query_option.columns_list !== \"undefined\") {\n                                    var not_create = false;\n                                    var warning_craete = wptmText.warning_delete_row_db_table;\n\n                                    if (Wptm.query_option.tables_list.length > 1) {\n                                        not_create = true;\n                                        warning_craete = wptmText.warning_delete_row_multiple_db_table;\n                                    }\n\n                                    var selection = table_function_data.selection;\n                                    if (not_create || typeof Wptm.query_option.column_options[table_function_data.keyPosition] === 'undefined') {\n                                        tableFunction.wptmBootbox('', warning_craete, true, false);\n                                        return true;\n                                    } else if (typeof selection[0] !== 'undefined') {\n                                        tableFunction.wptmBootbox('', warning_craete, true, true, () => {\n                                            var id_row = Wptm.datas[selection[0][0]][table_function_data.keyPosition];\n                                            var field = Wptm.query_option.column_options[table_function_data.keyPosition].Field;\n                                            tableFunction.deleteRowDbTable(Wptm.query_option.tables_list[0], field, id_row);\n                                        });\n                                    }\n                                }\n                                return true;\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            var selection = table_function_data.selection;\n                            if (typeof Wptm.newSelect === 'undefined' || Wptm.newSelect !== \"row\" || selection[0][2] - selection[0][0] >= 1 || !table_function_data.mysqlEdit) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"create_row_dbtable\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined') {\n                                if (Wptm.newSelect === 'row') {\n                                    return '<span>' + wptmContext.create_row_db_table + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'row') {\n                                var popup = {\n                                    'html': wptm_element.content_popup_hide.find('#create_row_dbtable'),\n                                    'showAction': function () {\n                                        return true;\n                                    },\n                                    'submitAction': function () {\n                                        if (typeof Wptm.query_option.columns_list !== \"undefined\") {\n                                            var list_value = {};\n                                            var dbtable = '';\n                                            var not_create = false;\n                                            var warning_craete = '';\n                                            window.jquery.each(Wptm.query_option.columns_list, function (i, v) {\n                                                if (v.canEdit == 1) {\n                                                    var value = wptm_element.wptm_popup.find('input.table_column[data-column-name=\"' + v.table + '.' + v.Field + '\"]').val();\n                                                    var validate = tableFunction.validate_type_cell(\n                                                        v.Type,\n                                                        value\n                                                    );\n                                                    // if (!(typeof list_value[v.table] !== 'undefined')) {\n                                                    //     list_value[v.table] = {};\n                                                    // }\n                                                    // list_value[v.table][v.Field] = value;\n                                                    list_value[v.Field] = value;\n                                                    dbtable = v.table;\n                                                    if (Wptm.query_option.tables_list.length > 1) {\n                                                        not_create = true;\n                                                        warning_craete = wptmText.warning_craete_row_multiple_db_table;\n                                                    } else {\n                                                        if (!validate && v.Null !== 'YES') {\n                                                            not_create = true;\n                                                            warning_craete = wptmText.warning_craete_row_db_table;\n                                                        }\n                                                    }\n                                                }\n\n                                                if (Wptm.query_option.columns_list.length == i + 1) {\n                                                    if (not_create) {\n                                                        tableFunction.wptmBootbox('', warning_craete, true, false);\n                                                        return true;\n                                                    } else {\n                                                        tableFunction.createRowDbTable(dbtable, list_value);\n                                                        wptm_element.wptm_popup.find('.colose_popup').trigger('click');\n                                                        return true;\n                                                    }\n                                                }\n                                            });\n                                        }\n                                        return true;\n                                    },\n                                    'cancelAction': function () {\n                                        return true;\n                                    }\n                                };\n                                selectOption.wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            if (typeof Wptm.newSelect === 'undefined' || Wptm.newSelect !== \"row\" || !table_function_data.mysqlEdit) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"rows_size\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined') {\n                                var selectSize = table_function_data.selection[table_function_data.selectionSize - 1];\n                                if (Wptm.newSelect === 'row') {\n                                    if (selectSize[0] !== selectSize[2]) {\n                                        return '<span>' + wptmContext.define + 's ' + (selectSize[0] + 1) + '-' + (selectSize[2] + 1) + '</span>';\n                                    }\n                                    return '<span>' + wptmContext.define + '</span>';\n                                } else {\n                                    if (selectSize[1] !== selectSize[3]) {\n                                        return '<span>' + wptmContext.define + 's ' + String.fromCharCode(65 + selectSize[1]) + '-' + String.fromCharCode(65 + selectSize[3]) + '</span>';\n                                    }\n                                    return '<span>' + wptmContext.defineColumn + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'row') {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"resize_row\"]').trigger('click');\n                            } else {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"resize_column\"]').trigger('click');\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            if (typeof Wptm.newSelect === 'undefined' || (Wptm.newSelect !== \"row\" && Wptm.newSelect !== \"col\")) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"protect_range\": {\n                        name: function () {\n                            return '<span>' + wptmContext.protect_range + '</span>';\n                        },\n                        callback: function (key, selections, clickEvent) {\n                            wptm_element.primary_toolbars.find('.table_option[name=\"lock_ranger_cells\"]').trigger('click');\n                            return true;\n                        },\n                        hidden: function () {\n                            if (wptm_administrator == 1) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"Add tooltip\": {\n                        name: wptmContext.tooltip,\n                        callback: function (key, selection, clickEvent) {\n                            wptm_element.editToolTip.trigger('click');\n                        },\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row < 1) {\n                                return true;\n                            }\n                            if (table_function_data.selectionSize > 1\n                                || (table_function_data.selection[0][2] - table_function_data.selection[0][0] > 0\n                                    || table_function_data.selection[0][3] - table_function_data.selection[0][1] > 0)) {\n                                return true;\n                            }\n                            return false;\n                        }\n                    },\n                    \"Insert a cell selection\": {\n                        name: wptmContext.insert_selection,\n                        callback: function (key, selection, clickEvent) {\n                            wptm_element.primary_toolbars.find('.table_option[name=\"cell_insertion_shortcode\"]').trigger('click');\n                        },\n                        hidden: function () {\n                            return false;\n                        }\n                    }\n                }\n            })\n    });\n\n    wptm_element.tableContainer.find('.ht_clone_top_left_corner').unbind('click').on('click', function () {\n        var max_col = parseInt(Wptm.max_Col) > 0 ? Wptm.max_Col : Wptm.datas[0].length;\n        var max_row = parseInt(Wptm.max_row) > 0 ? Wptm.max_row : Wptm.datas.length;\n        jquery(wptm_element.tableContainer).handsontable(\"selectCells\", [[0, 0, max_row - 1, max_col - 1]]);\n    });\n\n    // search key\n    wptm_element.primary_toolbars.find('.search-menu').find('#dp-form-search').on('keyup', function (event) {\n        if (event.keyCode === 13) {\n            wptm_element.primary_toolbars.find('.search-menu').find('.search_table').trigger('click');\n        } else if (jquery(this).val() === '') {\n            wptm_element.primary_toolbars.find('.search-menu').find('.search_table').trigger('click');\n        }\n    });\n\n    wptm_element.primary_toolbars.find('.search-menu').find('.search_table').click(function () {\n        var textSearch = wptm_element.primary_toolbars.find('.search-menu').find('#dp-form-search');\n        var queryResult = jquery(Wptm.container).data('handsontable').getPlugin('search').query(textSearch.val());\n        jquery(Wptm.container).data('handsontable').render();\n    });\n\n    wptm_element.primary_toolbars.find('.search-menu').find('.reload_search').click(function () {\n        wptm_element.primary_toolbars.find('.search-menu').find('#dp-form-search').val('');\n        wptm_element.primary_toolbars.find('.search-menu').find('.search_table').trigger('click');\n    });\n\n    /*select menu option function*/\n    selectOption.selectOption();\n\n    /*more function Eg: rename table*/\n    window.wptm_element.primary_toolbars.find('.wptm_name_edit').text(window.Wptm.title);\n}\n\n/*\n* function change Wptm.mergeCellsSetting when mergecell/unMergeCell action\n*/\nfunction getMergeCells(argument, checkUnmerge) {\n    if (typeof window.table_function_data.mergeCells === 'undefined') {\n        window.table_function_data.mergeCells = [];\n        if (window.Wptm.mergeCellsSetting.length > 0) {\n            var i;\n            for (i = 0; i < window.Wptm.mergeCellsSetting.length; i++) {\n                window.table_function_data.mergeCells['d' + window.Wptm.mergeCellsSetting[i].row + window.Wptm.mergeCellsSetting[i].col] = window.Wptm.mergeCellsSetting[i];\n            }\n        }\n    }\n    if (checkUnmerge) {\n        for (i in table_function_data.mergeCells) {\n            if (argument[0].from.row <= table_function_data.mergeCells[i].row\n                && table_function_data.mergeCells[i].row <= argument[0].to.row\n                && argument[0].from.col <= table_function_data.mergeCells[i].col\n                && table_function_data.mergeCells[i].col <= argument[0].to.col) {\n                delete table_function_data.mergeCells[i];\n            }\n        }\n    } else {\n        var key = 'd' + argument[0].from.row + argument[0].from.col;\n        table_function_data.mergeCells[key] = argument[1];\n    }\n}\n\n/*\n* Function update mergecells when change rows and cols\n* */\nfunction updateMergeCells(firstRender) {\n    window.Wptm.mergeCellsSetting = [];\n    var ht = jquery(Wptm.container).handsontable('getInstance');\n    var mergeSetting = ht.getPlugin('mergeCells').mergedCellsCollection;\n    var i = 0, ij = 0, ij2 = 0;\n\n    if (mergeSetting.mergedCells.length < 1) {//save\n        tableFunction.saveChanges();\n    }\n\n    table_function_data.start_merge_cell_col = {};\n\n    for (i = 0; i < mergeSetting.mergedCells.length; i++) {\n        window.Wptm.mergeCellsSetting[i] = {\n            col: mergeSetting.mergedCells[i].col,\n            colspan: mergeSetting.mergedCells[i].colspan,\n            row: mergeSetting.mergedCells[i].row,\n            rowspan: mergeSetting.mergedCells[i].rowspan\n        };\n        if (typeof table_function_data.start_merge_cell_col[mergeSetting.mergedCells[i].col] == 'undefined') {\n            table_function_data.start_merge_cell_col[mergeSetting.mergedCells[i].col] = [];\n        }\n        table_function_data.start_merge_cell_col[mergeSetting.mergedCells[i].col][mergeSetting.mergedCells[i].row] = i;\n    }\n\n    if (firstRender) {\n        tableFunction.saveChanges(firstRender);\n    }\n}\n\n/*\n* calculator height table container\n* style: style of table,\n* getRowsHeight: true(get getRowHeight), false(not get getRowHeight),\n* top: true(get height of ht_clone_top), false(not get height of ht_clone_top)\n* */\nfunction calHeightTable(style, getRowsHeight, top, rowRender) {\n    var rows = style.rows.length;\n    if (rows === undefined) {\n        rows = Object.keys(style.rows).length;\n    }\n\n    var height = 0;\n    var htCloneTop = window.wptm_element.tableContainer.find('.ht_clone_top');\n\n    if (getRowsHeight) {\n        for (var i = 0; i < rows; i++) {\n            window.Wptm.rowsHeight[i] = window.Wptm.container.handsontable('getRowHeight', i);\n            height += window.Wptm.rowsHeight[i];\n        }\n    } else {\n        //remove setTimeout when resize rows\n        // clearTimeout(window.setHeightTable);\n\n        height = window.Wptm.table_height;\n        var newHeight = window.Wptm.container.handsontable('getRowHeight', rowRender);\n        if (typeof window.Wptm.rowsHeight[rowRender] === 'undefined') {\n            window.Wptm.rowsHeight[rowRender] = 0;\n        }\n        height += newHeight - window.Wptm.rowsHeight[rowRender];\n        window.Wptm.rowsHeight[rowRender] = newHeight;\n    }\n\n    if (top) {\n        height += htCloneTop.outerHeight();\n    }\n    return height;\n}\n\nconst changeCellAfterCreateRow = function (index, amount, selector, above) {\n    if (typeof (Wptm.style.cells) !== 'undefined') {\n        var $ = window.jquery;\n        var newCells = {};\n        var cell, i, cells;\n\n        for (cell in Wptm.style.cells) {\n            cells = Wptm.style.cells[cell];\n            if (cells[0] < index) {//rows < index\n                newCells[cell] = $.extend([], cells);\n            }\n\n            if (cells[0] >= index) {//rows >= index\n                if (typeof table_function_data.createCellWhenCopy !== 'undefined' && typeof table_function_data.createCellWhenCopy[cell] !== 'undefined') {\n                    newCells[cell] = $.extend([], cells);\n                } else {\n                    newCells[parseInt(cells[0] + amount) + '!' + cells[1]]\n                        = [cells[0] + amount, cells[1], $.extend({}, cells[2])];\n                }\n            }\n            if (cells[0] <= selector[2] && selector[0] <= cells[0]) {//new rows copy style of selector\n                if (typeof table_function_data.createCellWhenCopy !== 'undefined' && typeof table_function_data.createCellWhenCopy[cell] !== 'undefined') {\n                    newCells[cell] = $.extend([], cells);\n                } else {\n                    newCells[parseInt(cells[0] - selector[0] + index) + '!' + cells[1]]\n                        = [parseInt(cells[0] - selector[0] + index), cells[1], $.extend({}, cells[2])];\n                }\n            }\n        }\n        Wptm.style.cells = $.extend({}, newCells);\n\n        if (typeof Wptm.style.table.alternateColorValue !== 'undefined') {//update Wptm.style.table.alternateColorValue by index, amount\n            var alternateColorValue = Wptm.style.table.alternateColorValue;\n            for (i in alternateColorValue) {\n                if (alternateColorValue[i] !== false) {\n                    if (above) {//above\n                        if (alternateColorValue[i].selection[0] >= index + amount) { // alternateColorValue > new rows\n                            alternateColorValue[i].selection[0] = alternateColorValue[i].selection[0] + amount;\n                            alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] + amount;\n                        }\n                        if (alternateColorValue[i].selection[0] < index + amount && alternateColorValue[i].selection[2] >= index) {\n                            alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] + amount;\n                        }\n                    } else {//below\n                        if (alternateColorValue[i].selection[0] >= index) { // alternateColorValue > new rows\n                            alternateColorValue[i].selection[0] = alternateColorValue[i].selection[0] + amount;\n                            alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] + amount;\n                        }\n                        if (alternateColorValue[i].selection[0] < index && alternateColorValue[i].selection[2] >= selector[0]) {\n                            alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] + amount;\n                        }\n                    }\n                }\n            }\n        }\n\n        return true;\n    }\n    return false;\n}\n\n/**\n * Set position for html cell editer popup\n *\n * @param checkScroll Check whether to perform\n * @returns {boolean}\n */\nfunction afterScrollEditors (checkScroll) {\n    if (checkScroll === true) {\n        const selected = table_function_data.selection\n        if (typeof selected[0] !== 'undefined' ) {\n            let selectionCell = jquery(Wptm.container).handsontable('getCell', selected[0][0], selected[0][1])\n            let positionSelectionCell = jquery(selectionCell).offset()\n            let positionTableContainer = jquery('#tableContainer').offset()\n\n            wptm_element.handsontableInputHolder.removeClass('wptm_hiden')\n\n            // console.log('afterScrollEditors', wptm_element.handsontableInputHolder)\n            wptm_element.handsontableInputHolder[0].style.top = (positionSelectionCell.top - positionTableContainer.top) + 'px'\n            wptm_element.handsontableInputHolder[0].style.left = (positionSelectionCell.left - positionTableContainer.left) + 'px'\n        }\n    }\n    return false;\n}\n\nexport {initHandsontable, getMergeCells, calHeightTable}","import wptmPreview from \"./_wptm\";\nimport tableFunction from \"./_functions\";\nimport change_theme from \"./_changeTheme\";\nimport alternating from \"./_alternating\";\nimport DropChart from \"./_chart\";\n\n//Control functions when select table items\nconst selectOption = function () {\n    var wptm_element = window.wptm_element;\n    var popupOption = {};\n    var render = false;\n    var autoRender;\n    var check_saving;\n    var new_col_types = [];\n    var changed_cols = [];\n\n    if (!(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n        return false;\n    }\n\n    if (Wptm.max_Col * Wptm.max_row < 1) {\n        return false;\n    }\n\n    custom_select_box.call(window.jquery('#setting-cells .wptm_select_box_before'), window.jquery);\n\n    // jquery(Wptm.container).data('handsontable').getPlugin('hiddenColumns').query(textSearch.val());\n\n    wptm_element.primary_toolbars.find('.table_option:not(.menu_loading)').unbind('change click').on('change click', function (e) {\n        var function_data = window.table_function_data;\n        var Wptm = window.Wptm;\n        var $ = window.jquery;\n\n        if ($(this).parent('li.no_active').length > 0) {\n            return false;\n        }\n\n        var popup = $.extend({}, {});\n        var html = '';\n        //for undo\n        // var oldStyle = JSON.parse(JSON.stringify(Wptm.style));\n        //for mergecells\n        // var ht = Wptm.container.handsontable('getInstance');\n\n        var selection = {};\n        selection = table_function_data.selection;\n\n        /*click cell*/\n        switch ($(this).attr('name')) {\n            case 'rename_menu':\n                // Wptm.container.handsontable('updateSettings', {\n                //     hiddenColumns: {\n                //         columns: [2, 3],\n                //         indicators: true\n                //     }\n                // });\n                // var ht = jquery(Wptm.container).handsontable('getInstance');\n                // var hiddenColumnsPlugin = ht.getPlugin('hiddenColumns');\n                // hiddenColumnsPlugin.hideColumn(1, 4);\n                tableFunction.setText.call(\n                    $(this),\n                    wptm_element.primary_toolbars.find('.wptm_name_edit'),\n                    '#primary_toolbars .wptm_name_edit',\n                    {'url': wptm_ajaxurl + \"task=table.setTitle&id=\" + Wptm.id + '&title=', 'selected': true}\n                );\n                break;\n            case 'cell_insertion_shortcode':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#cell_insertion_shortcode'),\n                    'showAction': function () {\n                        var $filter = this.find('#cell_insertion_shortcode_filter');\n                        var $sort = this.find('#cell_insertion_shortcode_sort');\n                        var $download = this.find('#cell_insertion_shortcode_download');\n                        var $shortcode = this.find('.shortcode');\n                        var range = ' range=\"';\n                        var selectSize = table_function_data.selection[table_function_data.selectionSize - 1];\n                        if (Wptm.newSelect === 'row') {\n                            range += (selectSize[0] + 1) + '-' + (selectSize[2] + 1);\n                        } else if (Wptm.newSelect === 'col') {\n                            range += String.fromCharCode(65 + selectSize[1]) + '-' + String.fromCharCode(65 + selectSize[3]);\n                        } else {\n                            range += String.fromCharCode(65 + selectSize[1]) + (selectSize[0] + 1) + '-' + String.fromCharCode(65 + selectSize[3]) + (selectSize[2] + 1);\n                        }\n                        range += '\"';\n\n                        var render_shortcode = () => {\n                            var align = this.find('.wptm_input[name=\"cell_insertion_shortcode_align\"]:checked').val();\n                            if (typeof align === 'undefined') {\n                                this.find('#none').prop(\"checked\", true);\n                            }\n                            var shortcode = '[wptm id=' + Wptm.id + ($filter.is(\":checked\") ? ' filter=\"1\"' : '') + ($sort.is(\":checked\") ? ' sort=\"1\"' : '') + ($download.is(\":checked\") ? ' download=\"1\"' : '');\n                            shortcode += ' align=' + (typeof align === 'undefined' ? '\"none\"' : '\"' + align + '\"');\n                            if ($sort.is(\":checked\")) {\n                                shortcode += ' sortcolumn=\"' + this.find('#default_sort').data('value') + '\"';\n                                shortcode += ' sortorder=\"' + this.find('#default_order_sort').data('value') + '\"';\n                            }\n                            shortcode += range;\n                            shortcode += ']';\n                            $shortcode.val(shortcode).change();\n                            this.find('.copy_text').unbind('click').on('click', function (e) {\n                                tableFunction.copy_text($(e.target), '[wptm id=' + Wptm.id + range + ']');\n                                $(this).siblings('span').css({'opacity': 1});\n                                setTimeout(() => {\n                                    $(this).siblings('span').css({'opacity': 0});\n                                }, 1000);\n                                return true;\n                            });\n                            return true;\n                        }\n\n                        if (Wptm.newSelect !== 'row') {\n                            this.find('#default_sort').next('.wptm_select_box').addClass('hiddingCols');\n                            for (var i = selectSize[1]; i <= selectSize[3]; i++) {\n                                this.find('#default_sort').next('.wptm_select_box').find('li[data-value=\"' + i + '\"]').addClass('show').data('value', i - selectSize[1]);\n                            }\n                        }\n                        if (Wptm.newSelect !== 'row') {\n                            this.find('#default_sort').next('.wptm_select_box').data('value', 0);\n                            this.find('#default_sort').text(String.fromCharCode(65 + selectSize[1])).data('value', 0);\n                        } else {\n                            this.find('#default_sort').next('.wptm_select_box').data('value', 0);\n                            this.find('#default_sort').text('A').data('value', 0);\n                        }\n                        custom_select_box.call(this.find('#default_sort'), $, () => {\n                            render_shortcode()\n                        });\n\n                        this.find('#default_order_sort').next('.wptm_select_box').data('value', 1);\n                        this.find('#default_order_sort').text('ASC').data('value', 1);\n                        custom_select_box.call(this.find('#default_order_sort'), $, () => {\n                            render_shortcode()\n                        });\n\n                        this.find('.sortOrder').hide();\n\n                        this.find('#cell_insertion_shortcode_filter, #cell_insertion_shortcode_sort, .wptm_input[name=\"cell_insertion_shortcode_align\"], #cell_insertion_shortcode_download')\n                            .on('change', (e) => {\n                                if ($(e.target).is('#cell_insertion_shortcode_sort')) {\n                                    if ($(e.target).is(\":checked\")) {\n                                        this.find('.sortOrder').show();\n                                    } else {\n                                        this.find('.sortOrder').hide();\n                                    }\n                                }\n\n                                render_shortcode();\n                                return true;\n                            });\n\n                        render_shortcode();\n\n                        return true;\n                    },\n                    'submitAction': function () {\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, false);\n                break;\n            case 'save_menu':\n                tableFunction.saveChanges(true);\n                break;\n            case 'export_menu':\n                // if (Wptm.type == 'mysql') {\n                //     return false;\n                // }\n                html = '';\n                html += '<div>';\n                html += '<div  class=\"popup_top border_top\">';\n                html += '<span>' + wptmText.import_export_style + ' :</span>';\n                html += '</div>';\n                html += '<span class=\"popup_select style_export wptm_select_box_before\" data-value=\"1\">' + wptmText.import_export_data_styles + '</span>';\n                html += '<ul class=\"wptm_select_box\">';\n                html += '<li data-value=\"1\">' + wptmText.import_export_data_styles + '</li>';\n                html += '<li data-value=\"0\">' + wptmText.import_export_data_only + '</li>';\n                html += '</ul>';\n                html += '<div><input type=\"button\" class=\"wptm_button wptm_done\" value=\"Export excel\" id=\"export_excel\"></div>';\n                html += '</div>';\n                popup = {\n                    'html': $(html),\n                    'selector': {'export_excel': '.style_export'},\n                    'showAction': function () {\n                        custom_select_box.call(this.find('.style_export'), $);\n                    },\n                    'option': {'export_excel': 1},\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, false);\n\n                //Export-excel\n                $('#export_excel').bind('click', function (e) {\n                    var format = default_value.export_excel_format;\n                    var url = wptm_ajaxurl + 'task=excel.export&id=' + idTable + '&format_excel=' + format;\n\n                    url = url + '&onlydata=' + popup.option['export_excel'];\n\n                    $.fileDownload(url, {\n                        failCallback: function (html, url) {\n                            tableFunction.wptmBootbox('', html, true, false);\n                        }\n                    });\n                });\n                break;\n            case 'source_menu':\n                var curr_page = window.location.href;\n                var cells = curr_page.split(\"?\");\n                var new_url;\n                if (canInsert) {\n                    new_url = cells[0] + '?page=wptm&type=dbtable&id_table=' + idTable + '&noheader=1&caninsert=1';\n                } else {\n                    new_url = cells[0] + '?page=wptm&type=dbtable&id_table=' + idTable;\n                }\n                window.location = new_url;\n                break;\n            case 'access_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#access_menu'),\n                    'inputEnter': true,\n                    'showAction': function () {\n                        this.find('.wptm_done').addClass('wptm_blu');\n                        this.find('.wptm_cancel').addClass('wptm_grey');\n\n                        if (typeof Wptm.author !== 'undefined' && parseInt(Wptm.author) > 0) {\n                            this.find('#jform_role_table').val(parseInt(Wptm.author)).change();\n                        }\n\n                        return true;\n                    },\n                    'submitAction': function () {\n                        var author = this.find('#jform_role_table').val();\n                        if (parseInt(author) > 0 && parseInt(author) !== parseInt(Wptm.author)) {//change own category\n                            var jsonVar = {\n                                data: JSON.stringify({0: author}),\n                                id: Wptm.id,\n                                type: 1\n                            };\n                            $.ajax({\n                                url: wptm_ajaxurl + \"task=user.save\",\n                                dataType: \"json\",\n                                type: \"POST\",\n                                data: jsonVar,\n                                beforeSend: function () {\n                                    wptm_element.settingTable.find('.wptm_saving').removeClass('wptm_hiden');\n                                },\n                                success: function (datas) {\n                                    if (datas.response === true) {\n                                        Wptm.author = author;\n                                    } else {\n                                        tableFunction.wptmBootbox('', datas.response, true, false);\n                                    }\n                                    wptm_element.settingTable.find('.wptm_saving').addClass('wptm_hiden');\n                                },\n                                error: function (jqxhr, textStatus, error) {\n                                    tableFunction.wptmBootbox('', textStatus + ' : ' + error, true, false);\n                                }\n                            });\n                        }\n                        this.siblings('.colose_popup').trigger('click');\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'select_theme_menu':\n                if (Wptm.type == 'mysql') {\n                    return false;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#table_styles'),\n                    'showAction': function () {\n                        var image_hover_url = '';\n                        var $image_hover = '';\n                        var $image_height = 0;\n                        var max_size_window = {};\n                        max_size_window.height = $('#wpwrap').outerHeight();\n                        max_size_window.width = $('#wpwrap').outerWidth();\n                        wptm_element.wptm_popup.find('#table_styles li').mousemove(function (e) {\n                            var x = e.clientX;\n                            var y = e.clientY;\n                            var upside = 0;\n\n                            if (image_hover_url !== $(this).data('image')) {\n                                $('#wpwrap').find('.full_image').remove();\n                                image_hover_url = $(this).data('image');\n                                $image_hover = $('<img class=\"full_image\" style=\"width:500px\" src=\"' + image_hover_url + '\">');\n                                $('#wpwrap').append($image_hover);\n                            }\n\n                            if (max_size_window.width < (x + 500)) {\n                                upside += 2;\n                            }\n\n                            if ($image_hover.outerHeight() > 400) {\n                                $image_height = 400;\n                                $image_hover.css({height: 400, width: 'auto'});\n                            } else {\n                                $image_height = $image_hover.outerHeight();\n                            }\n                            if (max_size_window.height < (y + $image_height)) {\n                                upside++;\n                            }\n\n                            if (upside === 3) {\n                                $image_hover.css({top: y - $image_height - 20, left: x - 520});\n                            } else if (upside === 2) {\n                                $image_hover.css({top: y, left: x - 520});\n                            } else if (upside === 1) {\n                                $image_hover.css({top: y - $image_height - 20, left: x + 20});\n                            } else {\n                                $image_hover.css({top: y, left: x + 20});\n                            }\n                        }).mouseout(function (e) {\n                            $('#wpwrap').find('.full_image').remove();\n                            image_hover_url = '';\n                            image_hover_url = '';\n                        });\n                    },\n                    'cancelAction': function () {\n                        wptm_element.wptm_popup.find('#table_styles li').unbind('mousemove');\n                        $('#wpwrap').find('.full_image').remove();\n                        return true;\n                    }\n                };\n\n                wptm_popup(wptm_element.wptm_popup, popup, true);\n\n                wptm_element.wptm_popup.find('#table_styles a').click(function () {\n                    e.preventDefault();\n                    var cellsData = Wptm.container.handsontable('getData');\n                    var ret = true;\n                    var nbCols = 0;\n                    var id = $(this).data('id');\n\n                    //check table data exist\n                    $.each(cellsData, function (index, value) {\n                        nbCols = value.length;\n                        $.each(value, function (i, v) {\n                            if (v && v.toString().trim() !== '') {\n                                ret = false;\n                                return false;\n                            }\n                        });\n                    });\n\n                    change_theme(ret, id, cellsData);\n                })\n                break;\n            case 'alternate_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#alternating_color'),\n                    'showAction': function () {\n                        let selection, reSelection, valueRange;\n                        valueRange = ''\n                        if (Wptm.type === 'mysql') {\n                            Wptm.container.handsontable(\"selectAll\");\n                            selection = $.extend([], function_data.selection[0]);\n                        } else {\n                            if (typeof function_data.selection === 'undefined' || function_data.selection === undefined || function_data.selection === false) { //if unselected cells\n                                var i;\n                                if (_.size(function_data.oldAlternate) < 1 || typeof Wptm.style.table.alternateColorValue === 'undefined') {\n                                    selection = [0, 0, _.size(Wptm.style.cols) - 1, _.size(Wptm.style.rows) - 1];\n                                    valueRange = 'a1:';\n                                    //remove undefined cols in array\n                                    var cols = [];\n                                    for (i = 0; i < _.size(Wptm.style.cols); i++) {\n                                        if (typeof Wptm.style.cols[i] !== 'undefined' && Wptm.style.cols[i] !== undefined && Wptm.style.cols[i] !== null) {\n                                            cols[i] = Wptm.style.cols[i];\n                                        }\n                                    }\n                                    Wptm.style.cols = cols;\n\n                                    valueRange += String.fromCharCode(97 + _.size(Wptm.style.cols) - 1);\n                                    valueRange += _.size(Wptm.style.rows);\n                                }\n                            } else {\n                                selection = $.extend([], function_data.selection[0]);\n                                // check if selecting more than 3 rows then process\n                                var selection_rows = selection[2] - selection[0];\n                                if (selection_rows >= 2) {\n                                    if (_.size(function_data.oldAlternate) >= 1 || typeof Wptm.style.table.alternateColorValue !== 'undefined') {\n                                        for (var i = 0; i < _.size(function_data.oldAlternate); i++) {\n                                            var oldAlternateData = function_data.oldAlternate[i];\n                                            if (oldAlternateData !== false && typeof oldAlternateData.selection !== 'undefined') {\n                                                var isSameSelection = tableFunction.isSameArray(selection, oldAlternateData.selection);\n                                                if (isSameSelection) {\n                                                    var colorData = oldAlternateData.default.split('|');\n                                                    var dftAlternateHeader = colorData[0];\n                                                    var dftAlternateTile1 = colorData[1];\n                                                    var dftAlternateTile2 = colorData[2];\n                                                    var dftAlternateFooter = colorData[3];\n                                                    var currTile = this.find('.pane-color-tile[data-tile-header=\"' + dftAlternateHeader + '\"][data-tile-1=\"' + dftAlternateTile1 + '\"][data-tile-2=\"' + dftAlternateTile2 + '\"][data-tile-footer=\"' + dftAlternateFooter + '\"]');\n                                                    currTile.addClass('active');\n                                                    if (oldAlternateData.header !== '') {\n                                                        this.find('.banding-header-checkbox').trigger('click');\n                                                    }\n                                                    if (oldAlternateData.footer !== '') {\n                                                        this.find('.banding-footer-checkbox').trigger('click');\n                                                    }\n                                                }\n                                            }\n\n                                        }\n                                    }\n                                }\n                            }\n                        }\n\n                        if (function_data.selectionSize > 0) {\n                            selection = $.extend([], function_data.selection[0]);\n                            for (i = 0; i < function_data.selectionSize; i++) {\n                                if (function_data.selection[i][0] < selection[0]) {\n                                    selection[0] = function_data.selection[i][0];\n                                }\n                                if (function_data.selection[i][1] < selection[1]) {\n                                    selection[1] = function_data.selection[i][1];\n                                }\n                                if (function_data.selection[i][2] > selection[2]) {\n                                    selection[2] = function_data.selection[i][2];\n                                }\n                                if (function_data.selection[i][3] > selection[3]) {\n                                    selection[3] = function_data.selection[i][3];\n                                }\n                            }\n                            valueRange += String.fromCharCode(97 + selection[1]) + (selection[0] + 1)\n                                + ':' + String.fromCharCode(97 + selection[3]) + (selection[2] + 1);\n                        }\n\n                        if (valueRange !== '') {\n                            this.find('.cellRangeLabelAlternate').val(valueRange);\n                            this.find('#get_select_cells').trigger('click');\n                        }\n\n                        this.find('.formatting_style .pane-color-tile').on('click', (e) => {\n                            var that = $(e.currentTarget);\n                            //check exist selector and\n                            selection = $.extend([], function_data.selection[0]);\n\n                            if (typeof selection[1] !== 'undefined' && Math.abs(selection[0] - selection[2]) > 1) {\n                                if (Wptm.type === 'mysql') { //alternate for all cell\n                                    function_data.allAlternate = {};\n                                    function_data.allAlternate.even = that.data('tile-1');\n                                    function_data.allAlternate.old = that.data('tile-2');\n                                    function_data.allAlternate.header = that.data('tile-header');\n                                    function_data.allAlternate.footer = that.data('tile-footer');\n                                    function_data.allAlternate.default = '' + function_data.allAlternate.header + '|' + function_data.allAlternate.even + '|' + function_data.allAlternate.old + '|' + function_data.allAlternate.footer;\n\n                                    if (this.find('.banding-header-checkbox:checked').length < 1) {\n                                        function_data.allAlternate.header = '';\n                                    }\n\n                                    if (this.find('.banding-footer-checkbox:checked').length < 1) {\n                                        function_data.allAlternate.footer = '';\n                                    }\n                                    alternating.renderCell();\n                                } else {\n                                    var count = alternating.setNumberAlternate(selection, function_data.oldAlternate);\n\n                                    /*create/reset oldAlternate[count]*/\n                                    function_data.oldAlternate[count] = {};\n                                    function_data.oldAlternate[count].selection = selection;\n                                    function_data.oldAlternate[count].even = that.data('tile-1');\n                                    function_data.oldAlternate[count].old = that.data('tile-2');\n                                    function_data.oldAlternate[count].header = that.data('tile-header');\n                                    function_data.oldAlternate[count].footer = that.data('tile-footer');\n\n                                    function_data.oldAlternate[count].default = '' + function_data.oldAlternate[count].header + '|' + function_data.oldAlternate[count].even + '|' + function_data.oldAlternate[count].old + '|' + function_data.oldAlternate[count].footer;\n\n                                    if (this.find('.banding-header-checkbox:checked').length < 1) {\n                                        function_data.oldAlternate[count].header = '';\n                                    }\n\n                                    if (this.find('.banding-footer-checkbox:checked').length < 1) {\n                                        function_data.oldAlternate[count].footer = '';\n                                    }\n                                    alternating.selectAlternatingColor(function_data.oldAlternate, selection, count),\n                                        alternating.renderCell();\n                                }\n\n                                this.find('.pane-color-tile.active').removeClass('active');\n                                that.addClass('active');\n                            }\n                            return false;\n                        });\n\n                        this.find('.banding-header-footer-checkbox-wrapper input').on('click', (e) => {\n                            selection = $.extend([], function_data.selection[0]);\n                            if (typeof selection[1] !== 'undefined' && Math.abs(selection[0] - selection[2]) > 1) {\n                                if (Wptm.type === 'mysql') { //alternate for all cell\n                                    if (typeof function_data.allAlternate.default !== 'undefined') {\n                                        var defaultStyle = function_data.allAlternate.default.split(\"|\");\n\n                                        if (this.find('.banding-header-checkbox:checked').length > 0) {\n                                            function_data.allAlternate.header = defaultStyle[0];\n                                        } else {\n                                            function_data.allAlternate.header = '';\n                                        }\n\n                                        if (this.find('.banding-footer-checkbox:checked').length > 0) {\n                                            function_data.allAlternate.footer = defaultStyle[3];\n                                        } else {\n                                            function_data.allAlternate.footer = '';\n                                        }\n                                        alternating.renderCell();\n                                    }\n                                } else {\n                                    var oldCount = _.size(function_data.oldAlternate);\n                                    var count = alternating.setNumberAlternate(selection, function_data.oldAlternate);\n                                    if (oldCount !== count) {\n                                        var defaultStyle = [];\n                                        if (typeof function_data.oldAlternate[count].default !== 'undefined') {\n                                            defaultStyle = function_data.oldAlternate[count].default.split(\"|\");\n                                        } else {\n                                            if (this.find('.pane-color-tile.active').length > 0) {\n                                                defaultStyle[0] = this.find('.pane-color-tile.active').find('.pane-color-tile-header').data('value');\n                                                defaultStyle[3] = this.find('.pane-color-tile.active').find('.pane-color-tile-footer').data('value');\n                                            } else {\n                                                defaultStyle[0] = function_data.oldAlternate[count].header;\n                                                defaultStyle[3] = function_data.oldAlternate[count].footer;\n                                            }\n                                        }\n                                        if (this.find('.banding-header-checkbox:checked').length > 0) {\n                                            function_data.oldAlternate[count].header = defaultStyle[0];\n                                        } else {\n                                            function_data.oldAlternate[count].header = '';\n                                        }\n\n                                        if (this.find('.banding-footer-checkbox:checked').length > 0) {\n                                            function_data.oldAlternate[count].footer = defaultStyle[3];\n                                        } else {\n                                            function_data.oldAlternate[count].footer = '';\n                                        }\n\n                                        function_data.oldAlternate[count].default = '' + defaultStyle[0] + '|' + function_data.oldAlternate[count].even + '|' + function_data.oldAlternate[count].old + '|' + defaultStyle[3];\n\n                                        alternating.selectAlternatingColor(function_data.oldAlternate, selection, count),\n                                            alternating.renderCell();\n                                    }\n                                }\n                            }\n                            return true;\n                        });\n\n                        this.find('#alternate_color_done').click((e) => {\n                            e.preventDefault();\n                            alternating.applyAlternate.call(this);\n                        });\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        if (_.size(function_data.checkChangeAlternate) > 0) {\n                            if (Wptm.type === 'mysql') { //alternate for all cell\n                                function_data.allAlternate = {};\n                            } else {\n                                Wptm.style.cells = $.extend({}, alternating.reAlternateColor());\n                                function_data.oldAlternate = $.extend({}, Wptm.style.table.alternateColorValue);\n                            }\n\n                            alternating.renderCell();\n                        }\n                        return true;\n                    }\n                };\n                if (Wptm.type === 'mysql') {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, false);\n                } else {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, true);\n                }\n                break;\n            case 'resize_column':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#column_size_menu'),\n                    'inputEnter': true,\n                    'showAction': function () {\n                        let selection = function_data.selection;\n\n                        this.find('#jform_row_height-lbl').closest('.control-group').addClass('wptm_hiden');\n                        this.find('.popup_top span').text(wptmContext.columns_width_start);\n\n                        if (function_data.selectionSize < 2) {\n                            let text = ''\n                            text = tableFunction.getSelectedVal([null, selection[0][1], null, selection[0][3]])\n\n                            this.find('#jform_col_width-lbl').text(wptmContext.columns_width_start + text)\n                        }\n\n                        if (function_data.selectionSize > 1) {\n                            this.find('#jform_col_width-lbl').text(wptmContext.columns_width_start);\n\n                            var text = ''\n                            tableFunction.eventToCellsSelected(\n                                selection,\n                                function_data.selectionSize,\n                                (ranger, i) => {\n                                    return new Promise((resolve) => {\n                                        if (text !== '') {\n                                            text += ','\n                                        }\n                                        text += tableFunction.getSelectedVal([ranger[0], ranger[1], ranger[2], ranger[3]])\n                                        resolve(true)\n                                    })\n                                },\n                                null,\n                                null,\n                                () => {\n                                    return new Promise((resolve) => {\n                                        this.find('.cellRangeLabelAlternate').val(text);\n                                    })\n                                })\n                        }\n\n                        this.find('.cellRangeLabelAlternate').addClass('select_column').data('text_change', '#jform_col_width-lbl');\n                        return true;\n                    },\n                    'submitAction': function () {\n                        var col_width_val = this.find('#cell_col_width').val();\n                        selection = function_data.selection;\n                        if (typeof selection !== 'undefined' && selection !== undefined && function_data.selectionSize > 0) {\n                            tableFunction.eventToCellsSelected(selection, function_data.selectionSize, (ranger, ii) => {\n                                return new Promise((resolve) => {\n                                    for (let i = ranger[1]; i <= ranger[3]; i++) {\n                                        if (typeof Wptm.style.cols[i] === 'undefined' || Wptm.style.cols[i] === null) {\n                                            Wptm.style.cols[i] = [i, {width: parseInt(col_width_val)}];\n                                        }\n                                        Wptm.style.cols[i][1].width = parseInt(col_width_val);\n                                    }\n\n                                    resolve(true)\n                                })\n                            }, null, null, () => {\n                                return new Promise((resolve) => {\n                                    table_function_data.needSaveAfterRender = true;\n                                    tableFunction.pullDims(Wptm, $);\n\n                                    this.siblings('.colose_popup').trigger('click');\n                                    tableFunction.saveChanges(true);\n                                })\n                            })\n                        } else {\n                            this.siblings('.colose_popup').trigger('click');\n                        }\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        wptm_element.wptm_popup.find('.content').contents().remove();\n                        return true;\n                    }\n                };\n                if (Wptm.type === 'mysql') {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, false);\n                } else {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, true);\n                }\n                break;\n            case 'resize_row':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#column_size_menu'),\n                    'inputEnter': true,\n                    'showAction': function () {\n                        var selection = function_data.selection;\n                        tableFunction.getSizeCells($, Wptm, [selection[0][2], selection[0][3]]);\n\n                        this.find('#jform_col_width-lbl').closest('.control-group').addClass('wptm_hiden');\n                        this.find('.popup_top span').text(wptmContext.rows_height_start);\n                        if (Wptm.type === 'mysql') {\n                            this.find('#all_cell_row_height').closest('.control-group').removeClass('wptm_hiden');\n                            this.find('#jform_row_height-lbl').text(wptmContext.row_height + ' (header):');\n                            this.find('#all_cell_row_height').val(Wptm.style.table.allRowHeight);\n                        } else {\n                            if (function_data.selectionSize > 1) {\n                                this.find('#jform_row_height-lbl').text(wptmContext.rows_height);\n                            } else {\n                                if (selection[0][0] !== selection[0][2]) {//rows\n                                    this.find('#jform_row_height-lbl')\n                                        .text(wptmContext.rows_height_start + (selection[0][0] + 1) + '-' + (selection[0][2] + 1));\n                                }\n                            }\n                        }\n\n                        this.find('.cellRangeLabelAlternate').addClass('select_row').data('text_change', '#jform_row_height-lbl')\n\n                        var text = '';\n                        tableFunction.eventToCellsSelected(\n                            selection,\n                            function_data.selectionSize,\n                            (ranger, i) => {\n                                return new Promise((resolve) => {\n                                    if (text !== '') {\n                                        text += ','\n                                    }\n\n                                    text += tableFunction.getSelectedVal([ranger[0], ranger[1], ranger[2], ranger[3]])\n                                    resolve(true)\n                                })\n                            },\n                            null,\n                            null,\n                            () => {\n                                return new Promise((resolve) => {\n                                    this.find('.cellRangeLabelAlternate').val(text);\n                                })\n                            })\n\n                        return true;\n                    },\n                    'submitAction': function () {\n                        var row_height_val = this.find('#cell_row_height').val();\n                        var all_row_height_val = this.find('#all_cell_row_height').val();\n                        selection = function_data.selection;\n\n                        if (typeof selection !== 'undefined' && selection !== undefined && function_data.selectionSize > 0) {\n                            tableFunction.eventToCellsSelected(selection, function_data.selectionSize, (ranger, j) => {\n                                return new Promise((resolve) => {\n                                    for (let i = ranger[0]; i <= ranger[2]; i++) {\n                                        if (Wptm.type !== 'mysql') {\n                                            if (typeof Wptm.style.rows[i] === 'undefined') {\n                                                Wptm.style.rows[i] = [i, {height: parseInt(row_height_val)}];\n                                            }\n                                            Wptm.style.rows[i][1].height = parseInt(row_height_val);\n                                        }\n                                    }\n\n                                    if (Wptm.type == 'mysql') {\n                                        Wptm.style.rows[0][1].height = r\n                                        ow_height_val;\n                                        var all_heigt = parseFloat(all_row_height_val);\n                                        for (let i = 1; i < Wptm.max_row; i++) {\n                                            if (typeof Wptm.style.rows[i] === 'undefined') {\n                                                Wptm.style.rows[i] = [i, {height: all_heigt}];\n                                            }\n                                            Wptm.style.rows[i][1].height = all_heigt;\n                                        }\n                                        Wptm.style.table = tableFunction.fillArray(Wptm.style.table, {allRowHeight: all_heigt});\n                                    }\n\n                                    resolve(true)\n                                })\n                            }, null, null, () => {\n                                return new Promise((resolve) => {\n                                    table_function_data.needSaveAfterRender = true;\n                                    tableFunction.pullDims(Wptm, $);\n\n                                    this.siblings('.colose_popup').trigger('click');\n                                    tableFunction.saveChanges(true);\n                                })\n                            })\n                        } else {\n                            this.siblings('.colose_popup').trigger('click');\n                            tableFunction.saveChanges(true);\n                        }\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        wptm_element.wptm_popup.find('.content').contents().remove();\n                        return true;\n                    }\n                };\n                if (Wptm.type === 'mysql') {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, false);\n                } else {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, true);\n                }\n                break;\n            case 'header_option_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#header_option'),\n                    'showAction': function () {\n                        var length = -1;\n                        for (var i = 4; i > 0; i--) {\n                            if (typeof Wptm.datas[i] !== 'undefined') {\n                                for (var ii = 0; ii < Wptm.datas[i].length; ii++) {\n                                    if (Wptm.datas[i][ii] !== '') {\n                                        length = i;\n                                        break;\n                                    }\n                                }\n                            }\n                            if (length > -1) {\n                                break;\n                            }\n                        }\n                        this.find('#number_first_rows').next().find('li[data-value=' + (length + 1) + ']').nextAll().hide();\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm, 'headerOption', this.find('#number_first_rows').next('.wptm_select_box'), length + 1 > 0 ? 1 : 0);\n                        if (Wptm.type == 'mysql') {\n                            this.find('#number_first_rows').addClass('no_active');\n                        } else {\n                            custom_select_box.call(this.find('#number_first_rows'), $);\n                        }\n                        //freeze_row\n                        var freeze_row = parseInt(Wptm.style.table.freeze_row) > 0 ? 1 : 0;\n                        tableFunction.updateSwitchButtonFromStyleObject({'freeze_row': freeze_row}, 'freeze_row', this.find('#freeze_row'), '0');\n                    },\n                    'submitAction': function () {\n                        if (Wptm.type !== 'mysql') {\n                            if (this.find('#number_first_rows').data('value') !== '') {\n                                if (this.find('#number_first_rows').data('value') != Wptm.headerOption) {\n                                    saveData.push({\n                                        action: 'set_header_option',\n                                        value: this.find('#number_first_rows').data('value')\n                                    });\n                                }\n                                Wptm.headerOption = parseInt(this.find('#number_first_rows').data('value'));\n                            }\n                        }\n\n                        Wptm.style.table.freeze_row = this.find(\"#freeze_row\").is(\":checked\") ? 1 : 0;\n                        if (Wptm.style.table.freeze_row > 0) {\n                            $(Wptm.container).handsontable('updateSettings', {fixedRowsTop: Wptm.headerOption});\n                        } else {\n                            $(Wptm.container).handsontable('updateSettings', {fixedRowsTop: 0});\n                        }\n\n                        tableFunction.saveChanges(true);\n                        this.siblings('.colose_popup').trigger('click');\n\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'form_filter_table':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#form_filter_table'),\n                    'showAction': function () {\n                        /*get list checkBox value*/\n                        let checkBoxDefault = Array.from({length: Wptm.max_Col}, (_, i) => []);\n                        for (let key in Wptm.datas.slice(0, 100)) {\n                            if (parseInt(Wptm.style.table.headerOption) <= key) {\n                                let row = Wptm.datas[key];\n                                for (let i = 0; i < Wptm.max_Col; i++) {\n                                    if (checkBoxDefault[i].indexOf(row[i]) === -1) {\n                                        checkBoxDefault[i].push(row[i])\n                                    }\n                                }\n                            }\n                        }\n\n                        // enable_filters\n                        //use_sortable default_order_sortable default_sortable\n                        let $listColumnConfig = this.find('.listColumnConfig')\n                        for (let key in Wptm.style.cols) {\n                            let colStyle = Wptm.style.cols[key]\n                            let $columnConfig = this.find('.columnConfig.wptm_hiden').clone().removeClass('wptm_hiden')\n                            let $component = $columnConfig.find('div.option')\n\n                            $($component[0]).find('span').text(String.fromCharCode(97 + colStyle[0]))\n\n                            tableFunction.updateParamFromStyleObjectSelectBox(\n                                colStyle[1],\n                                'searchContentType',\n                                $($component[1]).find('span').next('.wptm_select_box'),\n                                'text'\n                            );\n                            const inputType = (type, that) => {\n                                switch (type) {\n                                    case 'date':\n                                        that.type = 'date'\n                                        break;\n                                    case 'text':\n                                    case 'number':\n                                    default:\n                                        that.type = 'number'\n                                        break;\n                                }\n                                return false;\n                            }\n                            const disableFilterType = (type, that) => {\n                                let $select = that.find('li[data-value=\"select\"]')\n                                let $input = that.find('li[data-value=\"input\"]')\n                                let $checkBox = that.find('li[data-value=\"checkBox\"]')\n                                let $range = that.find('li[data-value=\"range\"]')\n                                switch (type) {\n                                    case 'date':\n                                        $checkBox.addClass('wptm_turn_off')\n                                        $range.removeClass('wptm_turn_off')\n                                        break;\n                                    case 'text':\n                                        $range.addClass('wptm_turn_off')\n                                        $checkBox.removeClass('wptm_turn_off')\n                                        break;\n                                    case 'number':\n                                    default:\n                                        $select.removeClass('wptm_turn_off')\n                                        $input.removeClass('wptm_turn_off')\n                                        $checkBox.removeClass('wptm_turn_off')\n                                        $range.removeClass('wptm_turn_off')\n                                        break;\n                                }\n                                return false;\n                            }\n                            custom_select_box.call($($component[1]).find('span'), $,\n                                (value) => {\n                                    inputType(value, $($component[7]).find('input')[0])\n                                    inputType(value, $($component[8]).find('input')[0])\n                                    disableFilterType(value, $($component[4]))\n                                    return false;\n                                },\n                                false,\n                                () => {\n                                    inputType(colStyle[1]?.searchContentType, $($component[7]).find('input')[0])\n                                    inputType(colStyle[1]?.searchContentType, $($component[8]).find('input')[0])\n                                    disableFilterType(colStyle[1]?.searchContentType, $($component[4]))\n                                }\n                            )\n\n                            tableFunction.updateSwitchButtonFromStyleObject(\n                                colStyle[1], 'sortable',  $($component[2]).find('input'), '1');\n\n                            tableFunction.updateSwitchButtonFromStyleObject(\n                                colStyle[1], 'filter',  $($component[3]).find('input'), '1');\n\n                            tableFunction.updateParamFromStyleObjectSelectBox(\n                                colStyle[1],\n                                'searchType',\n                                $($component[4]).find('span').next('.wptm_select_box'),\n                                'none'\n                            );\n                            custom_select_box.call($($component[4]).find('span'), $,\n                                (value) => {\n                                    $($component[7]).addClass('wptm_turn_off')\n                                    $($component[8]).addClass('wptm_turn_off')\n                                    switch (value) {\n                                        case 'none':\n                                        default:\n                                            $($component[5]).addClass('wptm_turn_off')\n                                            $($component[6]).addClass('wptm_turn_off')\n                                            break;\n                                        case 'select':\n                                        case 'input':\n                                            $($component[5]).removeClass('wptm_turn_off')\n                                            $($component[6]).addClass('wptm_turn_off')\n                                            break;\n                                        case 'range':\n                                            $($component[5]).removeClass('wptm_turn_off')\n                                            $($component[6]).addClass('wptm_turn_off')\n                                            $($component[7]).removeClass('wptm_turn_off')\n                                            $($component[8]).removeClass('wptm_turn_off')\n\n                                            inputType(colStyle[1]?.searchContentType, $($component[7]).find('input')[0])\n                                            inputType(colStyle[1]?.searchContentType, $($component[8]).find('input')[0])\n                                            break;\n                                        case 'checkBox':\n                                            $($component[5]).removeClass('wptm_turn_off')\n                                            $($component[6]).removeClass('wptm_turn_off')\n                                            break;\n                                    }\n                                    return false;\n                                },\n                                false,\n                                () => {\n                                    $($component[7]).addClass('wptm_turn_off')\n                                    $($component[8]).addClass('wptm_turn_off')\n                                    switch (colStyle[1]?.searchType) {\n                                        case 'none':\n                                        default:\n                                            $($component[5]).addClass('wptm_turn_off')\n                                            $($component[6]).addClass('wptm_turn_off')\n                                            break;\n                                        case 'select':\n                                        case 'input':\n                                            $($component[5]).removeClass('wptm_turn_off')\n                                            $($component[6]).addClass('wptm_turn_off')\n                                            break;\n                                        case 'range':\n                                            $($component[5]).removeClass('wptm_turn_off')\n                                            $($component[6]).addClass('wptm_turn_off')\n                                            $($component[7]).removeClass('wptm_turn_off')\n                                            $($component[8]).removeClass('wptm_turn_off')\n\n                                            break;\n                                        case 'checkBox':\n                                            $($component[5]).removeClass('wptm_turn_off')\n                                            $($component[6]).removeClass('wptm_turn_off')\n                                            break;\n                                    }\n                                }\n                            )\n\n                            $($component[5]).find('input').val(colStyle[1]?.enable_filters_label || (Wptm.datas[0][colStyle[0]] || String.fromCharCode(97 + colStyle[0])))\n\n                            for (let i in checkBoxDefault[key]) {\n                                let $default = $($component[6]).find('span').next('.wptm_select_box').find('li.data_all').clone()\n                                $default.removeClass('data_all').html('<input type=\"checkbox\"/>' + checkBoxDefault[key][i]).attr('data-value', checkBoxDefault[key][i]).data('value', checkBoxDefault[key][i]).change()\n                                $($component[6]).find('span').next('.wptm_select_box').append($default);\n                            }\n                            custom_select_box.call($($component[6]).find('span'), $, null, true);\n                            tableFunction.updateParamFromStyleObjectSelectBox(colStyle[1], 'checkBoxContent', $($component[6]).find('span').next('.wptm_select_box'), 'all_value', null, true);\n\n                            $($component[7]).find('input').val(colStyle[1]?.min)\n                            $($component[8]).find('input').val(colStyle[1]?.max)\n\n                            $listColumnConfig.append($columnConfig);\n                        }\n\n                        let $filterOptions = this.find('.container:not(.wptm_hiden) .filterOptions')\n                        let $filter = this.find('.container:not(.wptm_hiden) .filter')\n                        let $sort = this.find('.container:not(.wptm_hiden) .sort')\n                        let $default_sortable = this.find('#default_sortable')\n                        let $default_order_sortable = this.find('#default_order_sortable')\n                        let $form_filter_table = this.find('#form_filter_table')\n                        let $submit_form = this.find('#submit_form')\n                        let $clear_form = this.find('#clear_form')\n\n                        //filter: none, column filter, form filter\n                        tableFunction.updateParamFromStyleObjectSelectBox(\n                            Wptm.style.table,\n                            'enable_filters',\n                            this.find('#enable_filters').next('.wptm_select_box'),\n                            '0'\n                        );\n                        custom_select_box.call(this.find('#enable_filters'), $, (value) => {\n                            switch (parseInt(value)) {\n                                case 2:\n                                    $submit_form.parent().removeClass('wptm_hiden')\n                                    $clear_form.parent().removeClass('wptm_hiden')\n                                    $filter.addClass('wptm_hiden').removeClass('wptm_turn_off')\n                                    $filterOptions.removeClass('wptm_hiden')\n                                    $form_filter_table.removeClass('fullList')\n                                    break;\n                                case 1:\n                                    $submit_form.parent().addClass('wptm_hiden')\n                                    $clear_form.parent().addClass('wptm_hiden')\n                                    $filter.removeClass('wptm_hiden wptm_turn_off')\n                                    $filterOptions.addClass('wptm_hiden')\n                                    $form_filter_table.addClass('fullList')\n                                    break;\n                                case 0:\n                                default:\n                                    $submit_form.parent().addClass('wptm_hiden')\n                                    $clear_form.parent().addClass('wptm_hiden')\n                                    $filter.removeClass('wptm_hiden').addClass('wptm_turn_off')\n                                    $filterOptions.addClass('wptm_hiden')\n                                    $form_filter_table.addClass('fullList')\n                                    break;\n                            }\n                        }, false, () => {\n                            switch (parseInt(Wptm.style.table?.enable_filters)) {\n                                case 2:\n                                    $submit_form.parent().removeClass('wptm_hiden')\n                                    $clear_form.parent().removeClass('wptm_hiden')\n                                    $filter.addClass('wptm_hiden').removeClass('wptm_turn_off')\n                                    $filterOptions.removeClass('wptm_hiden')\n                                    $form_filter_table.removeClass('fullList')\n                                    break;\n                                case 0:\n                                    $submit_form.parent().addClass('wptm_hiden')\n                                    $clear_form.parent().addClass('wptm_hiden')\n                                    $filter.addClass('wptm_turn_off')\n                                    $filterOptions.addClass('wptm_hiden')\n                                    $form_filter_table.addClass('fullList')\n                                    break;\n                                case 1:\n                                    $submit_form.parent().addClass('wptm_hiden')\n                                    $clear_form.parent().addClass('wptm_hiden')\n                                    $filter.removeClass('wptm_hiden wptm_turn_off')\n                                    $filterOptions.addClass('wptm_hiden')\n                                    $form_filter_table.addClass('fullList')\n                                    break;\n                                default:\n                                    $submit_form.parent().addClass('wptm_hiden')\n                                    $clear_form.parent().addClass('wptm_hiden')\n                                    $filter.removeClass('wptm_hiden').addClass('wptm_turn_off')\n                                    $filterOptions.addClass('wptm_hiden')\n                                    $form_filter_table.addClass('fullList')\n                                    break;\n                            }\n                        });\n\n                        /*search all*/\n                        tableFunction.updateSwitchButtonFromStyleObject(\n                            Wptm.style.table, 'enable_filters_all', this.find('#enable_filters_all'), '0')\n\n                        /*submit_form*/\n                        tableFunction.updateSwitchButtonFromStyleObject(\n                            Wptm.style.table, 'submit_form', $submit_form, '0')\n                        /*clear_form*/\n                        tableFunction.updateSwitchButtonFromStyleObject(\n                            Wptm.style.table, 'clear_form', $clear_form, '0')\n\n                        /*sort*/\n                        tableFunction.updateSwitchButtonFromStyleObject(\n                            Wptm.style.table, 'use_sortable', this.find('#use_sortable'), '0', function (value) {\n                                switch (parseInt(value)) {\n                                    case 1:\n                                        $sort.removeClass('wptm_turn_off')\n                                        $default_sortable.removeClass('wptm_turn_off')\n                                        $default_order_sortable.removeClass('wptm_turn_off')\n                                        break;\n                                    case 0:\n                                    default:\n                                        $sort.addClass('wptm_turn_off')\n                                        $default_sortable.addClass('wptm_turn_off')\n                                        $default_order_sortable.addClass('wptm_turn_off')\n                                        break;\n                                }\n                            }, function () {\n                                if ($(this).is(\":checked\")) {\n                                    $sort.removeClass('wptm_turn_off')\n                                    $default_sortable.removeClass('wptm_turn_off')\n                                    $default_order_sortable.removeClass('wptm_turn_off')\n                                }\n                                else {\n                                    $sort.addClass('wptm_turn_off')\n                                    $default_sortable.addClass('wptm_turn_off')\n                                    $default_order_sortable.addClass('wptm_turn_off')\n                                }\n                            });\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'default_sortable', $default_sortable.next('.wptm_select_box'), '0');\n                        custom_select_box.call($default_sortable, $);\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'default_order_sortable', $default_order_sortable.next('.wptm_select_box'), '1');\n                        custom_select_box.call($default_order_sortable, $);\n                        tableFunction.wptm_tooltip(this)\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.enable_filters = this.find('#enable_filters').data('value')\n                        Wptm.style.table.enable_filters_all = this.find('#enable_filters_all').is(\":checked\") ? 1 : 0\n                        Wptm.style.table.submit_form = this.find('#submit_form').is(\":checked\") ? 1 : 0\n                        Wptm.style.table.clear_form = this.find('#clear_form').is(\":checked\") ? 1 : 0\n                        Wptm.style.table.use_sortable = this.find('#use_sortable').is(\":checked\") ? 1 : 0\n                        Wptm.style.table.default_order_sortable = this.find('#default_order_sortable').data('value')\n                        Wptm.style.table.default_sortable = this.find('#default_sortable').data('value')\n                        this.find('.columnConfig:not(.wptm_hiden)').each(function (i, e) {\n                            Wptm.style.cols[i][1].searchContentType = $(this).find('.searchContentType').data('value')\n                            Wptm.style.cols[i][1].sortable = $(this).find('.sortable').is(\":checked\") ? 1 : 0\n                            Wptm.style.cols[i][1].filter = $(this).find('.use_filter_column').is(\":checked\") ? 1 : 0\n                            Wptm.style.cols[i][1].searchType = $(this).find('.searchType').data('value')\n                            Wptm.style.cols[i][1].enable_filters_label = $(this).find('.enable_filters_label').val()\n                            Wptm.style.cols[i][1].checkBoxContent = $(this).find('.checkBoxContent').data('value')\n                            Wptm.style.cols[i][1].min = $(this).find('.minValue input').val() || ''\n                            Wptm.style.cols[i][1].max = $(this).find('.maxValue input').val() || ''\n                        })\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'download_button_menu':\n                if ($(this).parent().hasClass('selected')) {\n                    Wptm.style.table.download_button = 0;\n                    $(this).parent().removeClass('selected');\n                } else {\n                    Wptm.style.table.download_button = 1;\n                    $(this).parent().addClass('selected');\n                }\n                tableFunction.saveChanges(true);\n                break;\n            case 'print_button_menu':\n                if ($(this).parent().hasClass('selected')) {\n                    Wptm.style.table.print_button = 0;\n                    $(this).parent().removeClass('selected');\n                } else {\n                    Wptm.style.table.print_button = 1;\n                    $(this).parent().addClass('selected');\n                }\n                tableFunction.saveChanges(true);\n                break;\n            case 'column_type_menu':\n                tableFunction.default_sortable(window.Wptm.datas);\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#column_type_table'),\n                    'showAction': function () {\n                        var col_types = Wptm.style.table.col_types;\n\n                        this.find('tbody tr').each(function () {\n                            var i = $(this).data('col');\n                            col_types[i] = typeof col_types[i] !== 'undefined' ? col_types[i].toLowerCase() === 'varchar(255)' ? 'varchar' : col_types[i].toLowerCase() : 'varchar';\n                            if (Wptm.type === 'mysql') {\n                                $(this).find('.wptm_select_box_before').addClass('no_active').text(col_types[i]);\n                            } else {\n                                tableFunction.updateParamFromStyleObjectSelectBox(col_types, i, $(this).find('.wptm_select_box'), 'varchar');\n                                custom_select_box.call($(this).find('.column_type'), $);\n                            }\n                        });\n                    },\n                    'submitAction': function () {\n                        var cols_selected = [];\n                        if (Wptm.type !== 'mysql') {\n                            this.find('tbody tr').each(function () {\n                                var i = $(this).data('col');\n                                var that = $(this).find('.wptm_select_box_before');\n                                if (that.data('value') !== '') {\n                                    if (that.data('value') != Wptm.style.table.col_types[i]) {\n                                        cols_selected[i] = that.data('value');\n                                    }\n                                    Wptm.style.table.col_types[i] = that.data('value');\n                                }\n                            });\n\n                            if (cols_selected.length > 0) {\n                                saveData.push({\n                                    action: 'set_columns_types',\n                                    value: cols_selected\n                                });\n                            }\n                            tableFunction.cleanHandsontable();\n                            tableFunction.saveChanges(true);\n                        }\n                        this.siblings('.colose_popup').trigger('click');\n\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'responsive_menu':\n                tableFunction.default_sortable(window.Wptm.datas);\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#responsive_table'),\n                    'selector': {\n                        'responsive_type': '#responsive_type',\n                        'table_breakpoint': '.table_breakpoint',\n                        'table_height': '.table_height',\n                        'freeze_col': '#freeze_col',\n                        'responsive_col': '#responsive_col',\n                        'style_repeated': '#style_repeated',\n                        'responsive_priority': '#responsive_priority'\n                    },\n                    'option': {\n                        'responsive_type': Wptm.style.table.responsive_type,\n                        'freeze_col': Wptm.style.table.freeze_col,\n                        'table_height': Wptm.style.table.table_height,\n                        'style_repeated': Wptm.style.table.style_repeated,\n                        'table_breakpoint': Wptm.style.table.table_breakpoint,\n                    },\n                    'showAction': function () {\n                        tableFunction.updateParamFromStyleObjectSelectBox(popup.option, 'responsive_type', this.find('#responsive_type').next('.wptm_select_box'), 'scroll');\n                        custom_select_box.call(this.find('#responsive_type'), $);\n\n                        tableFunction.updateParamFromStyleObjectSelectBox(popup.option, 'freeze_col', this.find('#freeze_col').next('.wptm_select_box'), '0');\n                        custom_select_box.call(this.find('#freeze_col'), $);\n\n                        tableFunction.updateParamFromStyleObjectSelectBox(popup.option, 'style_repeated', this.find('#style_repeated').next('.wptm_select_box'), '0');\n                        custom_select_box.call(this.find('#style_repeated'), $);\n\n                        tableFunction.updateParamFromStyleObject(popup.option, 'table_height', this.find('.table_height'), '0');\n                        tableFunction.updateParamFromStyleObject(popup.option, 'table_breakpoint', this.find('.table_breakpoint'), '980');\n\n                        this.find('table tr .responsive_priority').each(function () {\n                            custom_select_box.call($(this), $);\n                        });\n\n                        popup.inputAction.call(this, 'responsive_type');\n                        check_saving = false;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.responsive_type = this.find('#responsive_type').data('value');\n                        Wptm.style.table.freeze_col = this.find(\"#freeze_col\").data('value');\n                        Wptm.style.table.style_repeated = this.find(\"#style_repeated\").data('value');\n                        Wptm.style.table.table_height = popup.option.table_height;\n                        Wptm.style.table.table_breakpoint = popup.option.table_breakpoint;\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    },\n                    'inputAction': function (selector) {\n                        if (selector === 'responsive_type') {\n                            if (popup.option.responsive_type === 'scroll') {\n                                this.find('.hiding').hide();\n                                this.find('.repeatedHeader').hide();\n                                this.find('.scrolling').show();\n                            }\n\n                            if (popup.option.responsive_type === 'repeatedHeader') {\n                                this.find('.hiding').hide();\n                                this.find('.scrolling').hide();\n                                this.find('.repeatedHeader').show();\n                                $(Wptm.container).handsontable('updateSettings', {\n                                    manualColumnFreeze: false,\n                                    fixedColumnsLeft: 0\n                                });\n                            }\n\n                            if (popup.option.responsive_type === 'hideCols') {\n                                this.find('.hiding').show();\n                                this.find('.scrolling').hide();\n                                this.find('.repeatedHeader').hide();\n\n                                tableFunction.responsive_col.call(this.find('#responsive_col'), Wptm);\n                            }\n                        }\n\n                        //scrolling\n                        if (selector === 'freeze_col') {\n                            if (parseInt(popup.option.freeze_col) === 0) {\n                                $(Wptm.container).handsontable('updateSettings', {\n                                    manualColumnFreeze: false,\n                                    fixedColumnsLeft: 0\n                                });\n                            } else {\n                                $(Wptm.container).handsontable('updateSettings', {\n                                    manualColumnFreeze: true,\n                                    fixedColumnsLeft: popup.option.freeze_col\n                                });\n                            }\n                        }\n\n                        for (var i = 0; i < _.size(Wptm.style.cols); i++) {\n                            if (typeof Wptm.style.cols[i] !== 'undefined' && Wptm.style.cols[i] !== null) {\n                                var col_priority = typeof Wptm.style.cols[i][1].res_priority !== 'undefined' ? Wptm.style.cols[i][1].res_priority : 0;\n                                if (typeof col_priority !== 'undefined') {\n                                    var curr_col = wptm_element.wptm_popup.find('table tbody tr').eq(i);\n                                    curr_col.find('.responsive_priority').text(col_priority).data('value', col_priority);\n                                }\n                            }\n                        }\n                        $('.responsive_priority').unbind('change').on('change', (e) => {\n                            var col = $(e.target).closest('tr').data('col');\n\n                            if (typeof Wptm.style.cols[col] !== 'undefined' && Wptm.style.cols[col] !== null && $(e.target).val() !== Wptm.style.cols[col].res_priority) {\n                                check_saving = true;\n                            }\n                            Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {res_priority: $(e.target).data('value')}, col);\n                        });\n                    },\n                    'cancelAction': function () {\n                        for (var key in popup.option) {\n                            if (popup.option[key] !== Wptm.style.table[key]) {\n                                check_saving = false;\n                                break;\n                            }\n                        }\n                        if (check_saving) {\n                            Wptm.style.table = $.extend({}, Wptm.style.table, popup.option), tableFunction.saveChanges();\n                        }\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'pagination_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#pagination_table'),\n                    'showAction': function () {\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'enable_pagination', this.find('#enable_pagination'), '0');\n\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'limit_rows', this.find('#limit_rows').next('.wptm_select_box'), 0);\n                        custom_select_box.call(this.find('#limit_rows'), $);\n\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.limit_rows = this.find('#limit_rows').data('value');\n                        Wptm.style.table.enable_pagination = this.find(\"#enable_pagination\").is(\":checked\") ? 1 : 0;\n                        if (Wptm.style.table.enable_pagination == 1) {\n                            wptm_element.primary_toolbars.find('.pagination_menu').parent().addClass('selected');\n                        } else {\n                            wptm_element.primary_toolbars.find('.pagination_menu').parent().removeClass('selected');\n                        }\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'date_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#date_menu'),\n                    'inputEnter': true,\n                    'render': true,\n                    'showAction': function () {\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'date_formats', this.find('#date_format'), '');\n\n                        this.find('.select_date_format li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var date_format = $(e.currentTarget).addClass('active').data('value');\n                            if (typeof date_format !== 'undefined' && date_format !== '') {\n                                this.find('#date_format').val(date_format);\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (this.find('#date_format').val() !== '') {\n                            Wptm.style.table.date_formats = this.find('#date_format').val();\n                            function_data.date_formats_momentjs = tableFunction.momentjsFormat(Wptm.style.table.date_formats);\n                        }\n\n                        function_data = tableFunction.createRegExpFormat(function_data, false, Wptm.style.table.date_formats);\n                        table_function_data.needSaveAfterRender = true;\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'date_menu_cell':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#date_menu_cell'),\n                    'inputEnter': true,\n                    'render': true,\n                    'showAction': function () {\n                        this.find('#popup_done').val('Apply');\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'date_formats', this.find('#date_format'), '');\n\n                        this.find('.select_date_format li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var date_format = $(e.currentTarget).addClass('active').data('value');\n                            if (typeof date_format !== 'undefined' && date_format !== '') {\n                                this.find('.date_formats').val(date_format);\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (typeof this.find('.date_formats').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {\n                                date_formats: this.find('.date_formats').val(),\n                                date_formats_momentjs: tableFunction.momentjsFormat(this.find('.date_formats').val())\n                            });\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'lock_ranger_cells':\n                if (wptm_administrator !== 1) {\n                    break;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#lock_ranger_cells'),\n                    'inputEnter': true,\n                    'render': true,\n                    'current_rangers': null,\n                    'current_rangers_user': null,\n                    'showAction': function () {\n                        var current_rangers_user_defalt = this.find('.wptm_select_box').find('li:first').data('value');\n                        custom_select_box.call(this.find('#jform_role_can_edit_lock'), $, null, true);\n                        tableFunction.updateParamFromStyleObjectSelectBox(\n                            '', 0,\n                            this.find('#jform_role_can_edit_lock').next('.wptm_select_box'), current_rangers_user_defalt\n                            , null, true);\n\n                        // wptm_element.wptm_popup.find('.content .control-group:first').after(window.wptm_element.content_popup_hide.find('#select_cells').clone());\n                        var function_data = window.table_function_data;\n                        if (typeof function_data.selection !== 'undefined' && function_data.selection[0] !== undefined && _.size(function_data.selection[0]) > 0) {\n                            var selection = function_data.selection[0];\n                            if (selection[0] == 0 && selection[2] == Wptm.max_row - 1) {\n                                tableFunction.getSelectedVal([false, selection[1], false, selection[3]], this.find('.cellRangeLabelAlternate'));\n                            } else {\n                                if (selection[1] == 0 && selection[3] == Wptm.max_Col - 1) {\n                                    tableFunction.getSelectedVal([selection[0], false, selection[2], false], this.find('.cellRangeLabelAlternate'));\n                                } else {\n                                    tableFunction.getSelectedVal(selection, this.find('.cellRangeLabelAlternate'));\n                                }\n                            }\n                        }\n\n                        this.find('#get_select_cells').val(wptmText.Save_range);\n\n                        var current_ranger = null;\n                        if (typeof Wptm.style.table.lock_ranger_cells !== 'undefined') {\n                            $.each(Wptm.style.table.lock_ranger_cells, (i, v) => {\n                                if (v !== '') {\n                                    var $lock_ranger_cell = this.find('.select_lock_ranger_cells').find('.wptm_hiden').clone();\n                                    $lock_ranger_cell.removeClass('wptm_hiden');\n                                    $lock_ranger_cell.attr('data-value', v).find('.label_text').text(v);\n                                    this.find('.select_lock_ranger_cells').append($lock_ranger_cell);\n                                }\n                            });\n                        } else {\n                            Wptm.style.table.lock_ranger_cells = [];\n                        }\n                        if (typeof Wptm.style.table.lock_ranger_cells_user == 'undefined') {\n                            Wptm.style.table.lock_ranger_cells_user = [];\n                        }\n                        popup.current_rangers = jquery.extend([], Wptm.style.table.lock_ranger_cells);\n                        popup.current_rangers_user = jquery.extend([], Wptm.style.table.lock_ranger_cells_user);\n\n                        this.find('.cellRangeLabelAlternate').unbind('keyup').on('click', function (e) {\n                            e.preventDefault();\n                            return false;\n                        });\n                        var select_ranger = () => {\n                            //select\n                            this.find('.select_lock_ranger_cells').find('.nfd-format-pill:not(.wptm_hiden)').unbind('click').on('click', (e) => {\n                                if (!$(e.target).hasClass('delete_range')) {\n                                    $(e.currentTarget).siblings('.nfd-format-pill.active').removeClass('active');\n                                    current_ranger = popup.current_rangers.indexOf($(e.currentTarget).find('.label_text').text());\n                                    this.find('.cellRangeLabelAlternate').val(popup.current_rangers[current_ranger]);\n                                    alternating.affterRangeLabe.call(this, window.Wptm, window.jquery);\n                                    $(e.currentTarget).addClass('active');\n                                    // jform_role_can_edit_lock\n                                    tableFunction.updateParamFromStyleObjectSelectBox(popup.current_rangers_user, current_ranger, this.find('#jform_role_can_edit_lock').next('.wptm_select_box'), current_rangers_user_defalt, null, true);\n\n                                    // this.find('#popup_done').addClass('not_active');\n                                }\n                            });\n\n                            //delete\n                            this.find('.select_lock_ranger_cells').find('.nfd-format-pill:not(.wptm_hiden) .delete_range').unbind('click').on('click', (e) => {\n                                e.preventDefault();\n                                current_ranger = popup.current_rangers.indexOf(this.find('.cellRangeLabelAlternate').val());\n                                var $li = $(e.currentTarget).parents('.nfd-format-pill');\n\n                                if ($li.hasClass('active')) {\n                                    $li.removeClass('active');\n                                    this.find('.cellRangeLabelAlternate').val('');\n                                }\n                                popup.current_rangers.splice(current_ranger, 1);\n                                popup.current_rangers_user.splice(current_ranger, 1);\n                                $li.remove();\n                                tableFunction.updateParamFromStyleObjectSelectBox('', current_ranger, this.find('#jform_role_can_edit_lock').next('.wptm_select_box'), current_rangers_user_defalt, null, true);\n\n                                // this.find('#popup_done').removeClass('not_active');\n                            });\n                        }\n\n                        //apply\n                        this.find('#get_select_cells').unbind('click').on('click', () => {\n                            alternating.affterRangeLabe.call(this, window.Wptm, window.jquery);\n                            var ranger = this.find('.cellRangeLabelAlternate').val();\n                            if (ranger !== '') {\n                                var value = ranger.replace(/[ ]+/g, \"\").toUpperCase();\n                                var arrayRange = value.split(\":\");\n                                if (arrayRange.length < 2) {\n                                    ranger += ':' + ranger;\n                                } else if (arrayRange.length > 2) {\n                                    return false;\n                                }\n                                var data_role_can_edit_lock = this.find('#jform_role_can_edit_lock').data('value');\n                                if (current_ranger == null) {//new\n                                    this.find('.nfd-format-pill.active').removeClass('active');\n                                    var $lock_ranger_cell1 = this.find('.select_lock_ranger_cells').find('.wptm_hiden').clone();\n                                    $lock_ranger_cell1.removeClass('wptm_hiden').addClass('active');\n                                    $lock_ranger_cell1.attr('data-value', ranger).find('.label_text').text(ranger);\n                                    this.find('.select_lock_ranger_cells').append($lock_ranger_cell1);\n                                    popup.current_rangers.push(ranger.toUpperCase());\n                                    popup.current_rangers_user.push(data_role_can_edit_lock === '' ? 'ADMINISTRATOR' : data_role_can_edit_lock);\n                                } else {\n                                    this.find('.select_lock_ranger_cells').find('.nfd-format-pill.active').attr('data-value', ranger).find('.label_text').text(ranger);\n                                    popup.current_rangers[current_ranger] = ranger.toUpperCase();\n                                    popup.current_rangers_user[current_ranger] = data_role_can_edit_lock === '' ? 'ADMINISTRATOR' : data_role_can_edit_lock;\n                                }\n                            }\n                            // this.find('#popup_done').removeClass('not_active');\n\n                            this.find('.cellRangeLabelAlternate').val('');\n                            this.find('.nfd-format-pill.active').removeClass('active');\n                            current_ranger = null;\n                            select_ranger();\n                        });\n\n                        select_ranger();\n\n                        return true;\n                    },\n                    'submitAction': function () {\n                        this.find('#get_select_cells').trigger('click');\n                        setTimeout(() => {\n                            var duplicate = tableFunction.check_duplicate_ranger(popup.current_rangers);\n                            if (duplicate.length > 0) {\n                                [popup.current_rangers, popup.current_rangers_user] = tableFunction.merger_duplicate_ranger_user(duplicate, popup.current_rangers, popup.current_rangers_user);\n                            }\n                            setTimeout(() => {\n                                Wptm.style.table.lock_ranger_cells = jquery.extend([], popup.current_rangers);\n                                Wptm.style.table.lock_ranger_cells_user = jquery.extend([], popup.current_rangers_user);\n                                this.siblings('.colose_popup').trigger('click');\n                                tableFunction.saveChanges(true);\n                            }, 200);\n                        }, 200);\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        var duplicate = tableFunction.check_duplicate_ranger(popup.current_rangers);\n                        if (duplicate.length > 0) {\n                            [popup.current_rangers, popup.current_rangers_user] = tableFunction.merger_duplicate_ranger_user(duplicate, popup.current_rangers, popup.current_rangers_user);\n                        }\n                        setTimeout(() => {\n                            Wptm.style.table.lock_ranger_cells = jquery.extend([], popup.current_rangers);\n                            Wptm.style.table.lock_ranger_cells_user = jquery.extend([], popup.current_rangers_user);\n                            tableFunction.saveChanges(true);\n                        }, 200);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, false);\n                break;\n            case 'curency_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#curency_menu'),\n                    'render': true,\n                    'inputEnter': true,\n                    'selector': {\n                        'symbol_position': '#symbol_position'\n                    },\n                    'option': {\n                        'symbol_position': Wptm.style.table.symbol_position\n                    },\n                    'showAction': function () {\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'currency_symbol', this.find('#currency_symbol'), '');\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'symbol_position', this.find('#symbol_position').next('.wptm_select_box'), '');\n                        custom_select_box.call(this.find('#symbol_position'), $);\n\n                        this.find('.select_curency_menu li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var currency_symbol = $(e.currentTarget).addClass('active').data('currency_sym');\n                            if (typeof currency_symbol !== 'undefined' && currency_symbol !== '') {\n                                this.find('#currency_symbol').val(currency_symbol);\n                            }\n\n                            var symbol_position = $(e.currentTarget).data('symbol_position');\n                            if (typeof symbol_position !== 'undefined' && symbol_position !== '') {\n                                this.find('#symbol_position').data('value', symbol_position).text(symbol_position == 1 ? 'After' : 'Before').change();\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (this.find('#currency_symbol').val() !== '') {\n                            Wptm.style.table.currency_symbol = this.find('#currency_symbol').val();\n                        }\n                        function_data = tableFunction.createRegExpFormat(function_data, Wptm.style.table.currency_symbol, false);\n\n                        Wptm.style.table = $.extend({}, Wptm.style.table, popup.option);\n                        table_function_data.needSaveAfterRender = true;\n                        tableFunction.setFormat_accounting();\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'curency_menu_cell':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#curency_menu_cell'),\n                    'render': true,\n                    'inputEnter': true,\n                    'showAction': function () {\n                        this.find('#popup_done').val('Apply');\n                        custom_select_box.call(this.find('.symbol_position'), $);\n\n                        this.find('.select_curency_menu li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var currency_symbol = $(e.currentTarget).addClass('active').data('currency_sym');\n                            if (typeof currency_symbol !== 'undefined' && currency_symbol !== '' && currency_symbol !== false) {\n                                this.find('.currency_symbol').val(currency_symbol);\n                            }\n\n                            var symbol_position = $(e.currentTarget).data('symbol_position');\n                            if (typeof symbol_position !== 'undefined' && symbol_position !== '' && symbol_position !== false) {\n                                this.find('.symbol_position').data('value', symbol_position).text(symbol_position == 1 ? 'After' : 'Before').change();\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (typeof this.find('.currency_symbol').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {\n                                currency_symbol: this.find('.currency_symbol').val(),\n                                currency_symbol_second: null\n                            });\n                        }\n\n                        if (typeof this.find('.symbol_position').data('value') !== 'undefined' && this.find('.symbol_position').data('value') !== '') {\n                            tableFunction.getFillArray(selection, Wptm, {\n                                symbol_position: this.find('.symbol_position').data('value'),\n                                symbol_position_second: null\n                            });\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'decimal_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#decimal_menu'),\n                    'render': true,\n                    'inputEnter': true,\n                    'showAction': function () {\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'thousand_symbol', this.find('#thousand_symbol'), '');\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'decimal_symbol', this.find('#decimal_symbol'), '');\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'decimal_count', this.find('#decimal_count'), '');\n                        this.find('.select_decimal_menu li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var thousand_symbol = $(e.currentTarget).addClass('active').data('thousand_symbol');\n                            if (typeof thousand_symbol !== 'undefined') {\n                                this.find('#thousand_symbol').val(thousand_symbol).change();\n                            }\n\n                            var decimal_symbol = $(e.currentTarget).data('decimal_symbol');\n                            if (typeof decimal_symbol !== 'undefined') {\n                                this.find('#decimal_symbol').val(decimal_symbol).change();\n                            }\n\n                            var decimal_count = $(e.currentTarget).data('decimal_count');\n                            if (typeof decimal_count !== 'undefined' && decimal_count !== '') {\n                                this.find('#decimal_count').val(decimal_count).change();\n                            } else {\n                                this.find('#decimal_count').val(0).change();\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (typeof this.find('#decimal_symbol').val() !== 'undefined') {\n                            Wptm.style.table.decimal_symbol = this.find('#decimal_symbol').val();\n                        }\n                        if (typeof this.find('#decimal_count').val() !== 'undefined') {\n                            Wptm.style.table.decimal_count = this.find('#decimal_count').val() == '' ? 0 : this.find('#decimal_count').val();\n                        }\n                        if (typeof this.find('#thousand_symbol').val() !== 'undefined') {\n                            Wptm.style.table.thousand_symbol = this.find('#thousand_symbol').val();\n                        }\n                        table_function_data.needSaveAfterRender = true;\n                        tableFunction.setFormat_accounting();\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'decimal_menu_cell':\n                if (Wptm.type === 'mysql') {\n                    return true;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#decimal_menu_cell'),\n                    'render': true,\n                    'inputEnter': true,\n                    'showAction': function () {\n                        this.find('#popup_done').val('Apply');\n                        this.find('.select_decimal_menu li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var thousand_symbol = $(e.currentTarget).addClass('active').data('thousand_symbol');\n                            if (typeof thousand_symbol !== 'undefined' && thousand_symbol !== false) {\n                                this.find('.thousand_symbol').val(thousand_symbol).change();\n                            }\n\n                            var decimal_symbol = $(e.currentTarget).data('decimal_symbol');\n                            if (typeof decimal_symbol !== 'undefined' && decimal_symbol !== false) {\n                                this.find('.decimal_symbol').val(decimal_symbol).change();\n                            }\n\n                            var decimal_count = $(e.currentTarget).data('decimal_count');\n                            if (typeof decimal_count !== 'undefined' && decimal_count !== '' && decimal_count !== false) {\n                                this.find('.decimal_count').val(decimal_count).change();\n                            } else {\n                                this.find('.decimal_count').val(0).change();\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (typeof this.find('.decimal_symbol').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {\n                                decimal_symbol: this.find('.decimal_symbol').val(),\n                                decimal_symbol_second: null\n                            });\n                        }\n                        if (typeof this.find('.decimal_count').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {\n                                decimal_count: this.find('.decimal_count').val() == '' ? 0 : this.find('.decimal_count').val(),\n                                decimal_count_second: null\n                            });\n                        }\n                        if (typeof this.find('.thousand_symbol').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {\n                                thousand_symbol: this.find('.thousand_symbol').val(),\n                                thousand_symbol_second: null\n                            });\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'google_sheets_menu':\n                if (Wptm.type == 'mysql') {\n                    return false;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#google_sheets_menu'),\n                    'show_google_url': function (text_url, $done) {\n                        if (text_url !== '') {\n                            $done.show();\n\n                            if (this.find('#auto_push').is(\":checked\")) {\n                                this.find('#google_url').parent().show();\n                            } else {\n                                this.find('#google_url').parent().hide();\n                            }\n                        } else {\n                            $done.hide();\n                        }\n\n                        if (typeof Wptm.syn_hash !== 'undefined' && Wptm.syn_hash !== '') {\n                            this.find('#google_url').val(Wptm.syn_hash);\n                        } else {\n                            this.find('#google_url').val('' + Wptm.id + tableFunction.hashFnv32a());\n                        }\n\n                        var text = 'function send' + Wptm.id + 'sheetspush() {\\n var response = UrlFetchApp.fetch(\"'\n                            + wptm_ajaxurl_site + 'task=sitecontrol.scriptGoogle&id_table=' + Wptm.id + '&wptmhash=' + this.find('#google_url').val() + '\");\\n}';\n                        this.find('.wptm_copy_text_content').text(text);\n\n                        this.find('#google_url').siblings('.copy_text').unbind('click').on('click', (e) => {\n                            tableFunction.copy_text($(e.target), this.find('.wptm_copy_text_content').val());\n                            this.find('.wptm_copied').show().animate({opacity: '1'}, \"slow\").delay(1000).animate({'opacity': '0'}, 10);\n                        });\n                    },\n                    'showAction': function () {\n                        // this.find('#google_sheets_menu .control-group.select_sheet').hide();\n                        this.find('#fetch_browse').hide();\n                        this.find('#jform_excel_url-lbl').hide();\n                        this.find('#import_style').parent().hide();\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'auto_sync', this.find('#auto_sync'), '0');\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'spreadsheet_style', this.find('#spreadsheet_style'), '0');\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'auto_push', this.find('#auto_push'), '0');\n\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'spreadsheet_url', this.find('#spreadsheet_url'), '');\n                        check_saving = 0;\n\n                        custom_select_box.call(this.find('#select_sheet'), $);\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'select_sheet_google', this.find('#select_sheet').next('.wptm_select_box'), 1);\n\n                        popup.show_google_url.call(this, Wptm.style.table.spreadsheet_url, this.find('#google_url').closest('.control-group'));\n                        this.find('#spreadsheet_url').on('keyup', (e) => {\n                            popup.show_google_url.call(this, $(e.currentTarget).val(), this.find('#google_url').closest('.control-group'));\n                        });\n\n                        this.find('#auto_push').on('change', (e) => {\n                            popup.show_google_url.call(this, this.find('#spreadsheet_url').val(), this.find('#google_url').parent());\n                        });\n\n                        this.find('#fetch_google').unbind('click').on('click', (e) => {\n                            Wptm.style.table.spreadsheet_url = this.find(\"#spreadsheet_url\").val();\n                            if (Wptm.style.table.spreadsheet_url === '' || Wptm.style.table.spreadsheet_url === undefined) {\n                                return false;\n                            }\n                            Wptm.style.table.select_sheet_google = this.find('#select_sheet').data('value') || 1;\n\n                            Wptm.style.table.spreadsheet_style = this.find(\"#spreadsheet_style\").is(\":checked\") ? 1 : 0;\n                            Wptm.style.table.auto_sync = this.find(\"#auto_sync\").is(\":checked\") ? 1 : 0;\n                            if (Wptm.style.table.auto_sync === 1) {\n                                Wptm.style.table.excel_auto_sync = 0;\n                            }\n\n                            Wptm.style.table.auto_push = this.find(\"#auto_push\").is(\":checked\") ? 1 : 0;\n\n                            var data = {'type': 'spreadsheet'};\n                            table_function_data.fetch_data = data;\n\n                            if (this.find('#google_url').val() !== '') {\n                                Wptm.syn_hash = this.find('#google_url').val();\n                            } else {\n                                Wptm.syn_hash = '' + Wptm.id + tableFunction.hashFnv32a();\n                            }\n\n                            tableFunction.saveChanges(true);\n                            return true;\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.spreadsheet_url = this.find(\"#spreadsheet_url\").val();\n                        Wptm.style.table.select_sheet_google = this.find('#select_sheet').data('value') || 1;\n\n                        Wptm.style.table.spreadsheet_style = this.find(\"#spreadsheet_style\").is(\":checked\") ? 1 : 0;\n\n                        Wptm.style.table.auto_sync = this.find(\"#auto_sync\").is(\":checked\") ? 1 : 0;\n                        if (Wptm.style.table.auto_sync === 1) {\n                            Wptm.style.table.excel_auto_sync = 0;\n                        }\n\n                        Wptm.style.table.auto_push = this.find(\"#auto_push\").is(\":checked\") ? 1 : 0;\n\n                        check_saving = 1;\n\n                        if (this.find('#google_url').val() !== '') {\n                            Wptm.syn_hash = this.find('#google_url').val();\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        if (check_saving === 1) {\n                            tableFunction.saveChanges(true);\n                        }\n                        return true;\n                    },\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'onedrive_menu':\n                if (Wptm.type == 'mysql') {\n                    return false;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#onedrive_menu'),\n                    'showAction': function () {\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'onedrive_style', this.find('#onedrive_style'), '0');\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'auto_sync_onedrive', this.find('#auto_sync_onedrive'), '0');\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'onedrive_url', this.find('#onedrive_url'), '');\n                        check_saving = 0;\n\n                        custom_select_box.call(this.find('#select_sheet'), $);\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'select_sheet_one', this.find('#select_sheet').next('.wptm_select_box'), 1);\n\n                        this.find('#fetch_google').unbind('click').on('click', (e) => {\n                            Wptm.style.table.onedrive_url = this.find(\"#onedrive_url\").val();\n                            Wptm.style.table.select_sheet_one = this.find('#select_sheet').data('value') || 1;\n                            var dataSync = tableFunction.getLinkSync(Wptm.style.table.onedrive_url, 'onedrive', true);\n                            Wptm.style.table.onedrive_url = dataSync.url;\n\n                            if (!dataSync) {\n                                return false;\n                            }\n\n                            Wptm.style.table.onedrive_style = this.find(\"#onedrive_style\").is(\":checked\") ? 1 : 0;\n                            Wptm.style.table.auto_sync_onedrive = this.find(\"#auto_sync_onedrive\").is(\":checked\") ? 1 : 0;\n\n                            var data = {'type': 'onedrive'};\n                            table_function_data.fetch_data = data;\n\n                            tableFunction.saveChanges(true);\n                            return true;\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.onedrive_url = this.find(\"#onedrive_url\").val();\n                        Wptm.style.table.onedrive_style = this.find(\"#onedrive_style\").is(\":checked\") ? 1 : 0;\n                        Wptm.style.table.auto_sync_onedrive = this.find(\"#auto_sync_onedrive\").is(\":checked\") ? 1 : 0;\n                        Wptm.style.table.select_sheet_one = this.find('#select_sheet').data('value') || 1;\n\n                        check_saving = 1;\n\n                        this.siblings('.colose_popup').trigger('click');\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        if (check_saving === 1) {\n                            var dataSync = tableFunction.getLinkSync(Wptm.style.table.onedrive_url, 'onedrive', false);\n                            Wptm.style.table.onedrive_url = dataSync.url;\n\n                            tableFunction.saveChanges(true);\n                        }\n                        return true;\n                    },\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'synchronization_menu':\n                if (Wptm.type == 'mysql') {\n                    return false;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#google_sheets_menu'),\n                    'inputEnter': true,\n                    'showAction': function () {\n                        this.css({'min-width': 400});\n                        this.find('#google_url').parent().hide();\n                        this.find('#jform_spreadsheet_url-lbl').hide();\n                        this.find(\"#auto_push\").closest('.push-notification-group').hide();\n                        if (typeof default_value.enable_import_excel !== 'undefined'\n                            && default_value.enable_import_excel == '1') {\n                            this.prepend(wptm_element.content_popup_hide.find('#import_excel').clone());\n                            this.find('#google_sheets_menu').addClass('excel_syn');\n                        }\n\n                        custom_select_box.call(this.find('#select_sheet'), $);\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'select_sheet', this.find('#select_sheet').next('.wptm_select_box'), 1);\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'excel_auto_sync', this.find('#auto_sync'), '0');\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'excel_spreadsheet_style', this.find('#spreadsheet_style'), '0');\n\n                        custom_select_box.call(this.find('#select_sheet_import'), $);\n                        custom_select_box.call(this.find('#import_style'), $);\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'excel_url', this.find('#spreadsheet_url'), '');\n                        check_saving = 0;\n\n                        this.find('#fetch_google').unbind('click').on('click', (e) => {\n                            Wptm.style.table.excel_url = this.find(\"#spreadsheet_url\").val();\n                            if (Wptm.style.table.excel_url === '' || Wptm.style.table.excel_url === undefined) {\n                                return false;\n                            }\n                            $('.prevent_event_popup').show();\n\n                            Wptm.style.table.select_sheet = this.find('#select_sheet').data('value') || 1;\n                            Wptm.style.table.excel_spreadsheet_style = this.find(\"#spreadsheet_style\").is(\":checked\") ? 1 : 0;\n                            Wptm.style.table.excel_auto_sync = this.find(\"#auto_sync\").is(\":checked\") ? 1 : 0;\n                            if (Wptm.style.table.excel_auto_sync === 1) {\n                                Wptm.style.table.auto_sync = 0;\n                            }\n\n                            var data = {'type': 'excel'};\n                            table_function_data.fetch_data = data;\n\n                            tableFunction.saveChanges(true);\n                            return true;\n                        });\n\n                        wptmPreview.importExcel(jquery, this)\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.excel_auto_sync = this.find(\"#auto_sync\").is(\":checked\") ? 1 : 0;\n                        if (Wptm.style.table.excel_auto_sync === 1) {\n                            Wptm.style.table.auto_sync = 0;\n                        }\n                        Wptm.style.table.select_sheet = this.find('#select_sheet').data('value');\n                        Wptm.style.table.excel_spreadsheet_style = this.find(\"#spreadsheet_style\").is(\":checked\") ? 1 : 0;\n\n                        Wptm.style.table.excel_url = this.find(\"#spreadsheet_url\").val();\n\n                        check_saving = 1;\n                        this.siblings('.colose_popup').trigger('click');\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        // this.find('#import_excel').appendTo(wptm_element.content_popup_hide);\n                        // jquery(\".loading-page\").removeClass('show')\n                        if (check_saving === 1) {\n                            tableFunction.saveChanges(true);\n                        }\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'csv_menu':\n                if (Wptm.type == 'mysql') {\n                    return false;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#csv_menu'),\n                    'inputEnter': true,\n                    'showAction': function () {\n                        this.css({'min-width': 400});\n                        check_saving = 0;\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'csv_url', this.find('#csv_url'), '', () => {\n                            this.find('#csv_url').keyup(() => {\n                                this.find('#csv_url').css({'border-color': '#a7b5c3'});\n                                this.find('#csv_url').next().hide();\n                            })\n                        });\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'auto_sync_csv', this.find('#auto_sync_csv'), '0');\n                        //\n                        this.find('#fetch_csv').unbind('click').on('click', (e) => {\n                            Wptm.style.table.csv_url = this.find(\"#csv_url\").val();\n                            if (Wptm.style.table.csv_url === '' || Wptm.style.table.csv_url === undefined) {\n                                this.find('#csv_url').css({'border-color': 'red'});\n                                this.find('#csv_url').next().show();\n                                return false;\n                            }\n                            $('.prevent_event_popup').show();\n\n                            Wptm.style.table.auto_sync_csv = this.find(\"#auto_sync_csv\").is(\":checked\") ? 1 : 0;\n\n                            var data = {'type': 'csv'};\n                            table_function_data.fetch_data = data;\n\n                            tableFunction.saveChanges(true);\n                            return true;\n                        });\n\n                        wptmPreview.importExcel(jquery, this)\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.auto_sync_csv = this.find(\"#auto_sync_csv\").is(\":checked\") ? 1 : 0;\n\n                        Wptm.style.table.csv_url = this.find(\"#csv_url\").val();\n\n                        check_saving = 1;\n                        this.siblings('.colose_popup').trigger('click');\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        if (check_saving === 1) {\n                            tableFunction.saveChanges(true);\n                        }\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'new_chart_menu':\n                DropChart.functions.addChart();\n                break;\n            case 'view_chart_menu':\n                if (Wptm.dataChart.length > 0) {\n                    wptm_element.settingTable.find('.ajax_loading').addClass('loadding').removeClass('wptm_hiden');\n                    $(this).closest('li').addClass('menu_loading');\n                    tableFunction.showChartOrTable(true, jquery('#list_chart').find('.chart-menu').eq(0));\n                } else {\n                    tableFunction.wptmBootbox('', wptmText.CHART_NOT_EXIST, wptmText.GOT_IT, false);\n                }\n                break;\n            case 'editToolTip':\n                var content = $('#tooltip_content').val();\n\n                if (content !== '') {\n                    wptm_element.tableContainer.find('tbody td.current').addClass('isTooltipContent');\n                } else {\n                    wptm_element.tableContainer.find('tbody td.current').removeClass('isTooltipContent');\n                }\n\n                if (typeof content !== 'undefined') {\n                    var i, j;\n                    var selection = table_function_data.selection[0];\n                    var width = $('#tooltip_width').val();\n                    for (i = selection[0]; i <= selection[2]; i++) {\n                        for (j = selection[1]; j <= selection[3]; j++) {\n                            if (width !== '') {\n                                Wptm.style.cells = tableFunction.fillArray(Wptm.style.cells, {\n                                    tooltip_content: content,\n                                    tooltip_width: width\n                                }, i, j);\n                            } else {\n                                Wptm.style.cells = tableFunction.fillArray(Wptm.style.cells, {tooltip_content: content}, i, j);\n                            }\n                            if (i == selection[2] && j == selection[3]) {\n                                saveData.push({\n                                    action: 'style', selection: table_function_data.selection, style: {\n                                        tooltip_content: content,\n                                        tooltip_width: width\n                                    }\n                                });\n                                tableFunction.saveChanges();\n                            }\n                        }\n                    }\n                }\n                break;\n        }\n        return false;\n    });\n\n    //select option in sub-menu(first top menu)\n    wptm_element.primary_toolbars.find('.has_sub_menu ul li').on('change click', function () {\n        if (!(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n            return false;\n        }\n\n        var function_data = window.table_function_data;\n        var Wptm = window.Wptm;\n        var $ = window.jquery;\n        var option_name = $(this).parents('.sub-menu').siblings('.table_option');\n        switch (option_name.attr('name')) {\n            case 'align_menu':\n                Wptm.style.table.table_align = $(this).attr('name').toString();\n                $(this).siblings('.selected').removeClass('selected');\n                $(this).addClass('selected');\n                tableFunction.saveChanges(true);\n                break;\n        }\n        return true;\n    });\n\n    wptm_element.primary_toolbars.find('a.cell_option').unbind('click').on('click', function (e) {\n        e.preventDefault();\n        render = second_menu.call(this, render);\n        clearTimeout(autoRender);\n\n        autoRender = setTimeout(function () {\n            if (render === true) {\n                table_function_data.needSaveAfterRender = true;\n                window.jquery(window.Wptm.container).data('handsontable').render();\n            }\n\n            render = false;\n        }, 200);\n    });\n\n    wptm_element.primary_toolbars.find('.cell_option').unbind('change').on('change', function (e) {\n        e.preventDefault();\n\n        render = second_menu.call(this, render);\n        if (render !== 'input_not_negative') {\n            clearTimeout(autoRender);\n\n            autoRender = setTimeout(function () {\n                if (render === true) {\n                    table_function_data.needSaveAfterRender = true;\n                    window.jquery(window.Wptm.container).data('handsontable').render();\n                }\n                render = false;\n            }, 200);\n        }\n\n    });\n\n    //select calculator function\n    wptm_element.primary_toolbars.find('.calculater_function').unbind('click').on('click', function (e) {\n        e.preventDefault();\n        if (Wptm.type !== 'html') {\n            return;\n        }\n        var $ = window.jquery;\n\n        var selection = $.extend({}, table_function_data.selection);\n        var calculater = $(this).data('calculater');\n\n        tableFunction.change_value_cells(selection, '=' + calculater + '()');\n        var CellValue = document.getElementById('CellValue');\n\n        wptm_element.cellValue.focus().val('=' + calculater + '()');\n\n        if (CellValue) {\n            if (typeof CellValue.setSelectionRange === 'function') {\n                let x = calculater.length + 2;\n                CellValue.setSelectionRange(x, x);\n            }\n            wptm_element.cellValue.click();\n        }\n    });\n\n    //change value cells by #CellValue\n    wptm_element.cellValue.on('keyup', function (e) {\n        if (typeof Wptm.style.table.lock_ranger_cells !== 'undefined' || typeof Wptm.style.table.lock_columns !== 'undefined') {\n            let readOnly = false;\n            tableFunction.eventToCellsSelected(table_function_data.selection, 1, (ranger, i) => {\n                for (let i2 = ranger[0]; i2 <= ranger[2]; i2++) {\n                    for (let j = ranger[1]; j <= ranger[3]; j++) {\n                        let cellProperties = tableFunction.check_cell_readOnly(i2, j, {})\n                        if (cellProperties.readOnly) {\n                            readOnly = true;\n                            break;\n                        }\n                    }\n                    if (readOnly)\n                        break;\n                }\n            }, null , null, null)\n\n            if (readOnly)\n                return false;\n        }\n\n        if (wptm_element.cellValue.val() !== table_function_data.cellValueChange) {\n            table_function_data.checkCellValueChange = table_function_data.selection;\n        } else {\n            table_function_data.checkCellValueChange = false;\n        }\n        if (e.keyCode === 13 && Wptm.type == 'html') {\n            tableFunction.change_value_cells(table_function_data.selection, wptm_element.cellValue.val(), null, () => {\n                var $ = window.jquery;\n                let selection = table_function_data.selection;\n                table_function_data.checkCellValueChange = false;\n\n                if (typeof selection[1] === 'undefined'\n                    && typeof selection[0][2] !== 'undefined'\n                    && selection[0][0] === selection[0][2]\n                    && selection[0][1] === selection[0][3]) {\n                    if (typeof Wptm.datas[selection[0][0] + 1] === 'undefined') {\n                        $(Wptm.container).handsontable(\"selectCell\", 0, selection[0][1] + 1, 0, selection[0][3] + 1);\n                    } else {\n                        $(Wptm.container).handsontable(\"selectCell\", selection[0][0] + 1, selection[0][1], selection[0][2] + 1, selection[0][3]);\n                    }\n                }\n            });\n        }\n        return true;\n    });\n};\n\n//event change value option in cell_menu\nfunction second_menu(render) {\n    if (!(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n        return false;\n    }\n\n    if (table_function_data.selectOption) {\n        return false;\n    }\n    var $ = window.jquery;\n\n    var $name = $(this).attr('name');\n    var min = typeof $(this).attr('min') !== 'undefined' ? $(this).attr('min') : null;\n    var max = typeof $(this).attr('max') !== 'undefined' ? $(this).attr('max') : null;\n\n    if (tableFunction.input_not_negative($(this).val(), $name, min, max)) {\n        return 'input_not_negative';\n    }\n\n    var re_active = typeof arguments[1] !== 'undefined' && arguments[1] === 're_active' ? true : false;\n\n    var Wptm = window.Wptm;\n    var value;\n    var parentLi = $(this).parents('.cells_option');\n    var i;\n    table_function_data.option_selected_mysql = '';\n\n    var selection = $.extend({}, table_function_data.selection);\n\n    if (Wptm.type === 'mysql') {\n        for (i = 0; i < table_function_data.selectionSize; i++) {\n            if ((selection[i][0] + selection[i][2]) !== 0) {//not cell in header\n                selection[i][0] = selection[i][0] > 0 ? 1 : selection[i][0];\n                selection[i][2] = _.size(Wptm.style.rows) - 1;\n                table_function_data.option_selected_mysql = jquery(this).attr('name');\n            }\n        }\n    }\n\n    if (typeof selection[0][1] === 'undefined') {\n        return;\n    }\n    var border_selection = {};\n    var border_selection2 = {};\n    var border_selection3 = {};\n    switch ($name) {\n        case 'undo_cell':\n            if ($(this).hasClass('active')) {\n                $(Wptm.container).handsontable('getInstance').undoRedo.undo()\n                render = true;\n            } else {\n                tableFunction.status_notic(1, wptmText.some_action_cant_be_done + '!', $('#undoNotic'));\n            }\n            break;\n        case 'redo_cell':\n            if ($(this).hasClass('active')) {\n                $(Wptm.container).handsontable('getInstance').undoRedo.redo()\n                render = true;\n            } else {\n                tableFunction.status_notic(1, wptmText.some_action_cant_be_done + '!', $('#undoNotic'));\n            }\n            break;\n        case 'cell_font_family':\n            tableFunction.getFillArray(selection, Wptm, {cell_font_family: $(this).data('value')});\n            render = true;\n            break;\n        case 'cell_font_size':\n            tableFunction.getFillArray(selection, Wptm, {cell_font_size: $(this).val()});\n            render = true;\n            break;\n        case 'cell_format_bold':\n            if (parentLi.find('.active').length < 1) {\n                value = true;\n                parentLi.find('.cell_option').addClass('active');\n            } else {\n                value = false;\n                parentLi.find('.active').removeClass('active');\n            }\n\n            tableFunction.getFillArray(selection, Wptm, {cell_font_bold: value});\n            render = true;\n            break;\n        case 'cell_font_underline':\n            if (parentLi.find('.active').length < 1) {\n                value = true;\n                parentLi.find('.cell_option').addClass('active');\n                parentLi.parent().find('.cell_format_strikethrough').removeClass('active');\n                tableFunction.getFillArray(selection, Wptm, {cell_format_strikethrough: false});\n            } else {\n                value = false;\n                parentLi.find('.active').removeClass('active');\n            }\n            tableFunction.getFillArray(selection, Wptm, {cell_font_underline: value});\n            render = true;\n            break;\n        case 'cell_format_strikethrough':\n            if (parentLi.find('.active').length < 1) {\n                value = true;\n                parentLi.find('.cell_option').addClass('active');\n                parentLi.parent().find('.cell_format_underlined').removeClass('active');\n                tableFunction.getFillArray(selection, Wptm, {cell_font_underline: false});\n            } else {\n                value = false;\n                parentLi.find('.active').removeClass('active');\n            }\n            tableFunction.getFillArray(selection, Wptm, {cell_format_strikethrough: value});\n            render = true;\n            break;\n        case 'cell_font_italic':\n            if (parentLi.find('.active').length < 1) {\n                value = true;\n                parentLi.find('.cell_option').addClass('active');\n            } else {\n                value = false;\n                parentLi.find('.active').removeClass('active');\n            }\n            tableFunction.getFillArray(selection, Wptm, {cell_font_italic: value});\n            render = true;\n            break;\n        case 'cell_background_color':\n            if ($(this).data('keyup') === 1) {\n                value = $(this).val();\n                tableFunction.getFillArray(selection, Wptm, {cell_background_color: value});\n                $(this).parents('.wp-picker-container').find('.wp-color-result').css('color', value);\n                $(this).data('keyup', 0).change();\n\n                render = true;\n            }\n            break;\n        case 'cell_font_color':\n            if ($(this).data('keyup') === 1) {\n                value = $(this).val();\n                tableFunction.getFillArray(selection, Wptm, {cell_font_color: value});\n                $(this).parents('.wp-picker-container').find('.wp-color-result').css('color', value);\n                $(this).data('keyup', 0).change();\n\n                render = true;\n            }\n            break;\n        case 'format_align_left':\n            wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_text_align: 'left'});\n            render = true;\n            break;\n        case 'format_align_center':\n            wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_text_align: 'center'});\n            render = true;\n            break;\n        case 'format_align_right':\n            wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_text_align: 'right'});\n            render = true;\n            break;\n        case 'format_align_justify':\n            wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').addClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_text_align: 'justify'});\n            render = true;\n            break;\n        case 'vertical_align_bottom':\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_bottom\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_middle\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_top\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_vertical_align: 'bottom'});\n            render = true;\n            break;\n        case 'vertical_align_middle':\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_bottom\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_middle\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_top\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_vertical_align: 'middle'});\n            render = true;\n            break;\n        case 'vertical_align_top':\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_bottom\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_middle\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_top\"]').addClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_vertical_align: 'top'});\n            render = true;\n            break;\n        case 'overflow_cell':\n            wptm_element.primary_toolbars.find('#wrap_cell').removeClass('active');\n            wptm_element.primary_toolbars.find('#clip_cell').removeClass('active');\n            if (wptm_element.primary_toolbars.find('#overflow_cell').hasClass('active')) {\n                wptm_element.primary_toolbars.find('#overflow_cell').removeClass('active');\n                tableFunction.getFillArray(selection, Wptm, {text_wrapping: false});\n            } else {\n                wptm_element.primary_toolbars.find('#overflow_cell').addClass('active');\n                tableFunction.getFillArray(selection, Wptm, {text_wrapping: \"normal\"});\n            }\n\n            render = true;\n            break;\n        case 'wrap_cell':\n            wptm_element.primary_toolbars.find('#overflow_cell').removeClass('active');\n            wptm_element.primary_toolbars.find('#clip_cell').removeClass('active');\n            if (wptm_element.primary_toolbars.find('#wrap_cell').hasClass('active')) {\n                wptm_element.primary_toolbars.find('#wrap_cell').removeClass('active');\n                tableFunction.getFillArray(selection, Wptm, {text_wrapping: false});\n            } else {\n                wptm_element.primary_toolbars.find('#wrap_cell').addClass('active');\n                tableFunction.getFillArray(selection, Wptm, {text_wrapping: \"break-word\"});\n            }\n            render = true;\n            break;\n        case 'clip_cell':\n            wptm_element.primary_toolbars.find('#overflow_cell').removeClass('active');\n            wptm_element.primary_toolbars.find('#wrap_cell').removeClass('active');\n            if (wptm_element.primary_toolbars.find('#clip_cell').hasClass('active')) {\n                wptm_element.primary_toolbars.find('#clip_cell').removeClass('active');\n                tableFunction.getFillArray(selection, Wptm, {text_wrapping: false});\n            } else {\n                wptm_element.primary_toolbars.find('#clip_cell').addClass('active');\n                tableFunction.getFillArray(selection, Wptm, {text_wrapping: \"hidden\"});\n            }\n            render = true;\n            break;\n        case 'padding_border':\n            var popup;\n            popup = {\n                'html': wptm_element.content_popup_hide.find('#padding_border'),\n                'showAction': function () {\n                    var size_selection = table_function_data.selectionSize - 1;\n                    var cellStyle = window.Wptm.style.cells[selection[size_selection][0] + '!' + selection[size_selection][1]][2];\n\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_padding_left', this.find('#jform_cell_padding_left'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_padding_top', this.find('#jform_cell_padding_top'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_padding_right', this.find('#jform_cell_padding_right'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_padding_bottom', this.find('#jform_cell_padding_bottom'), 0);\n\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_background_radius_left_top', this.find('#jform_cell_background_radius_left_top'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_background_radius_right_top', this.find('#jform_cell_background_radius_right_top'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_background_radius_right_bottom', this.find('#jform_cell_background_radius_right_bottom'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_background_radius_left_bottom', this.find('#jform_cell_background_radius_left_bottom'), 0);\n\n                    this.find('.observeChanges').unbind('change').on('change', (e) => {\n                        var name = $(e.currentTarget).attr('name');\n                        var value = $(e.currentTarget).val();\n                        switch (name) {\n                            case 'jform[jform_cell_padding_left]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_padding_left: value});\n                                break;\n                            case 'jform[jform_cell_padding_top]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_padding_top: value});\n                                break;\n                            case 'jform[jform_cell_padding_right]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_padding_right: value});\n                                break;\n                            case 'jform[jform_cell_padding_bottom]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_padding_bottom: value});\n                                break;\n                            case 'jform[jform_cell_background_radius_left_top]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_background_radius_left_top: value});\n                                break;\n                            case 'jform[jform_cell_background_radius_right_top]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_background_radius_right_top: value});\n                                break;\n                            case 'jform[jform_cell_background_radius_right_bottom]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_background_radius_right_bottom: value});\n                                break;\n                            case 'jform[jform_cell_background_radius_left_bottom]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_background_radius_left_bottom: value});\n                                break;\n                        }\n                    });\n                    return true;\n                },\n                'submitAction': function () {\n                    this.siblings('.colose_popup').trigger('click');\n                    tableFunction.saveChanges();\n                    return true;\n                },\n                'cancelAction': function () {\n                    window.jquery(window.Wptm.container).data('handsontable').render();\n                    return true;\n                }\n            };\n            wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n            break;\n        case 'cell_type':\n            if (Wptm.type !== 'mysql') {\n                if (parentLi.find('.active').length < 1) {\n                    tableFunction.getFillArray(selection, Wptm, {cell_type: 'html'}, \"set_cells_type\", false, function () {\n                        // add cell type == text for column selected\n                        var cols_selected = [];\n\n                        for (let jj = 0; jj < table_function_data.selectionSize; jj++) {\n                            for (let i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                cols_selected[i] = 'text';\n                                Wptm.style.table.col_types[i] = 'text';\n                            }\n                        }\n                        saveData.push({\n                            action: 'set_columns_types',\n                            value: cols_selected\n                        });\n\n                        setTimeout(function () {\n                            tableFunction.saveChanges(true);\n                        }, 200);\n                    });\n                    parentLi.find('.cell_option').addClass('active');\n                } else {\n                    tableFunction.getFillArray(selection, Wptm, {cell_type: null}, \"set_cells_type\");\n                    parentLi.find('.active').removeClass('active');\n                }\n                tableFunction.cleanHandsontable();\n                render = true;\n            }\n            break;\n        case 'border_color':\n            if ($(this).data('keyup') === 1) {\n                value = $(this).val();\n                $(this).parents('.wp-picker-container').find('.wp-color-result').css('color', value);\n                border_cell(selection, Wptm, 'color', render);\n                $(this).data('keyup', 0).change();\n                render = true;\n            }\n            break;\n        case 'border_all':\n            if ($(this).hasClass('active') && !re_active) {\n                border_selection = {};\n                border_selection2 = {};\n                border_selection3 = {};\n                for (i = 0; i < table_function_data.selectionSize; i++) {\n                    border_selection[i] = [selection[i][0], selection[i][1], selection[i][0], selection[i][3]];\n                    if (selection[i][0] - 1 >= 0) {\n                        border_selection2[i] = [selection[i][0] - 1, selection[i][1], selection[i][0] - 1, selection[i][3]];\n                    }\n                    if (selection[i][1] - 1 >= 0) {\n                        border_selection3[i] = [selection[i][0], selection[i][1] - 1, selection[i][2], selection[i][1] - 1];\n                    }\n                }\n                tableFunction.getFillArray(selection, Wptm, {cell_border_left: '', cell_border_top: '', cell_border_right: '', cell_border_bottom: ''});\n\n                if (tableFunction.droptablesCheckSize(border_selection2) > 0) {\n                    tableFunction.getFillArray(border_selection2, Wptm, {cell_border_bottom: ''});\n                }\n                if (tableFunction.droptablesCheckSize(border_selection3) > 0) {\n                    tableFunction.getFillArray(border_selection3, Wptm, {cell_border_right: ''});\n                }\n                $(this).removeClass('active');\n            } else {\n                border_cell(selection, Wptm, 'position', 'cell_border_left', 'cell_border_top', 'cell_border_right', 'cell_border_bottom');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_top':\n            border_selection = {};\n            border_selection2 = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                border_selection[i] = [selection[i][0], selection[i][1], selection[i][0], selection[i][3]];\n                if (selection[i][0] - 1 >= 0) {\n                    border_selection2[i] = [selection[i][0] - 1, selection[i][1], selection[i][0] - 1, selection[i][3]];\n                }\n            }\n            var parameter;\n            if (table_function_data.option_selected_mysql !== '' && typeof table_function_data.option_selected_mysql !== 'undefined') {\n                parameter = 'cell_border_top_start';\n            } else {\n                parameter = 'cell_border_top';\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                var x = {};\n                x[parameter] = '';\n                tableFunction.getFillArray(border_selection, Wptm, x);\n                if (tableFunction.droptablesCheckSize(border_selection2) > 0 && parameter === 'cell_border_top') {\n                    tableFunction.getFillArray(border_selection2, Wptm, {cell_border_bottom: ''});\n                }\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', parameter);\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_bottom':\n            var border_selection = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                border_selection[i] = [selection[i][2], selection[i][1], selection[i][2], selection[i][3]];\n            }\n            var parameter;\n            if (table_function_data.option_selected_mysql !== '' && typeof table_function_data.option_selected_mysql !== 'undefined') {\n                parameter = 'cell_border_bottom_end';\n            } else {\n                parameter = 'cell_border_bottom';\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                var x = {};\n                x[parameter] = '';\n                tableFunction.getFillArray(border_selection, Wptm, x);\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', parameter);\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_left':\n            border_selection = {};\n            border_selection2 = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                border_selection[i] = [selection[i][0], selection[i][1], selection[i][2], selection[i][1]];\n                if (selection[i][1] - 1 >= 0) {\n                    border_selection2[i] = [selection[i][0], selection[i][1] - 1, selection[i][2], selection[i][1] - 1];\n                }\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(border_selection, Wptm, {cell_border_left: ''});\n                if (tableFunction.droptablesCheckSize(border_selection2) > 0) {\n                    tableFunction.getFillArray(border_selection2, Wptm, {cell_border_right: ''});\n                }\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', 'cell_border_left');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_right':\n            border_selection = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                border_selection[i] = [selection[i][0], selection[i][3], selection[i][2], selection[i][3]];\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(border_selection, Wptm, {cell_border_right: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', 'cell_border_right');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_horizontal':\n            border_selection = {};\n\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                if (selection[i][0] === selection[i][2]) {\n                    return false;\n                } else {\n                    border_selection[i] = [selection[i][0], selection[i][1], selection[i][2] - 1, selection[i][3]];\n                }\n            }\n\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(border_selection, Wptm, {cell_border_bottom: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', 'cell_border_bottom');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_clear':\n            wptm_element.primary_toolbars.find('#cell_border > div > a.cell_option.active').each(function () {\n                jquery(this).removeClass('active');\n            });\n            tableFunction.getFillArray(selection, Wptm, {cell_border_left: '', cell_border_top: '', cell_border_right: '', cell_border_bottom: ''});\n            if (table_function_data.option_selected_mysql !== '' && typeof table_function_data.option_selected_mysql !== 'undefined') {\n                tableFunction.getFillArray(selection, Wptm, {cell_border_top_start: '', cell_border_bottom_end: ''});\n            }\n\n            // Get cells range above selection\n            var topCellsSelections = {};\n            Object.keys(selection).map(function (key, index) {\n                var x = selection[key][0] - 1 > 0 ? selection[key][0] - 1 : 0;\n                topCellsSelections[key] = [x, selection[key][1], x, selection[key][3]];\n            });\n            tableFunction.getFillArray(topCellsSelections, Wptm, {cell_border_bottom: ''});\n\n            var leftCellsSelections = {};\n            var fillLeftCells = true;\n            Object.keys(selection).map(function (key, index) {\n                var y = selection[key][1] - 1 > 0 ? selection[key][1] - 1 : 0;\n                leftCellsSelections[key] = [selection[key][0], y, selection[key][2], y];\n                if (parseInt(selection[key][1]) === 0) {\n                    fillLeftCells = false;\n                }\n            });\n            if (fillLeftCells) {\n                tableFunction.getFillArray(leftCellsSelections, Wptm, {cell_border_right: ''});\n            }\n\n            render = true;\n            break;\n        case 'border_vertical':\n            border_selection = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                if (selection[i][1] === selection[i][3]) {\n                    return false;\n                } else {\n                    border_selection[i] = [selection[i][0], selection[i][1], selection[i][2], selection[i][3] - 1];\n                }\n            }\n\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(border_selection, Wptm, {cell_border_right: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', 'cell_border_right');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_inner':\n            var new_selection = [];\n            new_selection['bottom'] = [];\n            new_selection['right'] = [];\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                new_selection['bottom'][i] = $.extend([], selection[i]);\n                new_selection['right'][i] = $.extend([], selection[i]);\n                if (selection[i][1] === selection[i][3]) {\n                    return false;\n                } else {\n                    new_selection['right'][i][3] = selection[i][3] - 1;\n                }\n                if (selection[i][0] === selection[i][2]) {\n                    return false;\n                } else {\n                    new_selection['bottom'][i][2] = selection[i][2] - 1;\n                }\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(new_selection['right'], Wptm, {cell_border_right: ''});\n                tableFunction.getFillArray(new_selection['bottom'], Wptm, {cell_border_bottom: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(new_selection['bottom'], Wptm, 'position', 'cell_border_bottom');\n                border_cell(new_selection['right'], Wptm, 'position', 'cell_border_right');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_outer':\n            var val, ij, ik;\n            if ($(this).hasClass('active') && !re_active) {\n                $(this).removeClass('active');\n                val = 'no_active';\n            } else {\n                $(this).addClass('active');\n                val = 'active';\n            }\n\n            $.map(selection, function (v) {\n                if (val === 'no_active') {\n                    for (ij = v[0]; ij <= v[2]; ij++) {\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_right: ''}, ij, v[1] - 1);//before cell\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_right: ''}, ij, v[3]);\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_left: ''}, ij, v[3] + 1);//after cell\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_left: ''}, ij, v[1]);\n                    }\n                    for (ik = v[1]; ik <= v[3]; ik++) {\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_top: ''}, v[2] + 1, ik);\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_top: ''}, v[0], ik);\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_bottom: ''}, v[0] - 1, ik);\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_bottom: ''}, v[2], ik);\n                    }\n                } else {\n                    border_cell([[v[0], v[3], v[2], v[3]]], Wptm, 'position', 'cell_border_right');\n                    border_cell([[v[0], v[1], v[2], v[1]]], Wptm, 'position', 'cell_border_left');\n                    border_cell([[v[2], v[1], v[2], v[3]]], Wptm, 'position', 'cell_border_bottom');\n                    border_cell([[v[0], v[1], v[0], v[3]]], Wptm, 'position', 'cell_border_top');\n                }\n            });\n\n            render = true;\n            break;\n        case 'border_width':\n            border_cell(selection, Wptm, 'border_width', render);\n            render = true;\n            break;\n        case 'border_solid':\n            $(this).siblings('.border_style.active').removeClass('active');\n            $(this).addClass('active');\n            border_cell(selection, Wptm, 'border_style', render);\n\n            render = true;\n            break;\n        case 'border_dashed':\n            $(this).siblings('.border_style.active').removeClass('active');\n            $(this).addClass('active');\n            border_cell(selection, Wptm, 'border_style', render);\n\n            render = true;\n            break;\n        case 'border_dotted':\n            $(this).siblings('.border_style.active').removeClass('active');\n            $(this).addClass('active');\n            border_cell(selection, Wptm, 'border_style', render);\n\n            render = true;\n            break;\n        case 'merge_cell':\n            if (Wptm.type !== 'mysql') {\n                if ((selection[0][3] - selection[0][1] + selection[0][2] - selection[0][0]) < 1) {\n                    return false;\n                }\n                if (table_function_data.selectionSize > 1) {//if selection > 1 when not merge and select selection[0]\n                    $(Wptm.container).handsontable(\"selectCell\", selection[0][0], selection[0][1], selection[0][2], selection[0][3]);\n                    return false;\n                }\n                if ($(this).hasClass('active')) {\n                    $(Wptm.container).handsontable('getInstance').getPlugin('mergeCells').unmergeSelection();\n                    $(this).removeClass('active');\n                } else {\n                    $(Wptm.container).handsontable('getInstance').getPlugin('mergeCells').mergeSelection();\n                    $(this).addClass('active');\n                }\n            }\n            break;\n    }\n    return render;\n}\n\n/**\n * Convert border value for cell\n *\n * @param selection Selected cells\n * @param Wptm\n */\nfunction border_cell(selection, Wptm) {\n    var border_color = wptm_element.primary_toolbars.find('#border_color').val();\n    if (typeof border_color === 'undefined' || border_color === '') {\n        border_color = 'rgba(0, 0, 0, 0)';\n    }\n    var cell_border_style = 'solid';\n    switch (wptm_element.primary_toolbars.find('#cell_border_style a.border_style.active').attr('name')) {\n        case 'border_solid':\n            cell_border_style = 'solid';\n            break;\n        case 'border_dashed':\n            cell_border_style = 'dashed';\n            break;\n        case 'border_dotted':\n            cell_border_style = 'dotted';\n            break;\n    }\n\n    var width = '1';\n    var cell_border_width = wptm_element.primary_toolbars.find('#cell_border_width').val();\n    width = cell_border_width !== '' ? cell_border_width : '1';\n\n    var position = [];\n    if (arguments[2] !== 'position') {\n        position = wptm_element.primary_toolbars.find('#cell_border > div > a.cell_option.active').each(function () {\n            second_menu.call(jquery(this), arguments[3], 're_active');\n        });\n        return false;\n    } else {\n        position = Array.prototype.slice.call(arguments, 3);\n    }\n    position.map(function (foo) {\n        var value = {};\n        value[foo] = '' + width + 'px ' + cell_border_style + ' ' + border_color;\n        switch (foo) {\n            case 'cell_border_top':\n                // Get cells range above selection\n                var topCellsSelections = {};\n                var topCellsSelections2;\n                tableFunction.getFillArray(selection, Wptm, value);\n\n                Object.keys(selection).map(function (key, index) {\n                    if (selection[key][0] > 0) {\n                        var x = selection[key][0] - 1;\n                        topCellsSelections[key] = [x, selection[key][1], x, selection[key][3]];\n                    }\n                    if (selection[key][0] <= Wptm.headerOption && selection[key][2] >= Wptm.headerOption) {\n                        topCellsSelections2 = {};\n                        topCellsSelections2[key] = [Wptm.headerOption, selection[key][1], Wptm.headerOption, selection[key][3]];\n                    }\n                });\n\n                if (typeof topCellsSelections2[0] !== 'undefined') {\n                    tableFunction.getFillArray(topCellsSelections2, Wptm, {'cell_border_top': ''});\n                }\n\n                if (typeof topCellsSelections[0] !== 'undefined') {\n                    tableFunction.getFillArray(topCellsSelections, Wptm, {cell_border_bottom: '' + width + 'px ' + cell_border_style + ' ' + border_color});\n                }\n                break;\n            case 'cell_border_left':\n                // Get cells range left selection\n                var leftCellsSelections = {};\n                var fillLeftCells = true;\n                Object.keys(selection).map(function (key, index) {\n                    var y = selection[key][1] - 1 > 0 ? selection[key][1] - 1 : 0;\n                    if (parseInt(selection[key][1]) === 0) {\n                        fillLeftCells = false;\n                    }\n                    leftCellsSelections[key] = [selection[key][0], y, selection[key][2], y];\n                });\n\n                if (fillLeftCells) {\n                    tableFunction.getFillArray(leftCellsSelections, Wptm, {cell_border_right: '' + width + 'px ' + cell_border_style + ' ' + border_color});\n                }\n                tableFunction.getFillArray(selection, Wptm, value);\n                break;\n            default:\n                tableFunction.getFillArray(selection, Wptm, value);\n                break;\n        }\n    });\n\n}\n\n/*\npopup and action for this\nwptm_popup     #wptm_popup\npopup          object data popup\nclone          check clone content in popup\nselector_cells get selector cells to popup window\nsubmit_button  get submit button to popup window\n*/\nfunction wptm_popup(wptm_popup, popup, clone, selector_cells, submit_button, update_option_cell) {\n    if (update_option_cell === true) {\n        var selection = getSelector();\n        updateOptionValCell(jquery, Wptm, selection);\n    }\n\n    wptm_popup.find('.content').contents().remove();\n    var over_popup = wptm_popup.siblings('#over_popup');\n    if (!clone) {\n        var that = wptm_popup.find('.content').append(popup.html);\n    } else {\n        var that = wptm_popup.find('.content').append(popup.html.clone());\n        // window.jquery(html).appendTo(window.jquerywptm_popup.find('.content'));\n    }\n\n    if (selector_cells === true) {\n        wptm_popup.find('.content .popup_top').after(window.wptm_element.content_popup_hide.find('#select_cells').clone());\n        var function_data = window.table_function_data;\n        if (typeof function_data.selection !== 'undefined' && function_data.selection[0] !== undefined && _.size(function_data.selection[0]) > 0) {\n            tableFunction.getSelectedVal(function_data.selection[0], that.find('.cellRangeLabelAlternate'));\n        }\n    }\n\n    if (submit_button === true) {\n        that.find('>div').append(window.wptm_element.content_popup_hide.find('#submit_button').clone());\n    }\n    wptm_popup.animate({'opacity': '1'}, 10);\n\n    wptm_popup.show();\n    over_popup.show();\n\n    //selection cells\n    that.find('#get_select_cells').unbind('click').on('click', function () {\n        alternating.affterRangeLabe.call(that, window.Wptm, window.jquery);\n        that.find('.cellRangeLabelAlternate').val();\n    });\n    that.find('.cellRangeLabelAlternate').on('keyup', function (e) {\n        if (e.which == 13) {\n            alternating.affterRangeLabe.call(that, window.Wptm, window.jquery);\n        }\n    });\n\n    /*action when show popup*/\n    if (typeof popup.showAction !== 'undefined') {\n        popup.showAction.call(that);\n    }\n\n    /*action selector*/\n    if (typeof popup.selector !== 'undefined') {\n        var select = select_input_popup.bind(popup, that);\n        select();\n    }\n\n    // select_tab\n    // that.find('.select_tab').find('.link-tab').on('click', function (e) {\n    //     e.preventDefault();\n    //     topTab.find('li.tab a[href=\"'+ tabHref +'\"]').click();\n    //     currentSubMenu.find('li.tab div.link-tab').removeClass('active');\n    //     $(this).addClass('active');\n    // });\n\n    /*action enter input*/\n    if (popup.inputEnter) {\n        that.find('input').on('keyup', function (e, i) {\n            if (e.keyCode === 13) {\n                if (typeof popup.submitAction !== 'undefined') {\n                    setTimeout(function () {\n                        popup.submitAction.call(that);\n                    }, 200);\n                } else {\n                    jquery(this).trigger('change');\n                }\n                wptm_popup.find('.colose_popup').trigger('click');\n            }\n            return true;\n        });\n    }\n\n    /*click done button*/\n    that.find('#popup_done').unbind('click').on('click', function (e) {\n        e.preventDefault();\n        if (typeof popup.submitAction !== 'undefined' && !jquery(this).hasClass('not_active')) {\n            setTimeout(function () {\n                popup.submitAction.call(that);\n            }, 200);\n        }\n        return false;\n    });\n\n    /*click cancel button*/\n    that.find('#popup_cancel').unbind('click').on('click', function (e) {\n        e.preventDefault();\n\n        setTimeout(function () {\n            wptm_popup.hide();\n            over_popup.hide();\n            if (typeof popup.cancelAction !== 'undefined') {\n                wptm_popup.animate({'opacity': '0'}, 10);\n                popup.cancelAction.call(that);\n            }\n        }, 200);\n        return false;\n    });\n\n    //action colose\n    wptm_popup.find('.colose_popup').unbind('click').on('click', function (e) {\n        e.preventDefault();\n\n        if (typeof popup.render !== 'undefined' && popup.render === true) {\n            window.jquery(window.Wptm.container).data('handsontable').render();\n        }\n\n        setTimeout(function () {\n            wptm_popup.hide();\n            over_popup.hide();\n            if (typeof popup.cancelAction !== 'undefined') {\n                wptm_popup.animate({'opacity': '0'}, 10);\n                popup.cancelAction.call(that);\n            }\n        }, 200);\n        return false;\n    });\n    over_popup.unbind('click').on('click', function (e) {\n        e.preventDefault();\n        wptm_popup.find('.colose_popup').trigger('click');\n        return false;\n    });\n\n    that.find('.tooltipster').each(function () {\n        jquery(this).tooltipster({\n            theme: 'tooltipster-borderless',\n            delay: 100,\n            maxWidth: 300,\n        });\n    })\n    //set top for popup\n    //wptm_popup.css('top', (over_popup.outerHeight() - wptm_popup.outerHeight()) / 2);\n\n    if (typeof popup.afterShowAction !== 'undefined') {\n        popup.afterShowAction.call(that);\n    }\n\n    return false;\n}\n\n/**\n * Selector Control function in popup\n *\n * @param that Wptm_popup.find('.content')\n */\nvar select_input_popup = function (that) {\n    if (typeof this.selector !== 'undefined') {\n        window.jquery.each(this.selector, (i, e) => {\n            that.find(e).change((e) => {\n                if (typeof this.option[i] !== 'undefined') {\n                    this.option[i] = window.jquery(e.currentTarget).val();\n                }\n                if (typeof this.inputAction !== 'undefined') {\n                    this.inputAction.call(that, i);\n                }\n            });\n        });\n    }\n}\n\n/**\n * add value for table_function_data.selection and table_function_data.selectionSize\n *\n * @returns {*}\n */\nvar getSelector = function () {\n    var selection = [];\n    // if (typeof selection === 'undefined' || selection === undefined || !selection) {\n    selection = window.jquery(window.Wptm.container).handsontable('getSelected');//get all cells selected ex:[[0,0,1,9],[3,0,3,9]]\n    // }\n    if (selection !== false && typeof selection !== 'undefined' && selection.length > 0) {\n        //check when handsontable('getSelected') return array[0] = array;\n        window.table_function_data.selectionSize = _.size(selection);\n        window.table_function_data.selection = []\n        for (var i = 0; i < table_function_data.selectionSize; i++) {\n            if (selection[i][0] > selection[i][2]) {\n                selection[i] = [selection[i][2], selection[i][3], selection[i][0], selection[i][1]];\n            }\n            if (selection[i][1] > selection[i][3]) {\n                selection[i] = [selection[i][0], selection[i][3], selection[i][2], selection[i][1]];\n            }\n            window.table_function_data.selection.push(selection[i])\n        }\n        // window.table_function_data.selection = selection;\n    } else {\n        window.table_function_data.selection = false;\n        window.table_function_data.selectionSize = 0;\n    }\n\n    return selection;\n}\n\nvar loadSelectionTimeout;\n/**\n * Update status item in cell_menu and table_menu by cell selected\n *\n * @param $\n * @param Wptm\n * @param selection Cell selected\n *\n * @returns {boolean}\n */\nvar loadSelection = function ($, Wptm, selection) {\n    selection = getSelector();\n    if (!selection) {\n        return true;\n    }\n    //show value cell to #CellValue when selector a cell\n    let size_selection = table_function_data.selectionSize - 1\n    let merege_cell = false;\n\n    if (typeof Wptm.mergeCellsSetting !== 'undefined' && Wptm.mergeCellsSetting.length > 0) {\n        Wptm.mergeCellsSetting.map(function (v, i) {\n            if (\n                selection[size_selection][0] == v.row\n                && selection[size_selection][1] == v.col\n                && (v.rowspan + v.row - 1) == selection[size_selection][2]\n                && (v.colspan + v.col - 1) == selection[size_selection][3]\n            ) {\n                merege_cell = true;\n            }\n        });\n    }\n\n    if (merege_cell || (selection[size_selection][0] === selection[size_selection][2] && selection[size_selection][1] === selection[size_selection][3])) {\n        wptm_element.cellValue.val(Wptm.datas[selection[size_selection][0]][selection[size_selection][1]]);\n        table_function_data.cellValueChange = Wptm.datas[selection[size_selection][0]][selection[size_selection][1]];\n    } else {\n        wptm_element.cellValue.val('');\n        table_function_data.cellValueChange = '';\n    }\n    table_function_data.checkCellValueChange = false;\n\n    //set value option by selection\n    if (!Wptm.checkTimeOutSelection) {\n        clearTimeout(loadSelectionTimeout);\n    }\n    loadSelectionTimeout = setTimeout(() => {\n        updateOptionValTable($, Wptm, selection);\n\n        updateOptionValCell($, Wptm, selection);\n        //Todo: populate jform_responsive_col\n        Wptm.checkTimeOutSelection = false;\n    }, 200)\n\n    return true;\n}\n\n/**\n * Update status item in table_menu by cell seletoed\n *\n * @param $\n * @param Wptm\n * @param selection\n */\nfunction updateOptionValTable($, Wptm, selection) {\n    if (tableFunction.checkObjPropertyNested(Wptm.style, 'table')) {\n        var styleTable = Wptm.style.table;\n        var wptm_element = window.wptm_element;\n        var selector;\n        $.each(styleTable, function (index, value) {\n            switch (index) {\n                // case 'enable_filters':\n                //     selector = wptm_element.settingTable.find('.filters_menu');\n                //     if (value === 1 || value === '1') {\n                //         selector.parent().addClass('selected');\n                //     } else {\n                //         selector.parent().removeClass('selected');\n                //     }\n                //     break;\n                case 'download_button':\n                    selector = wptm_element.settingTable.find('.download_button_menu');\n                    if (value === 1 || value === '1') {\n                        selector.parent().addClass('selected');\n                    } else {\n                        selector.parent().removeClass('selected');\n                    }\n                    break;\n                case 'print_button':\n                    selector = wptm_element.settingTable.find('.print_button_menu');\n                    if (value === 1 || value === '1') {\n                        selector.parent().addClass('selected');\n                    } else {\n                        selector.parent().removeClass('selected');\n                    }\n                    break;\n                case 'enable_pagination':\n                    selector = wptm_element.settingTable.find('.pagination_menu');\n                    if (value === 1 || value === '1') {\n                        selector.parent().addClass('selected');\n                    } else {\n                        selector.parent().removeClass('selected');\n                    }\n                    break;\n                // case 'use_sortable':\n                //     selector = wptm_element.settingTable.find('.sort_menu');\n                //     if (value === 1 || value === '1') {\n                //         selector.parent().addClass('selected');\n                //     } else {\n                //         selector.parent().removeClass('selected');\n                //     }\n                //     break;\n                case 'table_align':\n                    if (value !== '') {\n                        selector = wptm_element.settingTable.find('.align_menu').siblings('.sub-menu').find('li[name=\"' + value + '\"]');\n                        selector.siblings('li.selected').removeClass('selected');\n                        selector.addClass('selected');\n                    }\n                    break;\n                case 'col_types':\n                    if (typeof table_function_data.selection[0] !== 'undefined') {\n                        var first_column_selected = table_function_data.selection[0][1];\n                        if (typeof value[first_column_selected] !== 'undefined') {\n                            table_function_data.type_column_selected = value[first_column_selected];\n                        }\n                    }\n                    break;\n                default:\n                    break;\n            }\n        });\n    } else {\n\n    }\n}\n\n/**\n * Update status item in cell_menu by cell seletoed\n *\n * @param $\n * @param Wptm\n * @param selection\n */\nfunction updateOptionValCell($, Wptm, selection) {\n    var colsStyle = Wptm.style.cols;\n    var cellsStyle = Wptm.style.cells;\n    var rowsStyle = Wptm.style.rows;\n    var size_selection = table_function_data.selectionSize - 1;\n    if (size_selection < 0) {//not cell selected\n        return;\n    }\n    var endCell = [selection[size_selection][2], selection[size_selection][3]];\n    var end_cell = selection[size_selection][2] + '!' + selection[size_selection][3];\n\n    if (!tableFunction.checkObjPropertyNested(Wptm.style, 'cells')) {//fix when Wptm.style.cells not exist\n        Wptm.style.cells = {};\n    }\n\n    window.table_function_data.selectOption = true;//if == true then not click function\n    var cell_style = {};\n\n    if (typeof colsStyle[selection[size_selection][3]] !== 'undefined') {\n        cell_style = $.extend({}, colsStyle[selection[size_selection][3]][1]);\n    }\n    if (typeof rowsStyle[selection[size_selection][2]] !== 'undefined') {\n        cell_style = $.extend({}, cell_style, rowsStyle[selection[size_selection][2]][1]);\n    }\n\n    if (tableFunction.checkObjPropertyNested(Wptm.style, 'cells', end_cell, 2)) {\n        if ((Wptm.type === 'html' || selection[size_selection][2] === 0) && typeof cellsStyle[end_cell] !== 'undefined') {\n            cell_style = $.extend({}, cell_style, cellsStyle[end_cell][2]);\n        }\n    } else {//fix when Wptm.style.cells[endCell] not exist\n        tableFunction.getFillArray(selection, Wptm, {});\n    }\n\n    //tooltip\n    var $tooltip_content = $('#tooltip_content');\n    if ($tooltip_content.length > 0) {\n        tableFunction.updateParamFromStyleObject(cell_style, 'tooltip_width', $('#tooltip_width'), 0);\n\n        tinyMCE.EditorManager.execCommand('mceRemoveEditor', true, 'tooltip_content');\n        tableFunction.updateParamFromStyleObject(cell_style, 'tooltip_content', $('#tooltip_content'), \"\");\n        var contenNeedToset = $('#tooltip_content').val();\n\n        var initTT = tinymce.extend({}, tinyMCEPreInit.mceInit['tooltip_content']);\n        try {\n            tinymce.init(initTT);\n        } catch (e) {\n        }\n\n        //add tinymce to this\n        tinyMCE.EditorManager.execCommand('mceAddEditor', true, 'tooltip_content');\n        if (tinyMCE.EditorManager.get('tooltip_content') != null) {\n            var ttEditor = tinyMCE.EditorManager.get('tooltip_content');\n            if (ttEditor && ttEditor.getContainer()) {\n                ttEditor.setContent(contenNeedToset);\n            }\n        }\n    }\n\n    if (tableFunction.checkCellsOptionsValidate(table_function_data.selection, 'cell_type', 'html')) {//hide cell formats\n        wptm_element.settingTable.find('a.date_menu_cell').parent('li').addClass('no_active');\n        wptm_element.settingTable.find('a.curency_menu_cell').parent('li').addClass('no_active');\n        wptm_element.settingTable.find('a.decimal_menu_cell').parent('li').addClass('no_active');\n    } else {\n        wptm_element.settingTable.find('a.date_menu_cell').parent('li').removeClass('no_active');\n        wptm_element.settingTable.find('a.curency_menu_cell').parent('li').removeClass('no_active');\n        wptm_element.settingTable.find('a.decimal_menu_cell').parent('li').removeClass('no_active');\n    }\n\n    tableFunction.updateParamFromStyleObject(cell_style, 'thousand_symbol', wptm_element.content_popup_hide.find('#decimal_menu_cell').find('.thousand_symbol'), '');\n    tableFunction.updateParamFromStyleObject(cell_style, 'decimal_symbol', wptm_element.content_popup_hide.find('#decimal_menu_cell').find('.decimal_symbol'), '');\n    tableFunction.updateParamFromStyleObject(cell_style, 'decimal_count', wptm_element.content_popup_hide.find('#decimal_menu_cell').find('.decimal_count'), '');\n\n    tableFunction.updateParamFromStyleObject(cell_style, 'currency_symbol', wptm_element.content_popup_hide.find('#curency_menu_cell').find('.currency_symbol'), '');\n\n    tableFunction.updateParamFromStyleObjectSelectBox(cell_style, 'symbol_position', wptm_element.content_popup_hide.find('#curency_menu_cell').find('.symbol_position').next('.wptm_select_box'), '');\n\n    tableFunction.updateParamFromStyleObject(cell_style, 'date_formats', wptm_element.content_popup_hide.find('#date_menu_cell').find('.date_formats'), Wptm.style.table.date_formats);\n\n\n    tableFunction.updateParamFromStyleObjectSelectBox(cell_style, 'cell_font_family', wptm_element.primary_toolbars.find('#cell_font_family'), 'inherit');\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_size', wptm_element.primary_toolbars.find('#cell_font_size'), 13);\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_bold', wptm_element.primary_toolbars.find('#cell_format_bold'), false, function () {\n        active_table_option(this);\n    });\n\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_underline', wptm_element.primary_toolbars.find('#cell_format_underlined'), false,\n        function () {\n            active_table_option(this);\n        }\n    );\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_format_strikethrough', wptm_element.primary_toolbars.find('#cell_format_strikethrough'), false,\n        function () {\n            active_table_option(this);\n        }\n    );\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_italic', wptm_element.primary_toolbars.find('#cell_format_italic'), false,\n        function () {\n            active_table_option(this);\n        }\n    );\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_background_color', wptm_element.primary_toolbars.find('#cell_background_color'), '',\n        function () {\n            var color = cell_style.cell_background_color;\n            this.wpColorPicker('color', color);\n            this.parents('.wp-picker-container').find('.wp-color-result').css('color', color);\n        }\n    );\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_color', wptm_element.primary_toolbars.find('#cell_font_color'), '',\n        function () {\n            var color = cell_style.cell_font_color;\n            this.wpColorPicker('color', color);\n            this.parents('.wp-picker-container').find('.wp-color-result').css('color', color);\n        }\n    );\n    tableFunction.updateParamFromStyleObject(cell_style, 'text_wrapping', wptm_element.primary_toolbars.find('#text_wrapping'), 'text_wrapping', function () {\n        var value = (typeof cell_style.text_wrapping === 'undefined' || cell_style.text_wrapping === 'break-word')\n            ? 'wrap_cell' : (cell_style.text_wrapping === 'normal' ? 'overflow_cell' : 'clip_cell');\n        wptm_element.primary_toolbars.find('a[name=\"overflow_cell\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"wrap_cell\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"clip_cell\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"' + value + '\"]').addClass('active');\n    });\n\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_text_align', wptm_element.primary_toolbars.find('#cell_text_align'), 'left', function () {\n        var value = typeof cell_style.cell_text_align === 'undefined' ? '' : cell_style.cell_text_align;\n\n        wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"format_align_' + value + '\"]').addClass('active');\n    });\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_vertical_align', wptm_element.primary_toolbars.find('#cell_vertical_align'), 'middle', function () {\n        var value = typeof cell_style.cell_vertical_align === 'undefined' ? cell_style.cell_vertical_align = 'top' : cell_style.cell_vertical_align;\n\n        wptm_element.primary_toolbars.find('a[name=\"vertical_align_bottom\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"vertical_align_middle\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"vertical_align_top\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"vertical_align_' + value + '\"]').addClass('active');\n    });\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_type', wptm_element.primary_toolbars.find('#cell_type'), '', function () {\n        var value = cell_style.cell_type;\n        if (typeof value === 'undefined' || value === '' || value === null) {\n            wptm_element.primary_toolbars.find('#cell_type').removeClass('active');\n        } else {\n            wptm_element.primary_toolbars.find('#cell_type').addClass('active');\n        }\n    });\n    wptm_element.primary_toolbars.find('#cell_border').find('a').each(function () {\n        $(this).removeClass('active');\n    });\n\n    var mergeCellRanger = {\n        'col': selection[size_selection][1],\n        'colspan': selection[size_selection][3] - selection[size_selection][1] + 1,\n        'row': selection[size_selection][0],\n        'rowspan': selection[size_selection][2] - selection[size_selection][0] + 1\n    };\n    if (Wptm.mergeCellsSetting.some(function (mergeCellsSetting) {\n        return mergeCellsSetting.col === mergeCellRanger.col && mergeCellsSetting.row === mergeCellRanger.row;\n    })) {\n        wptm_element.primary_toolbars.find('#merge_cell').addClass('active');\n    } else {\n        wptm_element.primary_toolbars.find('#merge_cell').removeClass('active');\n    }\n\n    window.table_function_data.selectOption = false;\n    //get size(height, width) end cells\n    tableFunction.getSizeCells($, Wptm, endCell);\n}\n\n\nfunction active_table_option(that) {\n    if (that.val() === true) {\n        that.addClass('active');\n    } else {\n        that.removeClass('active');\n    }\n}\n\n/**\n * Create custom select box\n *\n * @param $\n * @param select_function cell function when click select\n * @param multiple multi selector\n * @param afterCreateFunc function when after create element\n */\nfunction custom_select_box($, select_function, multiple, afterCreateFunc) {\n    if (multiple) {\n        $(this).addClass('multiple');\n    }\n\n    $(this).on('click', function (e) {\n        let $that = $(this);\n        let $wptm_select_box = $that.next();\n        let old_value;\n\n        $('#mybootstrap #wptm_popup').find('.wptm_select_box').each(function () {\n            if (!$(this).is($wptm_select_box)) {\n                $(this).hide();\n                $(this).prev().removeClass('show');\n            }\n        });\n\n        let position = $(this).position();\n\n        if ($that.hasClass('show')) {\n            $that.next().hide();\n            $that.removeClass('show');\n            $(document).unbind('click.wptm_select_box');\n            return;\n        }\n\n        let $select = $wptm_select_box.css({\n            top: position.top + 40,\n            left: position.left,\n            'width': $that.outerWidth()\n        }).show();\n\n        if (multiple) {\n            $select.find('li input').prop(\"checked\", false);\n            if ($that.data('value')) {\n                old_value = $that.data('value').split('|');\n                $.each(old_value, function (i, v) {\n                    $select.find('li[data-value=\"' + v + '\"]').find('input').prop(\"checked\", true);\n                })\n            }\n        } else {\n            old_value = $that.data('value');\n        }\n        $that.addClass('show');\n\n        $select.find('li:not(.wptm_turn_off)').unbind('click').on('click', function (e) {\n            let text = '', data = '';\n            let $liTag = $(this);\n            if (multiple) {\n                if ($(e.target).is('input')) {\n                    $liTag = $(e.target).parent();\n                } else {\n                    $liTag.find('input').prop(\"checked\", !$liTag.find('input').is(\":checked\"));\n                }\n            }\n\n            if (!multiple || $liTag.hasClass('data-none')) {\n                text = $liTag.text();\n                data = $liTag.data('value');\n            } else {\n                let checkAll = 0\n                if ($liTag.siblings('.data_all')) {//check all\n                    if($liTag.hasClass('data_all')) {\n                        checkAll = 1\n                        text = ''\n                        data = ''\n                    }\n                    if ($liTag.parent().find('.data_all').find('input').is(\":checked\")) {\n                        checkAll = 2\n                        text = 'All value'\n                        data = 'all_value'\n                    }\n                }\n                $select.find('li:not(.data-none):not(.data_all)').each(function (i, e) {\n                    if (checkAll >= 1) {\n                        $(this).find('input').prop(\"checked\", false)\n                    } else {\n                        if ($(e).find('input').is(\":checked\")) {\n                            if (data !== '') {\n                                text += ',' + $(e).text();\n                                data += '|' + $(e).data('value');\n                            } else {\n                                text += $(e).text();\n                                data += $(e).data('value');\n                            }\n                        }\n                    }\n                });\n            }\n            $select.data('value', data).change();\n            $that.val(data).text(text).data('value', data).change();\n\n            if (typeof select_function !== 'undefined' && select_function !== null) {\n                select_function.call($select, $liTag.data('value'));\n            }\n            if (!multiple || $liTag.hasClass('data-none')) {\n                $('#mybootstrap').find('.wptm_select_box').hide();\n            }\n        });\n\n        $(document).bind('click.wptm_select_box', (e) => {\n            // if (($(e.target).is($(this)) && $that.hasClass('show')) || (!$(e.target).is($(this)) && !(!!multiple && $(e.target).parents('.wptm_select_box').length > 0))) {\n            if (!$(e.target).is($that) && !(!!multiple && $(e.target).parents('.wptm_select_box').length > 0)) {\n                $select.hide();\n                $that.removeClass('show');\n                $(document).unbind('click.wptm_select_box');\n            }\n        });\n    });\n    if (typeof afterCreateFunc !== 'undefined' && afterCreateFunc !== null) {\n        afterCreateFunc.call($(this))\n    }\n}\n\nexport default {getSelector, selectOption, loadSelection, updateOptionValTable, wptm_popup}","/**\n * Wptm\n *\n * We developed this code with our hearts and passion.\n * We hope you found it useful, easy to understand and to customize.\n * Otherwise, please feel free to contact us at contact@joomunited.com *\n * @package Wptm\n * @copyright Copyright (C) 2014 JoomUnited (http://www.joomunited.com). All rights reserved.\n * @copyright Copyright (C) 2014 Damien Barrre (http://www.crac-design.com). All rights reserved.\n * @license GNU General Public License version 2 or later; http://www.gnu.org/licenses/gpl-2.0.html\n */\nimport tableFunction from \"./_functions\";\nimport {initHandsontable, getMergeCells, calHeightTable} from \"./_initHandsontable\";\nimport alternating from \"./_alternating\";\nimport selectOption from \"./_toolbarOptions\";\nimport DropChart from \"./_chart\";\nimport customRenderer from \"./_customRenderer\";\n\njQuery('title').text(wptmText.EDIT_TABLE_TITLE_TAG);\n\njQuery(window).bind('beforeunload', function(){\n    if(!checkTimeOut)\n        return true;\n});\n\n/*document\nvariable: Wptm.newSelect = 'row' or 'col' -> when select by rows or column. undefined when other cases\n*/\n\njQuery(document).ready(function ($) {\n    window.jquery = $;\n\n    var popup = $(\"#wptm_popup\").draggable({\n        containment: \"#pwrapper\",\n        drag: function( event, ui ) {\n            $(this).css('transform', 'none');\n        },\n    });\n\n    var popup_edit_html_cell = $(\"#wptm_edit_html_cell\").draggable({\n        containment: \"#pwrapper\",\n        drag: function( event, ui ) {\n            $(this).css('transform', 'none');\n        },\n    });\n\n    $('.tip').tooltipster({\n        theme: 'tooltipster-borderless',\n        delay: 100,\n        distance: 5,\n    });\n    $(document).on('click', '.search-open-btn', function (e) {\n        var btn = $(this);\n        var search_menu = btn.closest('.search-menu');\n        if (!search_menu.hasClass(\"open\")) {\n            search_menu.addClass(\"open\");\n        }\n    });\n    $(document).on('mouseup', function (e) {\n        var container = $(\".search-menu\");\n        // if the target of the click isn't the container nor a descendant of the container\n        if (!container.is(e.target) && container.has(e.target).length === 0 && container.hasClass(\"open\")) {\n            container.removeClass(\"open\");\n        }\n    });\n    $('.wp-color-result-text').each(function () {\n        var tip = $(this).closest('.cells_option').attr('title');\n        $(this).attr('title', tip).tooltipster({\n            theme: 'tooltipster-borderless',\n            delay: 0,\n            distance: 5,\n        });\n    });\n    if (typeof (Wptm) == 'undefined') {\n        Wptm = {};\n        Wptm.can = {};\n        Wptm.can.create = true;\n        Wptm.can.edit = true;\n        Wptm.can.delete = true;\n        Wptm.selection = {};\n        Wptm.value_unit_chart = [];\n        Wptm.hyperlink = {};\n    } else {\n        Wptm.value_unit_chart = [];\n    }\n    Wptm.updateSettings = {};\n    Wptm.saveDataDbTable = [];\n\n    if (typeof (Wptm.can) == 'undefined') {\n        Wptm.can = {};\n        Wptm.can.create = true;\n        Wptm.can.edit = true;\n        Wptm.can.delete = true;\n        Wptm.hyperlink = {};\n    }\n\n    Wptm.checkTimeOutSelection = false;\n\n    if (typeof (wptm_isAdmin) == 'undefined') {\n        wptm_isAdmin = false;\n    }\n    Wptm.clearHandsontable = true;\n    if (typeof chart_active !== 'undefined' && parseInt(chart_active) > 0) {\n        Wptm.chart_active = chart_active;\n    } else {\n        $('#over_loadding_open_chart').hide();\n    }\n\n    if (typeof window.parent.wptm_insert !== 'undefined' && typeof window.parent.wptm_insert.opend_table !== 'undefined') {\n        delete window.parent.wptm_insert.opend_table;\n    }\n\n    window.wptm_element = {\n        wpreview: $('#wptm-toolbars'),\n        primary_toolbars: $('#primary_toolbars'),\n        mainTabContent: $('#mainTabContent'),\n        tableContainer: $('#tableContainer'),\n        wptm_popup: $('#wptm_popup'),\n        content_popup_hide: $('#content_popup_hide'),\n        cellValue: $('#CellValue'),\n        settingCells: $('#setting-cells'),\n        settingTable: $('#table-setting'),\n        nameTable: $('#name-table'),\n        alternating_color: $('#alternating_color'),\n        editToolTip: $('#editToolTip'),\n        edit_html_cell: $('#edit_html_cell'),\n        wptm_edit_html_cell: $('#wptm_edit_html_cell'),\n        saveToolTipbtn: $('#saveToolTipbtn'),\n        chartTabContent: $('#chartTabContent'),\n        wptmContentChart: $('#wptm_chart .wptm_content_chart')\n    };\n\n    //saving all function data\n    window.table_function_data = {\n        replace_unit: {},\n        text_replace_unit: '',\n        text_replace_unit_function: '',\n        date_format: [],\n        check_value_data: true,\n        string_currency_symbols: '',\n        selectFetch: {},\n        allAlternate: {},\n        oldAlternate: {},\n        changeAlternate: [],\n        checkChangeAlternate: [],\n        selection: [],\n        styleToRender: '',\n        content: '',\n        needSaveAfterRender: false,\n        alternateIndex: '',\n        alternateSelection: [],\n        save_table_params: [],\n        firstRender: false,\n        accountingNumber : {}\n    };\n\n    // is writing\n    if (typeof idUser !== 'undefined' && idUser !== null) {\n        var listUserEdit = {};\n    }\n\n    /* init menu actions */\n\n    window.default_value = $.extend({}, {\n        'use_sortable': '0',\n        'fonts_used': [],\n        'fonts_local_used': [],\n        'default_sortable': '0',\n        'default_order_sortable': '1',\n        'table_align': 'center',\n        'responsive_type': 'scroll',\n        'table_breakpoint': '980',\n        'freeze_col': 0,\n        'table_height': 500,\n        'style_repeated': 0,\n        'freeze_row': 0,\n        'enable_filters': 0,\n        'enable_filters_all': 0,\n        'enable_pagination': 0,\n        'allRowHeight': '',\n        'spreadsheet_url': '',\n        'spreadsheet_style': 0,\n        'auto_sync': 0,\n        'auto_push': 0,\n        'download_button': 0,\n        'print_button': 0,\n        'col_types': [\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\"]\n    }, default_value);\n\n    if (typeof idTable !== 'undefined' && idTable !== '') {\n        updatepreview(idTable);\n\n        if ($('.wptm-page').length > 0 && $('#adminmenuwrap').length > 0) {\n            Scrollbar.init(document.querySelector('#adminmenuwrap'), {\n                damping: 0.5,\n                thumbMinSize: 10,\n                alwaysShowTracks: false\n            });\n        }\n    }\n\n    //create new table\n    wptm_element.primary_toolbars.find('.new_table_menu').on('click', function (e) {\n        e.preventDefault();\n\n        if (!(Wptm.can.create)) {\n            return;\n        }\n\n        if (!wptm_permissions.can_create_tables) {\n            tableFunction.wptmBootbox('', wptm_permissions.translate.wptm_create_tables, true, false);\n            return false;\n        }\n\n        var id_category = Wptm.category;\n        var curr_page = window.location.href;\n        var cells = curr_page.split(\"?\");\n\n        $.ajax({\n            url: wptm_ajaxurl + \"task=table.add&id_category=\" + id_category,\n            type: \"POST\",\n            data: {},\n            dataType: \"json\",\n            success: function (datas) {\n                if (datas.response === true) {\n                    var new_url = cells[0] + '?page=wptm&id_table=' + datas.datas.id;\n                    if (typeof wptm_open_table !== 'undefined' && wptm_open_table != 0) {\n                        window.open(new_url);\n                    } else {\n                        window.location = new_url;\n                    }\n                } else {\n                    tableFunction.wptmBootbox('', datas.response, true, false);\n                }\n            },\n            error: function (jqxhr, textStatus, error) {\n                tableFunction.wptmBootbox(textStatus + \" : \" + error, true, false);\n            }\n        });\n        return false;\n    });\n\n    tableFunction.wptmCollapsible()\n});\n\nfunction importExcel($, that) {\n    //Import Excel\n    //Init call back when file is uploaded successful\n\n    that.find(\".procExcelCsv\").dropzone({\n        url: \"admin-ajax.php?action=Wptm&task=excel.import\",\n        maxFiles: 1,\n        init: function () {\n            //Update form action\n            this.on(\"addedfile\", (file) => {\n                var dotPos = file.name.lastIndexOf('.') + 1;\n                var ext = file.name.substr(dotPos, file.name.length - dotPos);\n\n                if ($(this.element).hasClass('procCsv')) {\n                    if (ext !== 'csv') {\n                        tableFunction.wptmBootbox('', wptmText.CHOOSE_CSV_FIE_TYPE, true, false);\n                        this.options.autoProcessQueue = false;\n                        this.removeFile(file);\n                    } else {\n                        if (this.options.autoProcessQueue === false) {\n                            this.options.autoProcessQueue = true;\n                        }\n                    }\n                } else {\n                    if (ext !== 'xls' && ext !== 'xlsx') {\n                        tableFunction.wptmBootbox('', wptmText.CHOOSE_EXCEL_FIE_TYPE, true, false);\n                        this.options.autoProcessQueue = false;\n                        this.removeFile(file);\n                    } else {\n                        if (this.options.autoProcessQueue === false) {\n                            this.options.autoProcessQueue = true;\n                        }\n                    }\n                }\n            });\n\n            this.on(\"sending\", function (file, xhr, formData) {\n                tableFunction.WptmLoading(that.find(\".loading-page\"), 50, 0, 10);\n                $('.prevent_event_popup').show();\n                file.previewElement.innerHTML = \"\";//remove Layout dropzone\n                //Add table id to formData\n                $(\"#jform_id_table\").val(idTable);\n                formData.append('id_table', idTable);\n                if ($(this.element).hasClass('procCsv')) {\n                    formData.append('onlydata', 0);\n                } else {\n                    formData.append('onlydata', that.find(\"#import_style\").val());\n                    formData.append('getListSheet', that.find('#select_sheet_import').val() || 1);\n                }\n\n                // Show the total progress bar when upload starts\n                that.find(\".progress\").show();\n                that.find(\".progress-bar-success\").css('width', 30 + '%');\n                that.find(\".progress-bar-success\").css('opacity', 1);\n                // And disable the start button\n            });\n\n            this.on(\"success\", function (file, responseText) {\n                var responseObj = JSON.parse(responseText);\n                file.previewElement.innerHTML = \"\";//remove Layout dropzone\n\n                if (responseObj.response === true) {\n                    if (typeof responseObj.datas.too_large !== 'undefined') {\n                        tableFunction.wptmBootbox('', responseObj.datas.msg, true, true, () => {\n                            var jsonVar = {\n                                id_table: responseObj.datas.id,\n                                onlydata: responseObj.datas.onlydata,\n                                file: encodeURI(responseObj.datas.file),\n                                ignoreCheck: 1\n                            };\n                            $.ajax({\n                                url: wptm_ajaxurl + \"task=excel.import\",\n                                type: 'POST',\n                                data: jsonVar,\n                                success: function (datas) {\n                                    tableFunction.WptmLoading(that.find(\".loading-page\"), 101, 50, 5);\n                                    location.reload();\n                                }\n                            })\n                        });\n                    } else {\n                        tableFunction.WptmLoading(that.find(\".loading-page\"), 101, 50, 5);\n                        setTimeout(() => {\n                            location.reload();\n                            $('.prevent_event_popup').hide();\n                        }, 700);\n                    }\n\n                    setTimeout(function () {\n                        that.find(\".progress\").fadeOut(1000);\n                        that.find('.colose_popup').trigger('click');\n                        $('.prevent_event_popup').hide();\n                    }, 500);\n                } else {\n                    setTimeout(() => {\n                        tableFunction.WptmLoading(that.find(\".loading-page\"), 101, 50, 5, responseObj.datas, 'hasError');\n                        $('.prevent_event_popup').hide();\n                    }, 500);\n                    // tableFunction.wptmBootbox('', typeof responseObj.datas !== 'undefined' ? responseObj.datas : 'Has error when import file!', true, false);\n                }\n            });\n\n            this.on('complete', function (file) {\n                this.removeFile(file);\n                setTimeout(function () {\n                    that.find(\".progress-bar-success\").css('width', 0);\n                }, 6000);\n            });\n            // Update the total progress bar\n            this.on(\"uploadprogress\", function (file, progress) {\n                that.find(\".progress-bar-success\").css('width', progress + \"%\");\n            });\n        }\n    });\n}\n\n//Call ajax to get all data of table, add value to Wptm, table_function_data\nfunction updatepreview(id, ajaxCallBack) {\n    /*remove after change theme*/\n    delete table_function_data.changeTheme;\n    var url = wptm_ajaxurl + \"view=table&format=json&id=\" + id;\n    var $ = jquery;\n\n    $.ajax({\n        url: url,\n        type: \"POST\",\n        data: {},\n        dataType: \"json\",\n    }).done(function (data) {\n        //TODO: check user role table\n        Wptm.id = id;\n        Wptm.title = data.title;\n        /*not change data cell(in db table)*/\n        Wptm.type = 'html';\n        Wptm.category = data.id_category;\n\n        /*set height rows variable*/\n        Wptm.rowsHeight = {};\n        Wptm.table_height = 0;\n\n        Wptm.hyperlink = {};\n        if (typeof data.type !== 'undefined') {\n            Wptm.type = data.type;\n        } else {\n            Wptm.type = (typeof data.params.table_type !== 'undefined') ? data.params.table_type : Wptm.type;\n        }\n\n        if (data.datas === '' || data.datas === false) {\n            delete Wptm.datas;\n            Wptm.datas = [\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n            ];\n        } else {\n            data.datas = JSON.stringify(data.datas);\n            try {\n                Wptm.datas = JSON.parse(data.datas);\n            } catch (err) {\n                Wptm.datas = [\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n                ];\n            }\n        }\n\n        Wptm.style = $.parseJSON(data.style);\n\n        Wptm.css = data.css.replace(/\\\\n/g, \"\\n\");\n\n        if (data.params === \"\" || data.params === null || data.params.length == 0) {\n            Wptm.mergeCellsSetting = [];\n            Wptm.headerOption = 1;\n        } else {\n            if (typeof (data.params) == 'string') {\n                data.params = $.parseJSON(data.params);\n            }\n\n            if (typeof data.params.headerOption !== 'undefined') {\n                Wptm.headerOption = parseInt(data.params.headerOption);\n            } else {\n                Wptm.headerOption = 1;\n            }\n\n            if (typeof data.params.hyperlink !== 'undefined') {\n                if (typeof data.params.hyperlink === 'string') {\n                    data.params.hyperlink = data.params.hyperlink.replaceAll('\\\\\\\\\"', '\\\\\"');\n                    data.params.hyperlink = $.parseJSON(data.params.hyperlink);\n                }\n                $.each(data.params.hyperlink, function (index, value) {\n                    var rowCol = index.split(\"!\");\n                    if(typeof Wptm.datas[rowCol[0]] !== 'undefined') {\n                        if (typeof value.text == 'undefined' || typeof value.text == 'object') {\n                            value.text =  Wptm.datas[rowCol[0]][rowCol[1]];\n                        }\n                        if (wptmOpenHyperlink == 1) {\n                            Wptm.datas[rowCol[0]][rowCol[1]] = '<a target=\"_blank\" href=\"' + value.hyperlink + '\">' + value.text + '</a>';\n                        } else {\n                            Wptm.datas[rowCol[0]][rowCol[1]] = '<a href=\"' + value.hyperlink + '\">' + value.text + '</a>';\n                        }\n                    }\n                });\n                Wptm.hyperlink = data.params.hyperlink;\n            }\n\n            try {\n                if (typeof data.params.mergeSetting === 'string') {\n                    Wptm.mergeCellsSetting = $.parseJSON(data.params.mergeSetting);\n                } else if (typeof data.params.mergeSetting === 'object') {\n                    Wptm.mergeCellsSetting = data.params.mergeSetting;\n                }\n                if (Wptm.mergeCellsSetting == null) {\n                    Wptm.mergeCellsSetting = [];\n                }\n            } catch (e) {\n                Wptm.mergeCellsSetting = [];\n            }\n        }\n\n        /*set default table data*/\n        if (typeof (Wptm.style) === 'undefined' || Wptm.style === null) {\n            $.extend(Wptm, {\n                style: {\n                    table: {},\n                    rows: {},\n                    cols: {},\n                    cells: {}\n                },\n                css: ''\n            });\n        }\n\n        if (typeof (Wptm.style.rows) === 'undefined' || Wptm.style.rows === null) {\n            Wptm.style.rows = {};\n        }\n        if (typeof (Wptm.style.cols) === 'undefined' || Wptm.style.cols === null) {\n            Wptm.style.cols = {};\n            for (var number_col in Wptm.datas[0]) {\n                Wptm.style.cols[number_col] = [parseInt(number_col), {res_priority: parseInt(number_col)}];\n            }\n        } else {\n            for (var number_col in Wptm.datas[0]) {\n                if (typeof window.Wptm.style.cols[number_col] === 'undefined' || window.Wptm.style.cols[number_col] === null) {\n                    Wptm.style.cols[number_col] = [parseInt(number_col), {res_priority: parseInt(number_col)}];\n                } else  if (typeof window.Wptm.style.cols[number_col][1].res_priority === 'undefined') {\n                    Wptm.style.cols[number_col][1].res_priority =  parseInt(number_col);\n                }\n            }\n        }\n        if (typeof (Wptm.style.cells) === 'undefined' || Wptm.style.cells === null) {\n            Wptm.style.cells = {};\n        }\n\n        tableFunction.mergeCollsRowsstyleToCells();\n\n        Wptm.style.table = $.extend({}, window.default_value, Wptm.style.table);\n\n        if (typeof Wptm.style.table.syn_hash !== 'undefined' && Wptm.style.table.syn_hash !== '') {\n            window.Wptm.syn_hash = Wptm.style.table.syn_hash;\n        }\n\n        if (typeof table_function_data.auto_sync !== 'undefined') {\n            Wptm.style.table.auto_sync = table_function_data.auto_sync;\n            Wptm.style.table.spreadsheet_style = table_function_data.spreadsheet_style;\n            Wptm.style.table.spreadsheet_url = table_function_data.spreadsheet_url;\n            delete table_function_data.auto_sync;\n        }\n\n        if (Wptm.style.table.spreadsheet_url !== '' && Wptm.style.table.spreadsheet_url.indexOf(\"docs.google.com/spreadsheet\") === -1) {//when first auto syn after update 2.7.0\n            if (table_function_data.auto_sync == 1) {\n                Wptm.style.table.excel_auto_sync = 1;\n                Wptm.style.table.auto_sync = 0;\n                Wptm.style.table.excel_spreadsheet_style = Wptm.style.table.spreadsheet_style;\n            }\n            Wptm.style.table.excel_url = table_function_data.spreadsheet_url;\n            table_function_data.spreadsheet_url = '';\n            Wptm.style.table.spreadsheet_url = '';\n        }\n\n        if (Wptm.headerOption > 0 && (typeof Wptm.style.table.header_data === 'undefined' || Wptm.style.table.header_data.length < Wptm.headerOption)) {\n            Wptm.style.table.header_data = [];\n            for (var j = 0; j < Wptm.headerOption; j++) {\n                Wptm.style.table.header_data[j] = Wptm.datas[j];\n            }\n        }\n\n\n        window.table_function_data = tableFunction.createRegExpFormat(table_function_data, Wptm.style.table.currency_symbol, Wptm.style.table.date_formats);\n\n        if (Wptm.style.table.date_formats !== '') {\n            window.table_function_data.date_formats_momentjs = tableFunction.momentjsFormat(Wptm.style.table.date_formats);\n        }\n\n        window.Wptm = $.extend({}, window.Wptm, Wptm);\n\n        $('#jform_css').val(Wptm.css);\n        $('#jform_css').change();\n        tableFunction.parseCss($);\n\n        tableFunction.setFormat_accounting();\n\n        var handRisize, clearHandRisize;\n        window.onresize = function () {\n            if (!clearHandRisize) {\n                clearTimeout(handRisize);\n            }\n\n            clearHandRisize = false;\n            handRisize = setTimeout(function () {\n                var height = tableFunction.calculateTableHeight(window.jquery('#wptm-toolbars'));\n                jquery(Wptm.container).handsontable('updateSettings', {height: height});\n                clearHandRisize = true;\n            }, 500);\n        };\n\n        if (typeof (Wptm.style.table.alternateColorValue) === 'undefined' || typeof Wptm.style.table.alternateColorValue[0] === 'undefined') {\n            var styleRows = null;\n            alternating.setAlternateColor(styleRows, window.Wptm, window.wptm_element);\n        }\n\n        if (_.size(window.table_function_data.oldAlternate) < 1) {\n            window.table_function_data.oldAlternate = $.extend({}, Wptm.style.table.alternateColorValue);\n        }\n\n        if (_.size(window.table_function_data.allAlternate) < 1) {\n            window.table_function_data.allAlternate = $.extend({}, Wptm.style.table.allAlternate);\n        }\n\n        //update option table\n        selectOption.updateOptionValTable($, window.Wptm, [0, 0, 0, 0]);\n\n        codemirror_tooltip($);\n\n        $('#list_chart').find('.current_table a').text(Wptm.title);\n        if (Wptm.type !== 'html') {\n            // wptm_element.primary_toolbars.find('.wptm_name_edit').after('<div class=\"wptm_warning\"><p>' + wptmText.notice_msg_table_database + '</p></div>');\n            if (wptm_element.settingTable.find('.table-menu a.source_menu').length > 0) {\n                wptm_element.settingTable.find('.table-menu a.source_menu').parent().show();\n            }\n            if (Wptm.style.table.allRowHeight < 10 || isNaN(Wptm.style.table.allRowHeight)) {\n                Wptm.style.table.allRowHeight = 30;\n            }\n        } else {\n            wptm_element.settingTable.find('.table-menu a.source_menu').parent().hide();\n        }\n\n        /*convert */\n\n        // window.Wptm.type = 'html';\n\n        //check edit columns, get column key\n        if (window.Wptm.type === 'mysql') {\n            Wptm.query_option = data.query_option;\n            if (Wptm.query_option.column_options !== null && Wptm.query_option.column_options.length > 0) {\n                table_function_data.columns = [];\n                for (var i in Wptm.query_option.column_options) {\n                    if (parseInt(Wptm.query_option.column_options[i].canEdit) !== 1 || (Wptm.query_option.column_options[i].table + '.' + Wptm.query_option.column_options[i].Field === Wptm.style.table.priKey)) {\n                        table_function_data.columns[i] = {readOnly: true};\n                    } else {\n                        table_function_data.columns[i] = {readOnly: false}\n                    }\n                    if (typeof Wptm.style.table.lock_columns !== 'undefined'\n                        && Wptm.style.table.lock_columns[i] != 0) {\n                        table_function_data.columns[i] = {readOnly: true};\n                    }\n                    if (Wptm.style.table.priKey === Wptm.query_option.column_options[i].table + '.' + Wptm.query_option.column_options[i].Field) {\n                        table_function_data.keyPosition = i;\n                    }\n                }\n            }\n        // } else {\n        //     if (wptm_administrator !== 1 && typeof Wptm.style.table.protect_columns !== 'undefined') {\n        //         table_function_data.columns = [];\n        //         for (var ij2 in Wptm.style.table.protect_columns) {\n        //             if (Wptm.style.table.protect_columns[ij2] != 0) {\n        //                 table_function_data.columns[ij2] = {readOnly: true};\n        //             } else {\n        //                 table_function_data.columns[ij2] = {readOnly: false}\n        //             }\n        //         }\n        //     }\n        }\n\n        if (typeof Wptm.style.table.lock_ranger_cells !== 'undefined' && Wptm.style.table.lock_ranger_cells.length > 0) {\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, null);\n        }\n\n        table_function_data.mysqlEdit = window.Wptm.type === 'mysql' && parseInt(Wptm.table_editing) === 1;\n\n        table_function_data.FormulaParser = new FormulaParser({\n            onCell: ({sheet, row, col}) => {\n                // using 1-based index\n                // return the cell value, see possible types in next section.\n                let data = Wptm.datas[row - 1][col - 1]\n\n                if (!isNaN(parseFloat(data)) && typeof data !== 'boolean')\n                    data = parseFloat(data);\n                // if (data[0] === '=') {\n                //     console.log(row - 1, col - 1, data)\n                    // data = data.replaceAll(';', ',')\n                    // let datas = table_function_data.FormulaParser.getCell({row: row, col: col})\n                    // let datas = customRenderer.render(false, false, row - 1, col - 1, false, data, 'cellProperties', true)\n                    // data = datas\n                    // data = 16\n                // }\n\n                return data;\n            },\n                // retrieve range values\n            onRange: (ref) => {\n                // using 1-based index\n                // Be careful when ref.to.col is MAX_COLUMN or ref.to.row is MAX_ROW, this will result in\n                // unnecessary loops in this approach.\n                const arr = [];\n\n                for (let row = ref.from.row; row <= ref.to.row; row++) {\n                    const innerArr = [];\n                    if (Wptm.datas[row - 1]) {\n                        for (let col = ref.from.col; col <= ref.to.col; col++) {\n                            let data = Wptm.datas[row - 1][col - 1]\n                            if (!isNaN(parseFloat(data)) && typeof data !== 'boolean')\n                                data = parseFloat(data);\n                            innerArr.push(data);\n                        }\n                    }\n                    arr.push(innerArr);\n                }\n                return arr;\n            }\n        })\n        /*render table */\n        initHandsontable(Wptm.datas);\n        wptm_element.primary_toolbars.find('.wptm_name_edit').click(function () {\n            if (!$(this).hasClass('editable')) {\n                tableFunction.setText.call(\n                    $(this),\n                    wptm_element.primary_toolbars.find('.wptm_name_edit'),\n                    '#primary_toolbars .wptm_name_edit',\n                    {'url': wptm_ajaxurl + \"task=table.setTitle&id=\" + Wptm.id + '&title=', 'selected': true}\n                );\n            }\n        });\n\n        $(window).bind('keydown', function(event) {//CTRL + S\n            if (!(event.which == 83 && (event.ctrlKey || event.metaKey)) && !(event.which == 19)) return true;\n            tableFunction.saveChanges(true);\n            event.preventDefault();\n            return false;\n        });\n\n        $('#cell_zoom_size').on('change', (e) => {\n            // var p = [\"webkit\", \"moz\", \"ms\", \"o\"],\n            //     content = '';\n            // for (var i1 = 0; i1 < p.length; i1++) {\n            //     wptm_element.tableContainer[0].style[p[i1] + \"Transform\"] = \"scale(\" + parseFloat(e.target.value) + \")\";\n            //     wptm_element.tableContainer[0].style[p[i1] + \"TransformOrigin\"] = '0% 0%';\n            // }\n\n            // setTimeout(() => {\n            //     Wptm.container.handsontable(\"render\");\n                // jquery(Wptm.container).handsontable('render');\n            // }, 200)\n\n            tableFunction.wptmSetZoom(e.target.value, false)\n        })\n\n        if (typeof Wptm.wptm_error_message_read_file !== 'undefined') {\n            tableFunction.wptmBootbox(wptmText.import_is_finished, wptmText.error_message_read_file + Wptm.title + wptmText.error_message_read_file_cells_concerned +\n                Wptm.wptm_error_message_read_file, true, false, null, null, 'warning');\n        }\n    });\n}\n\nfunction checkLightOrDark(color) {\n    var r, g, b, hsp;\n\n    if (color.match(/^rgb/)) {\n        color = color.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/);\n        r = color[1];\n        g = color[2];\n        b = color[3];\n    }\n    else {\n        color = +(\"0x\" + color.slice(1).replace(color.length < 5 && /./g, '$&$&'));\n        r = color >> 16;\n        g = color >> 8 & 255;\n        b = color & 255;\n    }\n\n    hsp = Math.sqrt(\n        0.299 * (r * r) +\n        0.587 * (g * g) +\n        0.114 * (b * b)\n    );\n\n    if (hsp>127.5) {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\n//custom cell editor\nfunction codemirror_tooltip($) {\n    window.CustomEditor = Handsontable.editors.TextEditor.prototype.extend();\n\n    window.CustomEditor.prototype.open = function () {\n        // console.log($(this.TEXTAREA).parent())\n        // $(this.TEXTAREA).parent().removeClass('wptm_hiden')\n        $(this.TEXTAREA).attr('id', 'editor1');\n        var lightOrDark = checkLightOrDark($(this.TEXTAREA).css( \"backgroundColor\" ));\n        if (lightOrDark === 0) {\n            $(this.TEXTAREA).css({'color':'#ffffff'});\n        } else {\n            $(this.TEXTAREA).css({'color':'#000000'});\n        }\n        var cell_html = false;\n        if (typeof (Wptm.style.cells[this.row + '!' + this.col]) !== 'undefined' && typeof (Wptm.style.cells[this.row + '!' + this.col][2].cell_type) !== 'undefined' && Wptm.style.cells[this.row + '!' + this.col][2].cell_type === 'html') {\n            cell_html = true;\n            Handsontable.editors.TextEditor.prototype.close.apply(this, arguments);\n            tinyMCE.EditorManager.execCommand('mceRemoveEditor', true, 'html_cell_content');\n\n            var initTT = tinymce.extend({}, tinyMCEPreInit.mceInit['html_cell_content']);\n            try {\n                tinymce.init(initTT);\n            } catch (e) {\n            }\n\n            //add tinymce to this\n            var content = '';\n            if (typeof Wptm.datas[table_function_data.selection[0][0]][table_function_data.selection[0][1]] !== 'undefined'\n            && Wptm.datas[table_function_data.selection[0][0]][table_function_data.selection[0][1]] !== null) {\n                content = Wptm.datas[table_function_data.selection[0][0]][table_function_data.selection[0][1]];\n            }\n            tinyMCE.EditorManager.execCommand('mceAddEditor', true, 'html_cell_content');\n            if (tinyMCE.EditorManager.get('html_cell_content') != null) {\n                var ttEditor = tinyMCE.EditorManager.get('html_cell_content');\n                if (ttEditor && ttEditor.getContainer()) {\n                    ttEditor.setContent(content);\n                }\n            }\n\n            wptm_element.edit_html_cell.trigger('click');\n        } else {\n            tinyMCE.EditorManager.execCommand('mceRemoveEditor', true, 'html_cell_content');\n            Handsontable.editors.TextEditor.prototype.open.apply(this, arguments);\n        }\n\n        // change width of popup when click html cell\n        if (!cell_html) {\n            wptm_element.tableContainer.find('.handsontableInputHolder').css('position', 'absolute').css('visibility', 'visible');\n        }\n    };\n\n    window.CustomEditor.prototype.getValue = function () {\n        if (typeof (tinyMCE) === 'undefined' || !tinyMCE.EditorManager.get('html_cell_content')) {\n\n            return Handsontable.editors.TextEditor.prototype.getValue.apply(this, arguments);\n        }\n    };\n\n    window.CustomEditor.prototype.setValue = function (newValue) {\n        var cell_html = false;\n        if (typeof (Wptm.style.cells[this.row + '!' + this.col]) !== 'undefined' && typeof (Wptm.style.cells[this.row + '!' + this.col][2].cell_type) !== 'undefined' && Wptm.style.cells[this.row + '!' + this.col][2].cell_type === 'html') {\n            cell_html = true;\n        }\n        if (!cell_html) {\n            return Handsontable.editors.TextEditor.prototype.setValue.apply(this, arguments);\n        }\n    };\n\n    wptm_element.edit_html_cell.wptm_leanModal({\n        top: 100, background: '#ffffff', closeButton: '#cancel_html_cell_btn',\n        beforeInit: function () {\n            var position = tableFunction.setPositionForHtmlCellEditor();\n            this.top = position.top;\n            this.left = position.left + 'px';\n            this.marginLeft = '0px';\n        },\n        before_colose_modal: function () {\n            var content = tinyMCE.EditorManager.get('html_cell_content').getContent();\n            window.jquery(window.Wptm.container).data('handsontable').setDataAtCell(table_function_data.selection[0][0], table_function_data.selection[0][1], content);\n        }\n    });\n\n    //codemirror\n    var myTextArea = document.getElementById(\"jform_css\");\n    var myCssEditor = CodeMirror.fromTextArea(myTextArea, {mode: \"css\", lineNumbers: true});\n    var ww = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n    var wh = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n    if (window.parent) {\n        ww = window.parent.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n        wh = window.parent.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n    }\n\n    myCssEditor.setSize(ww * 50 / 100, wh - 500);\n\n    wptm_element.primary_toolbars.find('.custom-menu').wptm_leanModal({\n        top: 200,\n        background: '#ffffff',\n        closeButton: '#cancelCssbtn',\n        beforeShow: function () {\n            var selection = table_function_data.selection;\n            var ht = jQuery(Wptm.container).handsontable('getInstance');\n            ht.updateSettings({\n                cells: function (row, col, prop) {\n                    if (selection[0][0] === row && selection[0][1] === col) {\n                        var cellProperties = {};\n\n                        cellProperties.readOnly = true;\n                        return cellProperties;\n                    }\n                }\n            });\n            window.jquery(Wptm.container).handsontable(\"selectCell\", selection[0][0], selection[0][1], selection[0][0], selection[0][1]);\n        },\n        before_colose_modal: function () {\n            var selection = table_function_data.selection;\n\n            var ht = jQuery(Wptm.container).handsontable('getInstance');\n            ht.updateSettings({\n                cells: function (row, col, prop) {\n                    if (selection[0][0] === row && selection[0][1] === col) {\n                        var cellProperties = {};\n\n                        cellProperties.readOnly = false;\n                        return cellProperties;\n                    }\n                }\n            });\n            window.jquery(Wptm.container).handsontable(\"selectCell\", selection[0][0], selection[0][1], selection[0][0], selection[0][1]);\n        },\n        modalShow: function () {\n            myCssEditor.refresh();\n            myCssEditor.focus();\n        }\n    });\n\n    $(myTextArea).on('change', function () {\n        myCssEditor.setValue($(myTextArea).val().replace(/\\\\n/g, \"\\n\"));\n    });\n\n    // myCssEditor.on(\"blur\", function() {\n    $(\"#saveCssbtn\").click(function () {\n        myCssEditor.save();\n        tableFunction.parseCss($);\n        $(myTextArea).trigger(\"propertychange\");\n        //close leanModal\n        $(\"#lean_overlay\").fadeOut(200);\n        $(\"#wptm_customCSS\").css({\"display\": \"none\"})\n    });\n\n    wptm_element.editToolTip.wptm_leanModal({\n        top: 100, background: '#ffffff', closeButton: [$('#cancelToolTipbtn'), $('#wptm_editToolTip .colose_popup')], modalShow: function () {\n        }\n    });\n\n    wptm_element.saveToolTipbtn.click(function () {\n        var ttEditor = tinyMCE.EditorManager.get('tooltip_content');\n        ttEditor.save();\n        $(\"#tooltip_content\").trigger(\"change\");\n        //close leanModal\n        $(\"#lean_overlay\").fadeOut(200);\n\n        $(\"#wptm_editToolTip\").css({\"display\": \"none\"});\n        $('#edit_toolTip').trigger('change');\n    })\n\n    tinyMCEPreInit.mceInit['html_cell_content'] = tinyMCEPreInit.mceInit['wptmditor'];\n    tinyMCEPreInit.mceInit['tooltip_content'] = tinyMCEPreInit.mceInit['wptm_tooltip'];\n    tinyMCE.EditorManager.execCommand('mceRemoveEditor', true, 'wptmditor');\n    $('#wp-wptmditor-wrap').hide();\n}\n\n//fetch google sheet, import file excel\nfunction fetchSpreadsheet(obj) {\n    tableFunction.loading(wptm_element.wpreview);\n\n    var auto_sync, spreadsheet_style, url;\n    var $close_popup = wptm_element.wptm_popup.find('.colose_popup');\n    var loader = wptm_element.wptm_popup.find('.lds-ring');\n    var popup_notification = wptm_element.wptm_popup.find('.popup_notification');\n    var data;\n    let select_sheet = 0\n\n    if (obj.type === 'spreadsheet') {\n        data = tableFunction.getLinkSync(Wptm.style.table.spreadsheet_url, 'spreadsheet', true);\n        if (!data) {\n            return false;\n        }\n        select_sheet = Wptm.style.table.select_sheet_google || 0;\n        // url = encodeURI(Wptm.style.table.spreadsheet_url);\n        // auto_sync = Wptm.style.table.auto_sync != '1' ? 0 : 1;\n        // spreadsheet_style = Wptm.style.table.spreadsheet_style != '1' ? 0 : 1;\n        // if (url.indexOf(\"docs.google.com/spreadsheet\") === -1) {\n        //     bootbox.alert(wptmText.error_link_google_sync, wptmText.GOT_IT);\n        //     Wptm.style.table.spreadsheet_url = '';\n        //     return;\n        // }\n        //\n        // //check publish link\n        // var end_link = url.split('?');\n        // var end_link0 = end_link[0].slice(-7);\n        // if (end_link0.match(/html|csv|pdf|xlsx/gi) === null && (typeof end_link[1] !== \"undefined\" && end_link[1].match(/sharing|html|csv|pdf|xlsx/gi) === null)) {\n        //     bootbox.alert(wptmText.error_link_google_sync, wptmText.GOT_IT);\n        //     Wptm.style.table.spreadsheet_url = '';\n        //     return;\n        // }\n    } else if (obj.type === 'excel') {\n        data = tableFunction.getLinkSync(Wptm.style.table.excel_url, 'excel', true);\n        if (!data) {\n            return false;\n        }\n        select_sheet = Wptm.style.table.select_sheet || 0;\n        // url = encodeURI(Wptm.style.table.excel_url);\n        // auto_sync = Wptm.style.table.excel_auto_sync != '1' ? 0 : 1;\n        // spreadsheet_style = Wptm.style.table.excel_spreadsheet_style != '1' ? 0 : 1;\n        // if (url.indexOf(\"docs.google.com/spreadsheet\") !== -1) {\n        //     bootbox.alert(wptmText.error_link_import_sync, wptmText.GOT_IT);\n        //     Wptm.style.table.excel_url = '';\n        //     return;\n        // }\n    } else if (obj.type === 'onedrive') {\n        data = tableFunction.getLinkSync(Wptm.style.table.onedrive_url, 'onedrive', true);\n        if (!data) {\n            return false;\n        }\n        select_sheet = Wptm.style.table.select_sheet_one || 0;\n    } else if (obj.type === 'csv') {\n        data = tableFunction.getLinkSync(Wptm.style.table.csv_url, 'csv', true);\n        if (!data) {\n            return false;\n        }\n\n    }\n\n    var jsonVar = {\n        spreadsheet_url: data.url,\n        id: Wptm.id,\n        sync: data.auto_sync,\n        syncType: obj.type,\n        getListSheet: select_sheet,\n        style: data.spreadsheet_style || 0\n    };\n    delete table_function_data.fetch_data;\n\n    jquery.ajax({\n        url: wptm_ajaxurl + \"task=excel.fetchSpreadsheet&id=\" + Wptm.id,\n        type: \"POST\",\n        data: jsonVar,\n        beforeSend: function() {\n            loader.removeClass('wptm_hiden');\n            popup_notification.addClass('wptm_hiden');\n        },\n        success: function (datas) {\n            loader.addClass('wptm_hiden');\n            var result = jQuery.parseJSON(datas);\n            if (result.response === true) {\n                if (obj.type === 'spreadsheet') {\n                    // table_function_data.auto_sync = result.datas.sync;\n                    table_function_data.spreadsheet_style = result.datas.style;\n                    table_function_data.spreadsheet_url = Wptm.style.table.spreadsheet_url;\n                } else if(obj.type === 'excel') {\n                    // table_function_data.excel_auto_sync = result.datas.sync;\n                    table_function_data.excel_spreadsheet_style = result.datas.style;\n                    table_function_data.excel_url = Wptm.style.table.excel_url;\n                } else if(obj.type === 'onedrive') {\n                    // table_function_data.excel_auto_sync = result.datas.sync;\n                    table_function_data.onedrive_style = result.datas.style;\n                    table_function_data.onedrive_url = Wptm.style.table.onedrive_url;\n                } else if(obj.type === 'onedrive') {\n                    table_function_data.csv_url = Wptm.style.table.csv_url;\n                }\n                updatepreview(Wptm.id);\n                popup_notification.html('<span class=\"noti_success\">'+wptmText.DATA_HAS_BEEN_FETCHED+'</span>');\n                if (typeof result.datas.error !== 'undefined' && result.datas.error !== '') {\n                    popup_notification.html('<span class=\"noti_false\">'+result.datas.error+'</span>');\n                    popup_notification.removeClass('wptm_hiden');\n                } else {\n                    if (typeof result.datas.error_read_file !== 'undefined' && result.datas.error_read_file !== '') {\n                        setTimeout(function () {\n                            tableFunction.wptmBootbox(wptmText.import_is_finished, wptmText.error_message_read_file_cells_concerned +\n                                result.datas.error_read_file, true, false, null, null, 'warning');\n                        }, 500);\n                    }\n                    popup_notification.removeClass('wptm_hiden');\n                    $close_popup.trigger('click');\n                }\n            } else {\n                if (result.datas && result.datas[0] === 'list sheet') {\n\n                } else {\n                    popup_notification.html('<span class=\"noti_false\">'+result.response+'</span>');\n                    popup_notification.removeClass('wptm_hiden');\n                }\n            }\n            tableFunction.rloading(wptm_element.wpreview);\n        },\n        error: function (jqxhr, textStatus, error) {\n            popup_notification.html('<span class=\"noti_false\">'+wptmText.have_error+'</span>');\n            popup_notification.removeClass('wptm_hiden');\n            tableFunction.rloading(wptm_element.wpreview);\n        }\n    });\n}\n\nfunction updateDimession() {\n    var rows = [];\n    var i = 0;\n    for (var row in Wptm.style.rows) {\n        var h = jQuery('#tableContainer .ht_master .htCore tr').eq(i + 1).height();\n        rows[row] = h;\n        i++;\n    }\n\n    jQuery(Wptm.container).handsontable('updateSettings', {rowHeights: rows});\n\n    var ht = jQuery(Wptm.container).handsontable('getInstance');\n    ht.runHooks('afterRowResize');\n}\n\nexport default {\n    updatepreview,\n    importExcel,\n    fetchSpreadsheet\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(\"./app/admin/assets/js/_wptm.js\");\n__webpack_require__(\"./app/admin/assets/js/_toolbarOptions.js\");\n__webpack_require__(\"./app/admin/assets/js/_initHandsontable.js\");\n__webpack_require__(\"./app/admin/assets/js/_functions.js\");\n__webpack_require__(\"./app/admin/assets/js/_customRenderer.js\");\n__webpack_require__(\"./app/admin/assets/js/_chart.js\");\n__webpack_require__(\"./app/admin/assets/js/_changeTheme.js\");\nvar __webpack_exports__ = __webpack_require__(\"./app/admin/assets/js/_alternating.js\");\n",""],"names":[],"sourceRoot":""}